"use strict";(self.webpackChunk_voodoo_bucr_client=self.webpackChunk_voodoo_bucr_client||[]).push([[574],{4574:function(t,e,i){i.r(e);var s=i(6566);let o,n,a,r,h,l,d,c,u,p,_,g,m,y,v,f,w,b,k,x,C,B,M,S,Z,P,U,T,F,D,I,E,L,O,A,q;!function(t){t.propagationUpdate="CoinsPropagatorModelPropagationUpdate",t.multiplierUpdate="CoinsPropagatorModelMultiplierUpdate",t.uuidUpdate="CoinsPropagatorModelUuidUpdate"}(o||(o={})),function(t){t.uuidUpdate="CollectorModelUuidUpdate"}(n||(n={})),function(t){t.lengthMetadataIndexUpdate="CrusherModelLengthMetadataIndexUpdate",t.fuelMetadataIndexUpdate="CrusherModelFuelMetadataIndexUpdate",t.powerMetadataIndexUpdate="CrusherModelPowerMetadataIndexUpdate",t.sizeMetadataIndexUpdate="CrusherModelSizeMetadataIndexUpdate",t.velocityUpdate="CrusherModelVelocityUpdate",t.stateUpdate="CrusherModelStateUpdate",t.fuelUpdate="CrusherModelFuelUpdate",t.fuelMaxUpdate="CrusherModelFuelMaxUpdate",t.fuelRemainingUpdate="CrusherModelFuelRemainingUpdate",t.configUpdate="CrusherModelConfigUpdate",t.activeSkinUpdate="CrusherModelActiveSkinUpdate",t.uuidUpdate="CrusherModelUuidUpdate"}(a||(a={})),function(t){t.configUpdate="LevelModelConfigUpdate",t.joystickUpdate="LevelModelJoystickUpdate",t.stateUpdate="LevelModelStateUpdate",t.completionReasonUpdate="LevelModelCompletionReasonUpdate",t.crusherUpdate="LevelModelCrusherUpdate",t.wallUpdate="LevelModelWallUpdate",t.collectorUpdate="LevelModelCollectorUpdate",t.coinsPropagatorUpdate="LevelModelCoinsPropagatorUpdate",t.progressUpdate="LevelModelProgressUpdate",t.moneyUpdate="LevelModelMoneyUpdate",t.uuidUpdate="LevelModelUuidUpdate"}(r||(r={})),function(t){t.bricksDataUpdate="WallModelBricksDataUpdate",t.bricksCountUpdate="WallModelBricksCountUpdate",t.configUpdate="WallModelConfigUpdate",t.uuidUpdate="WallModelUuidUpdate"}(h||(h={})),function(t){t.lifetimeExceededUpdate="PopupAbortModelLifetimeExceededUpdate",t.stateUpdate="PopupAbortModelStateUpdate",t.typeUpdate="PopupAbortModelTypeUpdate",t.configUpdate="PopupAbortModelConfigUpdate"}(l||(l={})),function(t){t.stateUpdate="PopupFailedOffBoardingModelStateUpdate",t.typeUpdate="PopupFailedOffBoardingModelTypeUpdate",t.configUpdate="PopupFailedOffBoardingModelConfigUpdate"}(d||(d={})),function(t){t.stateUpdate="PopupLevelCompletedModelStateUpdate",t.typeUpdate="PopupLevelCompletedModelTypeUpdate",t.configUpdate="PopupLevelCompletedModelConfigUpdate"}(c||(c={})),function(t){t.stateUpdate="PopupOutOfFuelModelStateUpdate",t.typeUpdate="PopupOutOfFuelModelTypeUpdate",t.configUpdate="PopupOutOfFuelModelConfigUpdate"}(u||(u={})),function(t){t.lengthUpdate="PopupQueueModelLengthUpdate",t.queueUpdate="PopupQueueModelQueueUpdate",t.activeUpdate="PopupQueueModelActiveUpdate",t.uuidUpdate="PopupQueueModelUuidUpdate"}(p||(p={})),function(t){t.stateUpdate="PopupSettingsModelStateUpdate",t.typeUpdate="PopupSettingsModelTypeUpdate",t.configUpdate="PopupSettingsModelConfigUpdate"}(_||(_={})),function(t){t.stateUpdate="PopupSkinUnlockModelStateUpdate",t.typeUpdate="PopupSkinUnlockModelTypeUpdate",t.configUpdate="PopupSkinUnlockModelConfigUpdate"}(g||(g={})),function(t){t.lengthButtonUpdate="CrusherPropertiesShopModelLengthButtonUpdate",t.fuelButtonUpdate="CrusherPropertiesShopModelFuelButtonUpdate",t.powerButtonUpdate="CrusherPropertiesShopModelPowerButtonUpdate",t.sizeButtonUpdate="CrusherPropertiesShopModelSizeButtonUpdate",t.uuidUpdate="CrusherPropertiesShopModelUuidUpdate"}(m||(m={})),function(t){t.levelUpdate="GameModelLevelUpdate",t.crusherUpdate="GameModelCrusherUpdate",t.tutorialUpdate="GameModelTutorialUpdate",t.stateUpdate="GameModelStateUpdate",t.uuidUpdate="GameModelUuidUpdate"}(y||(y={})),function(t){t.uuidUpdate="GroundModelUuidUpdate"}(v||(v={})),function(t){t.azimuthUpdate="JoystickModelAzimuthUpdate",t.radiusUpdate="JoystickModelRadiusUpdate",t.uuidUpdate="JoystickModelUuidUpdate"}(f||(f={})),function(t){t.uuidUpdate="ObservableModelUuidUpdate"}(w||(w={})),function(t){t.unlockConditionUpdate="SkinModelUnlockConditionUpdate",t.lockedUpdate="SkinModelLockedUpdate",t.skinUpdate="SkinModelSkinUpdate",t.uuidUpdate="SkinModelUuidUpdate"}(b||(b={})),function(t){t.skinsUpdate="SkinSetModelSkinsUpdate",t.uuidUpdate="SkinSetModelUuidUpdate"}(k||(k={})),function(t){t.totalMoneyUpdate="StatisticsModelTotalMoneyUpdate",t.completedLevelsUpdate="StatisticsModelCompletedLevelsUpdate",t.uuidUpdate="StatisticsModelUuidUpdate"}(x||(x={})),function(t){t.userUpdate="StoreUserUpdate",t.gameUpdate="StoreGameUpdate",t.uiUpdate="StoreUiUpdate",t.groundUpdate="StoreGroundUpdate",t.skinSetUpdate="StoreSkinSetUpdate",t.statisticsUpdate="StoreStatisticsUpdate",t.uuidUpdate="StoreUuidUpdate"}(C||(C={})),function(t){t.uuidUpdate="TutorialModelUuidUpdate"}(B||(B={})),function(t){t.popupQueueUpdate="UIModelPopupQueueUpdate",t.crusherPropertiesShopModelUpdate="UIModelCrusherPropertiesShopModelUpdate",t.uuidUpdate="UIModelUuidUpdate"}(M||(M={})),function(t){t.ftueUpdate="UserModelFtueUpdate",t.levelUpdate="UserModelLevelUpdate",t.moneyUpdate="UserModelMoneyUpdate",t.hapticUpdate="UserModelHapticUpdate",t.muteUpdate="UserModelMuteUpdate",t.uuidUpdate="UserModelUuidUpdate"}(S||(S={})),function(t){t.init="AppEventInit",t.start="AppEventStart",t.resize="AppEventResize",t.resume="AppEventResume",t.pause="AppEventPause",t.mute="AppEventMute",t.unmute="AppEventUnmute",t.firstInteraction="AppEventFirstInteraction",t.interaction="AppEventInteraction",t.loadStart="AppEventLoadStart",t.loadProgress="AppEventLoadProgress",t.loadComplete="AppEventLoadComplete",t.loadError="AppEventLoadError"}(Z||(Z={})),function(t){t.beginContact="Physics2dEventBeginContact",t.endContact="Physics2dEventEndContact",t.preSolve="Physics2dEventPreSolve",t.postSolve="Physics2dEventPostSolve"}(P||(P={})),function(t){t.playButtonClick="UIViewEventPlayButtonClick",t.skinsButtonClick="UIViewEventSkinsButtonClick",t.skinsCloseButtonClick="UIViewEventSkinsCloseButtonClick",t.backButtonClick="UIViewEventBackButtonClick",t.settingsButtonClick="UIViewEventSettingsButtonClick",t.skipButtonClick="UIViewEventSkipButtonClick",t.propertiesShopButtonClick="UIViewEventPropertiesShopButtonClick",t.skinsShopButtonClick="UIViewSkinsShopButtonClick",t.queuePopup="UIViewEventQueuePopup"}(U||(U={})),function(t){t.up="JoystickViewEventUp",t.down="JoystickViewEventDown",t.drag="JoystickViewEventDrag"}(T||(T={})),function(t){t.bricksThrown="WallComponentEventBricksThrown",t.bricksCollected="WallComponentEventBricksCollected"}(F||(F={})),function(t){t.timeIsUp="CoinComponentEventTimeIsUp"}(D||(D={})),function(t){t.showComplete="PopupViewEventShowComplete",t.showStart="PopupViewEventShowStart",t.hideStart="PopupViewEventHideStart",t.hideComplete="PopupViewEventHideComplete",t.blockerClick="PopupViewEventBlockerClick",t.closeBtnClick="PopupViewEventCloseBtnClick",t.blockerShowStart="PopupViewEventBlockerShowStart",t.blockerHideComplete="PopupViewEventBlockerHideComplete"}(I||(I={})),function(t){t.soundClick="PopupSettingsViewEventSoundClick",t.hapticClick="PopupSettingsViewEventHapticClick"}(E||(E={})),function(t){t.shareWithFriendsClick="PopupLevelCompleteViewEventShareWithFriendsClick",t.inviteFriendsClick="PopupLevelCompleteViewEventInviteFriendsClick",t.continueClick="PopupLevelCompleteViewEventContinueClick"}(L||(L={})),function(t){t.shareWithFriendsClick="PopupFailedOffBoardingViewEventShareWithFriendsClick",t.inviteFriendsClick="PopupFailedOffBoardingViewEventInviteFriendsClick",t.continueClick="PopupFailedOffBoardingViewEventContinueClick"}(O||(O={})),function(t){t.fillThankClick="PopupOutOfFuelViewEventFillThankClick",t.noThanksClick="PopupOutOfFuelViewEventNoThanksClick"}(A||(A={})),function(t){t.selectClick="PopupSkinUnlockViewEventSelectClick"}(q||(q={}));const z=10;let G,j,W,V,R,H,N,J,Y,Q,K,X;!function(t){t[t.north=0]="north",t[t.south=1]="south",t[t.east=2]="east",t[t.west=3]="west"}(G||(G={})),function(t){t.landscape="landscape",t.portrait="portrait"}(j||(j={})),function(t){t.desktop="desktop",t.mobile="mobile"}(W||(W={})),function(t){t.fat="fat",t.normal="normal",t.tall="tall"}(V||(V={})),function(t){t[t.light=30]="light",t[t.medium=48.5410196625]="medium",t[t.heavy=78.54101966250705]="heavy",t[t.extreme=127.08203932501846]="extreme"}(R||(R={})),function(t){t[t.wall=0]="wall",t[t.crusher=1]="crusher",t[t.collector=2]="collector",t[t.coins=3]="coins",t[t.camera=4]="camera"}(H||(H={})),function(t){t.user="user",t.crusher="crusher",t.statistics="statistics",t.skins="skins"}(N||(N={})),function(t){t.base="base",t.simple="simple",t.head="head"}(J||(J={})),function(t){t.idle="idle",t.shopUpgrades="shopUpgrades",t.shopSkins="shopSkins",t.play="play"}(Y||(Y={})),function(t){t.idle="idle",t.play="play",t.reviving="reviving",t.complete="complete"}(Q||(Q={})),function(t){t.abort="abort",t.clear="clear",t.outOfFuel="outOfFuel"}(K||(K={})),function(t){t.coin0="coin0",t.coin1="coin1",t.coin2="coin2",t.coin3="coin3",t.coin4="coin4"}(X||(X={}));const $=Object.freeze({coin0:.25,coin1:.5,coin2:1,coin3:3,coin4:5});let tt,et,it;!function(t){t[t.settings=0]="settings",t[t.outOfFuel=1]="outOfFuel",t[t.levelCompleted=2]="levelCompleted",t[t.failedOffBoarding=3]="failedOffBoarding",t[t.abort=4]="abort",t[t.skinUnlock=5]="skinUnlock"}(tt||(tt={})),function(t){t.unknown="unknown",t.init="init",t.show="show",t.idle="idle",t.hide="hide",t.destroy="destroy"}(et||(et={})),function(t){t.idle="idle",t.warning="warning",t.outOfFuel="outOfFuel"}(it||(it={}));var st=i(6666),ot=i(3534),nt=i(772);const at=3.5,rt=.05,ht=2.4,lt=10.4,dt=10.7,ct=12.57,ut=.6,pt=40,_t=3*.1,gt=600,mt=.05,yt={x:-17,y:-12.4},vt={radius1:1.8,height1:3.6,radius2:1,height2:4.4},ft=[{head:{radius:at,mass:1,drag:0,angularDrag:rt,joint:vt},arms:[{type:J.base,width:ht,height:dt,mass:1,drag:pt,angularDrag:5,angle:0,joint:vt},{type:J.head,width:ht,height:ct,mass:ut,drag:pt,angularDrag:5,angle:0,joint:vt}],base:{position:yt,radius:_t,mass:gt,drag:0,angularDrag:mt},fuel:60,power:0},{head:{radius:at,mass:1,drag:0,angularDrag:rt,joint:vt},arms:[{type:J.base,width:ht,height:dt,mass:1,drag:pt,angularDrag:5,angle:0,joint:vt},{type:J.simple,width:ht,height:lt,mass:ut,drag:pt,angularDrag:5,angle:0,joint:vt},{type:J.head,width:ht,height:ct,mass:ut,drag:pt,angularDrag:5,angle:0,joint:vt}],base:{position:yt,radius:_t,mass:gt,drag:0,angularDrag:mt},fuel:60,power:0},{head:{radius:at,mass:1,drag:0,angularDrag:rt,joint:vt},arms:[{type:J.base,width:ht,height:dt,mass:1,drag:pt,angularDrag:5,angle:-45,joint:vt},{type:J.simple,width:ht,height:lt,mass:ut,drag:pt,angularDrag:5,angle:55,joint:vt},{type:J.simple,width:ht,height:lt,mass:ut,drag:pt,angularDrag:5,angle:-50,joint:vt},{type:J.simple,width:ht,height:lt,mass:ut,drag:pt,angularDrag:5,angle:0,joint:vt},{type:J.head,width:ht,height:ct,mass:ut,drag:pt,angularDrag:5,angle:130,joint:vt}],base:{position:yt,radius:_t,mass:gt,drag:0,angularDrag:mt},fuel:60,power:0},{head:{radius:at,mass:1,drag:0,angularDrag:rt,joint:vt},arms:[{type:J.base,width:ht,height:dt,mass:1,drag:pt,angularDrag:5,angle:-69,joint:vt},{type:J.simple,width:ht,height:lt,mass:ut,drag:pt,angularDrag:5,angle:80,joint:vt},{type:J.simple,width:ht,height:lt,mass:ut,drag:pt,angularDrag:5,angle:-64,joint:vt},{type:J.simple,width:ht,height:lt,mass:ut,drag:pt,angularDrag:5,angle:73,joint:vt},{type:J.simple,width:ht,height:lt,mass:ut,drag:pt,angularDrag:5,angle:-62,joint:vt},{type:J.head,width:ht,height:ct,mass:ut,drag:pt,angularDrag:5,angle:55,joint:vt}],base:{position:yt,radius:_t,mass:gt,drag:0,angularDrag:mt},fuel:60,power:0},{head:{radius:at,mass:1,drag:0,angularDrag:rt,joint:vt},arms:[{type:J.base,width:ht,height:dt,mass:1,drag:pt,angularDrag:5,angle:-60,joint:vt},{type:J.simple,width:ht,height:lt,mass:ut,drag:pt,angularDrag:5,angle:55,joint:vt},{type:J.simple,width:ht,height:lt,mass:ut,drag:pt,angularDrag:5,angle:-57,joint:vt},{type:J.simple,width:ht,height:lt,mass:ut,drag:pt,angularDrag:5,angle:55,joint:vt},{type:J.simple,width:ht,height:lt,mass:ut,drag:pt,angularDrag:5,angle:-68,joint:vt},{type:J.simple,width:ht,height:lt,mass:ut,drag:pt,angularDrag:5,angle:70,joint:vt},{type:J.simple,width:ht,height:lt,mass:ut,drag:pt,angularDrag:5,angle:-68,joint:vt},{type:J.head,width:ht,height:ct,mass:ut,drag:pt,angularDrag:5,angle:82,joint:vt}],base:{position:yt,radius:_t,mass:gt,drag:0,angularDrag:mt},fuel:60,power:0}],wt={length:[10,300,4e3,1e4],fuel:[5,10,15,20,30,40,50,60,70,80,90,100,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290],power:[5,20,100,200,300,1e3,1200,1300,1400,1500,1600,1700,2e3,3e3,4e3],size:[15,90,130,250,350,500,600,780,935,1100]},{box2d:bt,analytics:kt,splashScreen:xt}=window.globals,Ct=()=>window.globals.app;i(6886);var Bt=i(3882);class Mt{constructor(t,e){(0,st.Z)(this,"__name__",void 0),(0,st.Z)(this,"_uuid",void 0),this.__name__=t,this._uuid=e||(0,Bt.Z)(this.__name__)}get uuid(){return this._uuid}makeObservable(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];s.q.observe.makeObservable(this,...e)}createObservable(t,e){s.q.observe.createObservable(this,t,e)}removeObservable(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];s.q.observe.removeObservable(this,...e)}initialize(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i]}destroy(){}}class St extends Mt{constructor(){super("CrusherModel"),(0,st.Z)(this,"_state",void 0),(0,st.Z)(this,"_fuel",void 0),(0,st.Z)(this,"_fuelMax",void 0),(0,st.Z)(this,"_velocity",{x:0,y:0}),(0,st.Z)(this,"_fuelConsumption",0),(0,st.Z)(this,"_config",void 0),(0,st.Z)(this,"_activeSkin",void 0),(0,st.Z)(this,"_lengthMetadataIndex",void 0),(0,st.Z)(this,"_fuelMetadataIndex",void 0),(0,st.Z)(this,"_powerMetadataIndex",void 0),(0,st.Z)(this,"_sizeMetadataIndex",void 0),(0,st.Z)(this,"_spendFuelTimerTask",void 0),this.makeObservable()}get lengthMetadataIndex(){return this._lengthMetadataIndex}get fuelMetadataIndex(){return this._fuelMetadataIndex}get powerMetadataIndex(){return this._powerMetadataIndex}get sizeMetadataIndex(){return this._sizeMetadataIndex}get velocity(){return this._velocity}get state(){return this._state}set state(t){this._state=t}get fuel(){return this._fuel}get fuelMax(){return this._fuelMax}get fuelRemaining(){return this._fuel/this._fuelMax}get config(){return this._config}get activeSkin(){return this._activeSkin}set activeSkin(t){this._activeSkin=t}getIncrementalProperty(t){return this["_".concat(t,"MetadataIndex")]}incrementProperty(t){this["_".concat(t,"MetadataIndex")]+=1,this.updateConfigWithImprovements()}updateConfigWithImprovements(){const t=(0,ot.Z)(ft[this._lengthMetadataIndex]);this._fuelMax=t.fuel+St._fuelImprovementEquation(wt.fuel.length),t.head.radius+=St._sizeImprovementEquation(this._sizeMetadataIndex),t.fuel+=St._fuelImprovementEquation(this._fuelMetadataIndex),t.power+=St._powerImprovementEquation(this._powerMetadataIndex),this._config=t,this.resetFuelValue()}initialize(t){this._lengthMetadataIndex=(0,nt.Z)(t,"length",St._lengthDefault),this._fuelMetadataIndex=(0,nt.Z)(t,"fuel",St._fuelDefault),this._powerMetadataIndex=(0,nt.Z)(t,"power",St._powerDefault),this._sizeMetadataIndex=(0,nt.Z)(t,"size",St._sizeDefault),this._activeSkin=(0,nt.Z)(t,"activeSkin",St._activeSkin),this.updateConfigWithImprovements(),this._state=it.idle}resetFuelValue(){this._fuel=this.config.fuel}resetProgress(){St.incrementalProperties.forEach((t=>{this["_".concat(t,"MetadataIndex")]=St["_".concat(t,"Default")]})),this.updateConfigWithImprovements()}reset(){this.setVelocity(0,0),this._state=it.idle}startSpendFuel(){this._spendFuelTimerTask=Ct().delay({loop:!0,delay:300,callback:()=>{this._fuel-=this._fuelConsumption,this._fuel<=14&&(this._state=it.warning),this._fuel<=0&&(this._state=it.outOfFuel)}})}stopSpendFuel(){this._spendFuelTimerTask&&Ct().cancel(this._spendFuelTimerTask)}destroy(){}setVelocity(t,e){const i=St._maxVelocity*t;this._velocity={x:Math.cos(e)*i,y:Math.sin(e)*i},this._fuelConsumption=t}serialize(){return JSON.stringify({length:this._lengthMetadataIndex,fuel:this._fuelMetadataIndex,power:this._powerMetadataIndex,size:this._sizeMetadataIndex,activeSkin:this._activeSkin})}}(0,st.Z)(St,"incrementalProperties",["length","fuel","power","size"]),(0,st.Z)(St,"_lengthDefault",0),(0,st.Z)(St,"_fuelDefault",0),(0,st.Z)(St,"_powerDefault",0),(0,st.Z)(St,"_sizeDefault",0),(0,st.Z)(St,"_activeSkin","basic"),(0,st.Z)(St,"_maxVelocity",3),(0,st.Z)(St,"_sizeImprovementEquation",(t=>.5*t)),(0,st.Z)(St,"_fuelImprovementEquation",(t=>5*t)),(0,st.Z)(St,"_powerImprovementEquation",(t=>2*t));const Zt={threshold:87};var Pt=i(1739);class Ut extends Mt{constructor(t){super("JoystickModel"),(0,st.Z)(this,"_radius",0),(0,st.Z)(this,"_azimuth",0),(0,st.Z)(this,"_threshold",0),this.config=t,this._threshold=t.threshold,this.makeObservable()}get azimuth(){return this._azimuth}get radius(){return this._radius}down(t,e){this._calculate(t,e)}up(t,e){this._radius=0}drag(t,e){this._calculate(t,e)}_calculate(t,e){const i=e.x-t.x,s=e.y-t.y;this._azimuth=Math.atan2(s,i),this._radius=(0,Pt.Z)(i/Math.cos(this._azimuth)/this._threshold,-1,1)}}var Tt=i(6673);class Ft extends Mt{constructor(){super("CoinsPropagatorModel"),(0,st.Z)(this,"_multiplier",1),(0,st.Z)(this,"_propagation",void 0),this.makeObservable()}get propagation(){return this._propagation}get multiplier(){return this._multiplier}set multiplier(t){this._multiplier=t}initialize(){}destroy(){}propagate(){const t=(0,Tt.Z)(0,4,!1),e=X["coin".concat(t)],i=$[e];this._propagation={coinType:e,money:i*this._multiplier}}}class Dt extends Mt{constructor(){super("CollectorModel"),this.makeObservable()}initialize(){}destroy(){}}class It extends Mt{constructor(t,e){super("WallModel"),(0,st.Z)(this,"_bricksData",void 0),(0,st.Z)(this,"_config",void 0),this._config=e,this._initBricksData(t),this.makeObservable()}get bricksData(){return this._bricksData}get bricksCount(){return this._bricksData.length}get config(){return this._config}initialize(){}destroy(){}_initBricksData(t){this._bricksData=[];for(const e in t){const i=+e,s=t[e];for(let t=0;t<s.length;t+=2){const e=s[t],o=s[t+1];this._bricksData.push({x:e,y:o,color:i})}}}}class Et extends Mt{constructor(t,e){super("LevelModel"),(0,st.Z)(this,"_state",void 0),(0,st.Z)(this,"_wall",void 0),(0,st.Z)(this,"_collector",void 0),(0,st.Z)(this,"_coinsPropagator",void 0),(0,st.Z)(this,"_wallData",void 0),(0,st.Z)(this,"_config",void 0),(0,st.Z)(this,"_joystick",void 0),(0,st.Z)(this,"_progress",void 0),(0,st.Z)(this,"_money",void 0),(0,st.Z)(this,"_bricksThrown",0),(0,st.Z)(this,"_completionReason",void 0),(0,st.Z)(this,"_crusher",void 0),this._config=t,this._wallData=e,this.makeObservable()}get config(){return this._config}get joystick(){return this._joystick}get state(){return this._state}set state(t){this._state=t}get completionReason(){return this._completionReason}set completionReason(t){this._completionReason=t}get crusher(){return this._crusher}get wall(){return this._wall}get collector(){return this._collector}get coinsPropagator(){return this._coinsPropagator}get progress(){return this._progress}get money(){return this._money}set money(t){this._money=t}bricksThrown(t){this._bricksThrown+=t,this._updateProgress()}initialize(t){this._wall=new It(this._wallData,this._config.wallConfig),this._wall.initialize(),this._collector=new Dt,this._collector.initialize(),this._coinsPropagator=new Ft,this._coinsPropagator.initialize(),this._initJoystick(Zt),this._crusher=t,this._state=Q.idle,this._progress=0,this._money=0}destroy(){this._wall.destroy(),this._wall=null,this._collector.destroy(),this._collector=null,this._coinsPropagator.destroy(),this._coinsPropagator=null,this._joystick.destroy(),this._joystick=null}_updateProgress(){this._progress=this._bricksThrown/this._wall.bricksCount}_initJoystick(t){this._joystick=new Ut(t),this._joystick.initialize()}}class Lt extends Mt{constructor(){super("TutorialModel"),this.makeObservable()}}class Ot extends Mt{constructor(){super("GameModel"),(0,st.Z)(this,"_state",void 0),(0,st.Z)(this,"_level",null),(0,st.Z)(this,"_crusher",null),(0,st.Z)(this,"_tutorial",null),this.makeObservable()}get level(){return this._level}get crusher(){return this._crusher}get tutorial(){return this._tutorial}get state(){return this._state}set state(t){this._state=t}initLevelModel(t,e){this._level=new Et(t,e),this._level.initialize(this._crusher)}destroyLevelModel(){this._level.destroy(),this._level=null}initCrusherModel(t){this._crusher=new St,this._crusher.initialize(t)}resetCrusherModel(){this._crusher.reset()}destroyCrusherModel(){this._crusher.destroy(),this._crusher=null}initTutorialModel(){this._tutorial=new Lt,this._tutorial.initialize()}destroyTutorialModel(){this._tutorial.destroy(),this._tutorial=null}}class At extends Mt{constructor(){super("GroundModel"),this.makeObservable()}}const qt={basic:t=>!1,superhero:t=>1===t.completedLevels,unicorn:t=>3===t.completedLevels,candy:t=>!1,plant:t=>!1,diamond:t=>!1,minecraft:t=>!1,rock:t=>!1,scifi:t=>!1,windmill:t=>!1};class zt extends Mt{constructor(){super("SkinModel"),(0,st.Z)(this,"_skin",void 0),(0,st.Z)(this,"_locked",void 0),(0,st.Z)(this,"_unlockCondition",void 0),this.makeObservable()}get unlockCondition(){return this._unlockCondition}get locked(){return this._locked}set locked(t){this._locked=t}get skin(){return this._skin}getSerializedData(){return{skin:this._skin,locked:this._locked}}initialize(t,e,i){this._skin=t,this._locked=e,this._unlockCondition=i}}const Gt=[{skin:"basic",locked:!1},{skin:"superhero",locked:!0},{skin:"unicorn",locked:!0},{skin:"candy",locked:!0},{skin:"plant",locked:!0},{skin:"diamond",locked:!0},{skin:"minecraft",locked:!0},{skin:"rock",locked:!0},{skin:"scifi",locked:!0},{skin:"windmill",locked:!0}];class jt extends Mt{constructor(){super("SkinSetModel"),(0,st.Z)(this,"_skins",[]),this.makeObservable()}get skins(){return this._skins}getSkinByUuid(t){return this._skins.find((e=>e.uuid===t))}getSkinBySkinName(t){return this._skins.find((e=>e.skin===t))}initialize(t){(0,nt.Z)(t,"skins",Gt).forEach((t=>{const{skin:e,locked:i}=t,s=new zt;s.initialize(e,i,qt[e]),this._skins.push(s)}))}serialize(){return JSON.stringify({skins:this._skins.map((t=>t.getSerializedData()))})}}class Wt extends Mt{constructor(){super("StatisticsModel"),(0,st.Z)(this,"_totalMoney",0),(0,st.Z)(this,"_completedLevels",0),this.makeObservable()}get totalMoney(){return this._totalMoney}set totalMoney(t){this._totalMoney=t}get completedLevels(){return this._completedLevels}set completedLevels(t){this._completedLevels=t}initialize(t){this._completedLevels=(0,nt.Z)(t,"completedLevels",0)}serialize(){return JSON.stringify({completedLevels:this._completedLevels})}}var Vt=i(4402);class Rt extends Mt{constructor(){super("CrusherPropertiesShopModel"),(0,st.Z)(this,"_lengthButton",void 0),(0,st.Z)(this,"_fuelButton",void 0),(0,st.Z)(this,"_powerButton",void 0),(0,st.Z)(this,"_sizeButton",void 0),this.makeObservable()}get lengthButton(){return this._lengthButton}get fuelButton(){return this._fuelButton}get powerButton(){return this._powerButton}get sizeButton(){return this._sizeButton}initialize(t,e){this.updateButtons(t,e)}updateButtons(t,e){this._lengthButton=this._updateButton("length",t,e),this._fuelButton=this._updateButton("fuel",t,e),this._powerButton=this._updateButton("power",t,e),this._sizeButton=this._updateButton("size",t,e)}_updateButton(t,e,i){const s=e["".concat(t,"MetadataIndex")],o=wt[t][s],n=o/3;if((0,Vt.Z)(o))return{price:1/0,name:t,enabled:!1,discount:!1,discountPrice:1/0};const a=i>=n&&i<o;return{price:o,name:t,enabled:o<=i||a,discount:a,discountPrice:n}}}class Ht extends Mt{constructor(){super("PopupQueueModel"),(0,st.Z)(this,"_queue",[]),(0,st.Z)(this,"_active",void 0),this.makeObservable("_queue","_active")}get length(){return this._queue.length}get queue(){return this._queue}get active(){return this._active}setActive(t){this._active=t,this._active.initialize(),this._active.show()}push(t){this._queue=[...this._queue,t]}shift(){this._active=null;const t=[...this._queue];t.shift(),this._queue=t}hasPopupInQueue(t){return!!this._queue.find((e=>e.type===t))}}class Nt extends Mt{constructor(){super("UIModel"),(0,st.Z)(this,"_popupQueue",null),(0,st.Z)(this,"_crusherPropertiesShopModel",null),this.makeObservable()}get popupQueue(){return this._popupQueue}get crusherPropertiesShopModel(){return this._crusherPropertiesShopModel}initialize(){this._popupQueue=new Ht,this._popupQueue.initialize()}initCrusherPropertiesShopModel(t,e){this._crusherPropertiesShopModel=new Rt,this._crusherPropertiesShopModel.initialize(t,e)}}class Jt extends Mt{constructor(){super("UserModel"),(0,st.Z)(this,"_ftue",void 0),(0,st.Z)(this,"_level",void 0),(0,st.Z)(this,"_money",void 0),(0,st.Z)(this,"_haptic",void 0),(0,st.Z)(this,"_mute",void 0),this.makeObservable("_ftue","_level","_money","_haptic","_mute")}initialize(t){this._ftue=(0,nt.Z)(t,"ftue",Jt._ftueDefault),this._level=(0,nt.Z)(t,"level",Jt._levelDefault),this._money=(0,nt.Z)(t,"money",Jt._moneyDefault),this._haptic=(0,nt.Z)(t,"haptic",Jt._hapticDefault),this._mute=(0,nt.Z)(t,"mute",Jt._muteDefault)}get ftue(){return this._ftue}set ftue(t){this._ftue=t}get level(){return this._level}set level(t){this._level=t}get money(){return this._money}set money(t){this._money=t}get haptic(){return this._haptic}set haptic(t){this._haptic=t}get mute(){return this._mute}set mute(t){this._mute=t}serialize(){return JSON.stringify({money:this._money,haptic:this._haptic,mute:this._mute,level:this._level,ftue:this._ftue})}}(0,st.Z)(Jt,"_ftueDefault",1),(0,st.Z)(Jt,"_levelDefault",1),(0,st.Z)(Jt,"_moneyDefault",0),(0,st.Z)(Jt,"_hapticDefault",1),(0,st.Z)(Jt,"_muteDefault",0);const Yt=new class extends Mt{constructor(){super("Store"),(0,st.Z)(this,"_user",void 0),(0,st.Z)(this,"_statistics",void 0),(0,st.Z)(this,"_skinSet",void 0),(0,st.Z)(this,"_game",void 0),(0,st.Z)(this,"_ui",void 0),(0,st.Z)(this,"_ground",void 0),this.makeObservable()}get user(){return this._user}get game(){return this._game}get ui(){return this._ui}get ground(){return this._ground}get skinSet(){return this._skinSet}get statistics(){return this._statistics}initUserModel(t){this._user=new Jt,this._user.initialize(t)}initStatisticsModel(t){this._statistics=new Wt,this._statistics.initialize(t)}initSkinSetModel(t){this._skinSet=new jt,this._skinSet.initialize(t)}initGameModel(){this._game=new Ot,this._game.initialize()}initUIModel(){this._ui=new Nt,this._ui.initialize()}initGroundModel(){this._ground=new At,this._ground.initialize()}},Qt=t=>{Yt.game.state=t},Kt=()=>{s.q.command.payload(Y.idle).execute(Qt)},Xt=async()=>{const{game:t}=Yt,e=await Ct().getSavedProgression([N.crusher]);t.initCrusherModel(JSON.parse(e.crusher||"{}"))},$t=()=>{const{ui:t,game:e,user:i}=Yt,{crusher:s}=e,{money:o}=i;t.initCrusherPropertiesShopModel(s,o)},te=()=>{Yt.initGameModel()},ee=()=>{Yt.initGroundModel()};var ie=i(7827);const se={rotation:{x:{min:0,max:-Math.PI/6},y:{min:-Math.PI/12,max:Math.PI/12}},scale:{min:.9,max:1.2},zOffset:{probability:.1,value:{min:-.5,max:.2}}},oe=[{wallConfig:{position:{x:1,y:0},distortion:se},difficulty:1,mapKey:"level-1"},{wallConfig:{position:{x:-4.6,y:0},distortion:se},difficulty:1,mapKey:"level-2"},{wallConfig:{position:{x:-4.6,y:0},distortion:se},difficulty:1,mapKey:"level-3"},{wallConfig:{position:{x:-4.6,y:0},distortion:se},difficulty:1,mapKey:"level-4"},{wallConfig:{position:{x:-4.6,y:0},distortion:se},difficulty:1,mapKey:"level-5"},{wallConfig:{position:{x:-4.6,y:0},distortion:se},difficulty:1,mapKey:"level-6"},{wallConfig:{position:{x:-4.6,y:0},distortion:se},difficulty:1,mapKey:"level-7"},{wallConfig:{position:{x:2-5.6,y:0},distortion:se},difficulty:1,mapKey:"level-8"},{wallConfig:{position:{x:-4.6,y:0},distortion:se},difficulty:1,mapKey:"level-9"},{wallConfig:{position:{x:-4.6,y:0},distortion:se},difficulty:1,mapKey:"level-10"},{wallConfig:{position:{x:-4.6,y:0},distortion:se},difficulty:1,mapKey:"level-11"}],ne=async()=>{const{user:t}=Yt,e=oe[(t.level-1)%11],i=await fetch(ie.L.levels[e.mapKey],{headers:{"Content-Type":"application/json"}}),s=await i.json();Yt.game.initLevelModel(e,s)},ae=()=>{Yt.initUIModel()},re=()=>{window.globals.splashScreen.hide()};var he=i(3287);const le="arm-superhero",de="arm-unicorn",ce="coin-025",ue="coin-05",pe="coin-1",_e="coin-3",ge="coin-5",me="grass",ye="grey-checker",ve="half-grass-1",fe="half-grass-2",we="half-grass-3",be="half-grass-4",ke="hand",xe="sand",Ce="saw-superhero",Be="saw-unicorn-01",Me="saw-unicorn-02",Se="sky";const Ze=new class{constructor(){(0,st.Z)(this,"_skyMaterial",new he.YBo),(0,st.Z)(this,"_grassMaterial",new he.YBo({polygonOffset:!0,depthTest:!0,polygonOffsetFactor:.001,polygonOffsetUnits:.1,side:he.Wl3,shadowSide:he.Wl3})),(0,st.Z)(this,"_halfGrassMaterial1",this._grassMaterial.clone()),(0,st.Z)(this,"_halfGrassMaterial2",this._grassMaterial.clone()),(0,st.Z)(this,"_halfGrassMaterial3",this._grassMaterial.clone()),(0,st.Z)(this,"_halfGrassMaterial4",this._grassMaterial.clone()),(0,st.Z)(this,"_sandMaterial",this._grassMaterial.clone()),(0,st.Z)(this,"_wallMaterial",new he.xoR({specular:328965,shininess:25})),(0,st.Z)(this,"_collectorYellowMaterial",new he.YBo({color:16766208,emissive:"#652d03"})),(0,st.Z)(this,"_collectorBlueMaterial",new he.YBo({color:38655})),(0,st.Z)(this,"_propagatorTubeMaterial",new he.YBo({color:3727103})),(0,st.Z)(this,"_gasCanMaterial",new he.Wid({vertexColors:!0,roughness:.031,metalness:0})),(0,st.Z)(this,"_coinsMaterial",{[X.coin0]:new he.YBo,[X.coin1]:new he.YBo,[X.coin2]:new he.YBo,[X.coin3]:new he.YBo,[X.coin4]:new he.YBo}),(0,st.Z)(this,"_tutorialMaterial",new he.xeV({transparent:!0}))}getSkyMaterial(){const{resources:t}=Ct().runtimes.get("three").loader,e=t.textures.get(Se);return e.generateMipmaps=!1,e.magFilter=he.TyD,e.minFilter=he.TyD,this._skyMaterial.map=e,this._skyMaterial.transparent=!0,this._skyMaterial.needsUpdate=!0,this._skyMaterial.opacity=.23,this._skyMaterial}getGrassMaterial(){const{resources:t}=Ct().runtimes.get("three").loader,e=t.textures.get(me),i=t.textures.get(xe),s=t.textures.get(ve),o=t.textures.get(fe),n=t.textures.get(we),a=t.textures.get(be);return e.magFilter=he.TyD,i.magFilter=he.TyD,s.magFilter=he.TyD,o.magFilter=he.TyD,n.magFilter=he.TyD,a.magFilter=he.TyD,s.minFilter=he.TyD,o.minFilter=he.TyD,n.minFilter=he.TyD,a.minFilter=he.TyD,s.generateMipmaps=!1,o.generateMipmaps=!1,n.generateMipmaps=!1,a.generateMipmaps=!1,this._grassMaterial.map=e,this._halfGrassMaterial1.map=s,this._halfGrassMaterial2.map=o,this._halfGrassMaterial3.map=n,this._halfGrassMaterial4.map=a,this._sandMaterial.map=i,this._grassMaterial.needsUpdate=!0,this._halfGrassMaterial1.needsUpdate=!0,this._halfGrassMaterial2.needsUpdate=!0,this._halfGrassMaterial3.needsUpdate=!0,this._halfGrassMaterial4.needsUpdate=!0,this._sandMaterial.needsUpdate=!0,[this._halfGrassMaterial1,this._halfGrassMaterial2,this._grassMaterial,this._sandMaterial,this._halfGrassMaterial3,this._halfGrassMaterial4]}getSandMaterial(){return this._sandMaterial}getWallMaterial(){return this._wallMaterial}getCollectorYellowMaterial(){const{resources:t}=Ct().runtimes.get("three").loader,e=t.textures.get(ye);return e.wrapS=he.rpg,e.wrapT=he.rpg,e.magFilter=he.TyD,e.repeat.set(1.5,.5),this._collectorYellowMaterial.map=e,this._collectorYellowMaterial.needsUpdate=!0,this._collectorYellowMaterial}getCollectorBlueMaterial(){return this._collectorBlueMaterial}getPropagatorTubeMaterial(){return this._propagatorTubeMaterial}getGasCanMaterial(){return this._gasCanMaterial}getCoinMaterial(t){return this._coinsMaterial[t]}getTutorialMaterial(){const{resources:t}=Ct().runtimes.get("three").loader,e=t.textures.get(ke);return e.magFilter=he.TyD,e.minFilter=he.TyD,e.generateMipmaps=!1,this._tutorialMaterial.map=e,this._tutorialMaterial.needsUpdate=!0,this._tutorialMaterial}initMainChunk(){}initExtraChunk(){this.initCoinsMaterial()}initCoinsMaterial(){const{resources:t}=Ct().runtimes.get("three").loader,e=t.textures.get(ce),i=t.textures.get(ue),s=t.textures.get(pe),o=t.textures.get(_e),n=t.textures.get(ge);e.minFilter=he.TyD,e.magFilter=he.TyD,i.minFilter=he.TyD,i.magFilter=he.TyD,s.minFilter=he.TyD,s.magFilter=he.TyD,o.minFilter=he.TyD,o.magFilter=he.TyD,n.minFilter=he.TyD,n.magFilter=he.TyD,e.generateMipmaps=!1,i.generateMipmaps=!1,s.generateMipmaps=!1,o.generateMipmaps=!1,n.generateMipmaps=!1,this._coinsMaterial[X.coin0].map=e,this._coinsMaterial[X.coin1].map=i,this._coinsMaterial[X.coin2].map=s,this._coinsMaterial[X.coin3].map=o,this._coinsMaterial[X.coin4].map=n,this._coinsMaterial[X.coin0].needsUpdate=!0,this._coinsMaterial[X.coin1].needsUpdate=!0,this._coinsMaterial[X.coin2].needsUpdate=!0,this._coinsMaterial[X.coin3].needsUpdate=!0,this._coinsMaterial[X.coin4].needsUpdate=!0}},Pe="saw-basic",Ue="saw-superhero",Te="saw-unicorn";class Fe extends he.ZAu{constructor(t,e){super(),(0,st.Z)(this,"speed",void 0),this.radius=t,this.power=e,this.speed=Math.PI/38+.0015*this.power}destroy(){}update(){this.rotateZ(-this.speed)}}class De extends Fe{constructor(t,e){super(t,e),(0,st.Z)(this,"_saw1",void 0),(0,st.Z)(this,"_saw2",void 0),(0,st.Z)(this,"_scene",void 0),this._build()}destroy(){this._scene.clear(),this._scene.removeFromParent(),this._saw1.geometry.dispose(),this._saw2.geometry.dispose(),this._saw1.material.dispose(),this._saw2.material.dispose(),this._scene=null}_build(){const{resources:t}=Ct().runtimes.get("three").loader,e=t.models.get(Pe).scene.clone(!0);this._saw1=e.getObjectByName("saw_basic_01"),this._saw2=e.getObjectByName("saw_basic_02"),this._saw1.material=De._material,this._saw2.material=De._material,this._saw1.castShadow=!0,this._saw1.receiveShadow=!0,this._saw2.castShadow=!0,this._saw2.receiveShadow=!0,e.scale.set(this.radius,this.radius,3.7),this.add(this._scene=e)}}(0,st.Z)(De,"_material",new he.Wid({color:16711725,roughness:.031,metalness:0}));class Ie extends Fe{constructor(t,e){super(t,e),(0,st.Z)(this,"_scene",void 0),(0,st.Z)(this,"_saw",void 0),(0,st.Z)(this,"_blades",void 0),this._build()}destroy(){this._scene.clear(),this._scene.removeFromParent(),this._saw.geometry.dispose(),this._blades.geometry.dispose(),this._saw.material.dispose(),this._blades.material.dispose(),this._scene=null}_build(){const{resources:t}=Ct().runtimes.get("three").loader,e=t.models.get(Ue).scene.clone(!0),i=t.textures.get(Ce);i.magFilter=he.TyD,i.minFilter=he.TyD,i.generateMipmaps=!1,this._saw=e.getObjectByName("superhero_saw"),this._blades=e.getObjectByName("superhero_blades"),Ie._materialSaw.map=i,this._saw.material=Ie._materialSaw,this._blades.material=Ie._materialBlades,this._saw.castShadow=!0,this._saw.receiveShadow=!0,this._blades.castShadow=!0,this._blades.receiveShadow=!0,e.scale.set(this.radius,this.radius,3.7),this.add(this._scene=e)}}(0,st.Z)(Ie,"_materialSaw",new he.Wid({roughness:.4,metalness:.32})),(0,st.Z)(Ie,"_materialBlades",new he.YBo({color:13421772}));class Ee extends Fe{constructor(t,e){super(t,e),(0,st.Z)(this,"_scene",void 0),(0,st.Z)(this,"_saw",void 0),(0,st.Z)(this,"_blades",void 0),this._build()}destroy(){this._scene.clear(),this._scene.removeFromParent(),this._saw.geometry.dispose(),this._blades.geometry.dispose(),this._saw.material.dispose(),this._blades.material.dispose(),this._scene=null}_build(){const{resources:t}=Ct().runtimes.get("three").loader,e=t.models.get(Te).scene.clone(!0),i=t.textures.get(Be),s=t.textures.get(Me);i.magFilter=he.TyD,i.minFilter=he.TyD,i.generateMipmaps=!1,s.magFilter=he.TyD,s.minFilter=he.TyD,s.generateMipmaps=!1,this._saw=e.getObjectByName("unicorn_saw"),this._blades=e.getObjectByName("unicorn_blades"),Ee._materialSaw.map=i,Ee._materialBlades.map=s,this._saw.material=Ee._materialSaw,this._blades.material=Ee._materialBlades,this._saw.castShadow=!0,this._saw.receiveShadow=!0,this._blades.castShadow=!0,this._blades.receiveShadow=!0,e.scale.set(this.radius,this.radius,3.7),this.add(this._scene=e)}}(0,st.Z)(Ee,"_materialSaw",new he.YBo({emissive:16763860,emissiveIntensity:.2})),(0,st.Z)(Ee,"_materialBlades",new he.YBo({emissive:16763860,emissiveIntensity:.2}));const Le=new class{constructor(){(0,st.Z)(this,"_jointBasicMaterial",new he.YBo({vertexColors:!0})),(0,st.Z)(this,"_jointUnicornMaterial",new he.YBo({vertexColors:!0,emissive:16763860,emissiveIntensity:.2})),(0,st.Z)(this,"_jointSuperheroMaterial",new he.YBo({vertexColors:!0})),(0,st.Z)(this,"_armBasicMaterial",new he.YBo({color:34559})),(0,st.Z)(this,"_armUnicornMaterial",new he.YBo({emissive:16763860,emissiveIntensity:.1})),(0,st.Z)(this,"_armSuperheroMaterial",new he.Wid({emissive:16777215,emissiveIntensity:.1}))}getHeadDisk(t,e,i){let s;switch(t){case"basic":s=new De(e,i);break;case"unicorn":s=new Ee(e,i);break;case"superhero":s=new Ie(e,i)}return s}getJointMaterialConfig(t){let e;switch(t){case"basic":e={material:this._jointBasicMaterial,color1:16777215,color2:26237};break;case"unicorn":e={material:this._jointUnicornMaterial,color1:16763860,color2:15518064};break;case"superhero":e={material:this._jointSuperheroMaterial,color1:9211020,color2:10921638}}return e}getArmMaterial(t){let e;switch(t){case"basic":e=this._armBasicMaterial;break;case"unicorn":e=this._armUnicornMaterial;break;case"superhero":e=this._armSuperheroMaterial}return e}initMainChunk(){this._initUnicornArmMaterial(),this._initSuperheroArmMaterial()}initExtraChunk(){}_initUnicornArmMaterial(){const{resources:t}=Ct().runtimes.get("three").loader,e=t.textures.get(de);e.magFilter=he.TyD,e.minFilter=he.TyD,e.generateMipmaps=!1,this._armUnicornMaterial.map=e,this._armUnicornMaterial.needsUpdate=!0}_initSuperheroArmMaterial(){const{resources:t}=Ct().runtimes.get("three").loader,e=t.textures.get(le);e.wrapS=he.rpg,e.wrapT=he.OoA,e.repeat.set(2,2.61),e.offset.set(.5,0),e.magFilter=he.TyD,e.minFilter=he.TyD,e.generateMipmaps=!1,this._armSuperheroMaterial.map=e,this._armSuperheroMaterial.needsUpdate=!0}},Oe=()=>{Ze.initExtraChunk(),Le.initExtraChunk()},Ae=()=>{Ze.initMainChunk(),Le.initMainChunk()},qe=()=>{const{user:t}=Yt;return!!t.ftue},ze=()=>{Yt.game.initTutorialModel()},Ge=t=>{Yt.game.level.state=t};var je=i(8744);const We=(0,je.Z)((()=>{const{user:t}=Yt,e=t.serialize();Ct().saveProgression(N.user,e)}),1e3,{leading:!0,trailing:!0}),Ve=()=>{We()},Re=()=>{const{user:t}=Yt,{ftue:e}=t;t.ftue=e?0:1,s.q.command.execute(Ve)},He=()=>{s.q.command.execute(ze).payload(Y.play).execute(Qt).payload(Q.play).execute(Ge).execute(Re)},Ne=()=>{Ct().show(),s.q.command.guard(qe).execute(He)},Je=async()=>{const t=await Ct().getSavedProgression([N.skins]);Yt.initSkinSetModel(JSON.parse(t.skins||"{}"))},Ye=async()=>{const t=await Ct().getSavedProgression([N.statistics]);Yt.initStatisticsModel(JSON.parse(t.statistics||"{}"))},Qe=async()=>{const t=await Ct().getSavedProgression([N.user]);Yt.initUserModel(JSON.parse(t.user||"{}"))},Ke=t=>{Ct().interactive=t},Xe=t=>{Ct().loadChunk(t)},$e=async t=>{switch(t){case"main":s.q.command.payload(!1).execute(Ke),await s.q.command.executeAsync(Ae),await s.q.command.executeAsync(Qe),await s.q.command.executeAsync(Ye),await s.q.command.executeAsync(Je),await s.q.command.executeAsync(te),await s.q.command.executeAsync(Xt),await s.q.command.executeAsync(ae),await s.q.command.executeAsync($t),await s.q.command.executeAsync(ee),await s.q.command.executeAsync(Kt),await s.q.command.executeAsync(ne),await s.q.command.executeAsync(Ne),await s.q.command.executeAsync(re),s.q.command.payload(!0).execute(Ke),s.q.command.payload("extra").execute(Xe);break;case"extra":s.q.command.execute(Oe)}},ti=t=>{t},ei=t=>{t},ii={fov:60,aspect:1,near:10,far:150,position:{x:-2.0999999999999996,y:16.299999999999997,z:120}};var si=i(1223),oi=i(6353),ni=i(8492);class ai{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.x=t,this.y=e,this.width=i,this.height=s}set(t,e,i,s){return this.x=t,this.y=e,this.width=i,this.height=s,this}copyFrom(t){let{x:e,y:i,width:s,height:o}=t;return this.set(e,i,s,o),this}}const ri=1e3/60,hi=()=>!(0,si.Z)().any&&li(j.landscape,j.portrait)===j.landscape&&ni.orientation===j.portrait,li=(t,e)=>window.matchMedia("(orientation: portrait)").matches?e:window.matchMedia("(orientation: landscape)").matches?t:e;function di(){return Math.min(window.devicePixelRatio||1,2)}const ci=(t,e)=>{Object.values(t).forEach((t=>e(t)))},ui=(t,e,i)=>(1-i)*t+i*e,pi=Math.PI/180,_i=(Math.PI,t=>t>=1e3?"".concat((t/1e3).toFixed(t%1e3==0?0:1),"k$"):"".concat(t.toFixed(t%1!=0?1:0),"$")),gi=(new oi.UAParser).getResult();class mi{constructor(){(0,st.Z)(this,"name","camera"),(0,st.Z)(this,"_cameraOriginPosition",void 0),(0,st.Z)(this,"_camera",void 0),(0,st.Z)(this,"_app",void 0),(0,st.Z)(this,"_head",void 0),(0,st.Z)(this,"onInstall",(()=>{this._app=Ct(),this._setupCamera(),s.q.event.on(r.stateUpdate,this._onLevelStateUpdate,this)}))}_setupCamera(){const t=Ct().getRuntime("three"),{camera:e}=t,{fov:i,aspect:s,near:o,far:n,position:a}=ii;e.fov=i,e.aspect=s,e.near=o,e.far=n,e.position.set(a.x,a.y,a.z),this._camera=e,this._cameraOriginPosition=e.position.clone()}_onLevelStateUpdate(t){switch(t){case Q.play:this._startFollowCamera();break;case Q.idle:this._resetCamera(),this._stopFollowCamera();break;default:this._stopFollowCamera()}}_resetCamera(){this._camera.position.copy(this._cameraOriginPosition)}_followCamera(){const{x:t,y:e}=this._head.GetPosition();let i=0,s=0;t<mi._cameraXThresholdStart?i=this._cameraOriginPosition.x:(i=this._cameraOriginPosition.x+(t-mi._cameraXThresholdStart),i>mi._cameraXThresholdEnd&&(i=mi._cameraXThresholdEnd)),s=e>mi._cameraYThreshold?this._cameraOriginPosition.y:this._cameraOriginPosition.y-(e-mi._cameraYThreshold),this._camera.position.x=ui(this._camera.position.x,i,ri/50),this._camera.position.y=ui(this._camera.position.y,s,ri/50)}_stopFollowCamera(){this._app.remove(this._followCamera,this),this._head=null}_startFollowCamera(){const{physics2dWorld:t}=this._app;for(let e=t.GetBodyList();bt.getPointer(e);e=e.GetNext()){const t=e.__userData__;if("head"===(null==t?void 0:t.id)){this._head=e;break}}this._app.add(this._followCamera,this)}}(0,st.Z)(mi,"_cameraXThresholdStart",4),(0,st.Z)(mi,"_cameraXThresholdEnd",30),(0,st.Z)(mi,"_cameraYThreshold",-60);class yi{constructor(){(0,st.Z)(this,"name","haptic"),(0,st.Z)(this,"_vibrateDigThrottled",void 0),(0,st.Z)(this,"onInstall",(()=>{s.q.event.once(C.userUpdate,this._onUserUpdate,this),this._initVibrateDigThrottle()})),(0,st.Z)(this,"_onUserUpdate",(()=>{s.q.event.on(S.hapticUpdate,this._onHapticUpdate,this)})),(0,st.Z)(this,"_onHapticUpdate",(t=>{t?this._enable():this._disable()})),(0,st.Z)(this,"_onBricksThrown",(()=>{this._vibrateDigThrottled()})),(0,st.Z)(this,"_onButtonClick",(()=>{this._vibrate(R.light)})),(0,st.Z)(this,"_onPopupShowStart",(()=>{const{ui:t}=Yt,{popupQueue:e}=t,{type:i}=e.active;switch(i){case tt.levelCompleted:this._vibrate(R.extreme);break;case tt.outOfFuel:this._vibrate(R.medium)}}))}_enable(){s.q.event.on(F.bricksThrown,this._onBricksThrown,this).on(U.settingsButtonClick,this._onButtonClick,this).on(U.playButtonClick,this._onButtonClick,this).on(U.backButtonClick,this._onButtonClick,this).on(U.skinsButtonClick,this._onButtonClick,this).on(U.skinsCloseButtonClick,this._onButtonClick,this).on(A.fillThankClick,this._onButtonClick,this).on(A.noThanksClick,this._onButtonClick,this).on(L.continueClick,this._onButtonClick,this).on(L.inviteFriendsClick,this._onButtonClick,this).on(L.shareWithFriendsClick,this._onButtonClick,this).on(O.continueClick,this._onButtonClick,this).on(O.inviteFriendsClick,this._onButtonClick,this).on(O.shareWithFriendsClick,this._onButtonClick,this).on(E.hapticClick,this._onButtonClick,this).on(E.soundClick,this._onButtonClick,this).on(I.closeBtnClick,this._onButtonClick,this).on(q.selectClick,this._onButtonClick,this).on(U.propertiesShopButtonClick,this._onButtonClick,this).on(U.skinsShopButtonClick,this._onButtonClick,this).on(I.showStart,this._onPopupShowStart,this)}_disable(){s.q.event.off(F.bricksThrown,this._onBricksThrown,this).off(U.settingsButtonClick,this._onButtonClick,this).off(U.playButtonClick,this._onButtonClick,this).off(U.backButtonClick,this._onButtonClick,this).off(U.skinsButtonClick,this._onButtonClick,this).off(U.skinsCloseButtonClick,this._onButtonClick,this).off(A.fillThankClick,this._onButtonClick,this).off(A.noThanksClick,this._onButtonClick,this).off(L.continueClick,this._onButtonClick,this).off(L.inviteFriendsClick,this._onButtonClick,this).off(L.shareWithFriendsClick,this._onButtonClick,this).off(O.continueClick,this._onButtonClick,this).off(O.inviteFriendsClick,this._onButtonClick,this).off(O.shareWithFriendsClick,this._onButtonClick,this).off(E.hapticClick,this._onButtonClick,this).off(E.soundClick,this._onButtonClick,this).off(I.closeBtnClick,this._onButtonClick,this).off(q.selectClick,this._onButtonClick,this).off(U.propertiesShopButtonClick,this._onButtonClick,this).off(U.skinsShopButtonClick,this._onButtonClick,this).off(I.showStart,this._onPopupShowStart,this)}_initVibrateDigThrottle(){this._vibrateDigThrottled=(0,je.Z)(this._vibrateDig,300,{trailing:!1,leading:!0})}_vibrateDig(){switch((0,Tt.Z)(1,3)){case 1:this._vibrate(R.light);break;case 2:this._vibrate(R.medium);break;case 3:this._vibrate(R.heavy)}}_vibrate(t){Ct().vibrate(t)}}const vi={1:350,2:350,3:1200},fi={bricksCullLimit:vi[3]};class wi{constructor(){(0,st.Z)(this,"name","performance"),(0,st.Z)(this,"_app",void 0),(0,st.Z)(this,"_gpuTier",void 0),(0,st.Z)(this,"onInstall",(async()=>{this._app=Ct(),this._gpuTier=await this._app.getGPUTier(),this._adjustRenderer()}))}_adjustRenderer(){const{renderer:t}=this._app.getRuntime("three");t.shadowMap.enabled=!this._gpuTier.isMobile||this._gpuTier.tier>2,fi.bricksCullLimit=this._gpuTier.isMobile?vi[this._gpuTier.tier]:vi[3]}}var bi=i(2409),ki=i(12),xi=i(4009),Ci=i(4770);let Bi;!function(t){t.unknown="unknown",t.init="init",t.show="show",t.idle="idle",t.hide="hide",t.destroy="destroy"}(Bi||(Bi={}));class Mi extends Mt{constructor(t,e,i){super(t),(0,st.Z)(this,"_state",Bi.unknown),this._type=e,this._config=i,this.makeObservable("_state")}get state(){return this._state}get type(){return this._type}get config(){return this._config}show(){this.setState(Bi.show)}hide(){this.setState(Bi.hide)}initialize(){this.setState(Bi.init)}setState(t){this._state=t}}class Si extends Mi{constructor(t,e){super("PopupAbortModel",t,e),(0,st.Z)(this,"_lifetimeExceeded",!1),this.makeObservable("_lifetimeExceeded")}get lifetimeExceeded(){return this._lifetimeExceeded}show(){super.show(),Ct().delay({delay:Si._lifetime,callback:this._onLifetimeExceeded,context:this})}_onLifetimeExceeded(){this._lifetimeExceeded=!0}}(0,st.Z)(Si,"_lifetime",1500);var Zi=i(2817);const Pi={"bg-popup-skin-unlock":"bg-popup-skin-unlock.png","icon-skin-scifi-large":"icon-skin-scifi-large.png","icon-skin-windmill-large":"icon-skin-windmill-large.png","icon-skin-unicorn-large":"icon-skin-unicorn-large.png","icon-skin-superhero-large":"icon-skin-superhero-large.png","icon-skin-candy-large":"icon-skin-candy-large.png","icon-skin-plant-large":"icon-skin-plant-large.png","icon-skin-rock-large":"icon-skin-rock-large.png","icon-skin-basic-large":"icon-skin-basic-large.png","icon-skin-minecraft-large":"icon-skin-minecraft-large.png","icon-skin-diamond-large":"icon-skin-diamond-large.png","icon-dispenser":"icon-dispenser.png","button-fill-tank-pressed":"button-fill-tank-pressed.png","button-fill-tank":"button-fill-tank.png","button-invite-pressed":"button-invite-pressed.png","button-invite":"button-invite.png","button-share-pressed":"button-share-pressed.png","button-share":"button-share.png",rays:"rays.png","icon-skin-scifi":"icon-skin-scifi.png","icon-skin-windmill":"icon-skin-windmill.png","icon-skin-unicorn":"icon-skin-unicorn.png","button-select-skin-pressed":"button-select-skin-pressed.png","button-select-skin":"button-select-skin.png","icon-skin-superhero":"icon-skin-superhero.png","icon-skin-candy":"icon-skin-candy.png","icon-skin-plant":"icon-skin-plant.png","icon-skin-rock":"icon-skin-rock.png","icon-skin-basic":"icon-skin-basic.png","icon-skin-minecraft":"icon-skin-minecraft.png","icon-skin-diamond":"icon-skin-diamond.png","button-close-pressed":"button-close-pressed.png","button-close":"button-close.png","button-shop-pressed":"button-shop-pressed.png","button-shop":"button-shop.png","bg-popup":"bg-popup.png","joystick/background":"joystick/background.png","button-pressed":"button-pressed.png",button:"button.png","button-property-pressed":"button-property-pressed.png","button-property":"button-property.png","button-skins-pressed":"button-skins-pressed.png","button-skins":"button-skins.png","button-upgrades-pressed":"button-upgrades-pressed.png","button-upgrades":"button-upgrades.png","bg-discount-pressed":"bg-discount-pressed.png","bg-discount":"bg-discount.png","icon-property-size":"icon-property-size.png","bg-switcher":"bg-switcher.png","icon-property-power":"icon-property-power.png","joystick/handle":"joystick/handle.png","icon-property-fuel":"icon-property-fuel.png","icon-property-length":"icon-property-length.png","bg-property-blue-dark":"bg-property-blue-dark.png","bg-property-blue":"bg-property-blue.png","bg-out-of-fuel":"bg-out-of-fuel.png","button-popup-close-pressed":"button-popup-close-pressed.png","button-popup-close":"button-popup-close.png","icon-sound":"icon-sound.png","icon-haptic":"icon-haptic.png","handle-switcher":"handle-switcher.png","gear-pressed":"gear-pressed.png",gear:"gear.png",warning:"warning.png",fuel:"fuel.png",fog:"fog.png","bg-shop-blue-dark":"bg-shop-blue-dark.png","bg-shop-blue":"bg-shop-blue.png","bg-plain":"bg-plain.png",money:"money.png","bg-level-progress":"bg-level-progress.png","bg-fuel-progress":"bg-fuel-progress.png","rail-switcher":"rail-switcher.png","fill-fuel-progress":"fill-fuel-progress.png","fill-level-progress":"fill-level-progress.png"},Ui={texture:Pi["button-invite"],data:[82,0,60,0],width:460,height:131},Ti={texture:Pi["button-share"],data:[82,0,60,0],width:460,height:131},Fi={texture:Pi.button,data:[67,66,67,76],anchor:{x:.5,y:.5},width:400,height:138},Di={texture:Pi.button,data:[67,66,67,76],anchor:{x:1,y:.5},width:300,height:138},Ii={texture:Pi["bg-property-blue"],data:[45,44,45,1],width:132,height:136,position:{x:0,y:-26}},Ei={texture:Pi["bg-shop-blue"],data:[27,27,27,1],width:156,height:132,position:{x:0,y:-42}},Li={texture:Pi["button-property"],data:[56,56,56,67],width:170,height:230},Oi={texture:Pi["button-shop"],data:[34,34,34,46],width:188,height:246},Ai={texture:Pi["button-skins"],data:[86,0,1,0],anchor:{x:0,y:.5},width:380,height:138},qi={texture:Pi.fog,data:[2,195,2,2],width:380,height:414},zi={texture:Pi["bg-plain"],data:[2,24,27,24],width:160,height:50},Gi={texture:Pi["bg-level-progress"],data:[13,11,13,11],width:270,height:24},ji={texture:Pi["fill-level-progress"],data:[7,5,7,5],width:250,height:11,anchor:{x:0,y:.5}},Wi={texture:Pi["bg-fuel-progress"],data:[13,11,13,11],width:40,height:180},Vi={texture:Pi["fill-fuel-progress"],data:[8,8,8,8],width:26,height:164,anchor:{x:.5,y:1}},Ri={texture:Pi["bg-popup"],data:[94,94,94,108],width:196,height:205},Hi={texture:Pi["bg-popup-skin-unlock"],data:[0,240,0,182],width:695,height:427},Ni={texture:Pi["bg-switcher"],data:[42,42,24,42],width:146,height:150},Ji={texture:Pi["rail-switcher"],data:[10,10,10,10],width:90,height:28},Yi={texture:Pi["bg-out-of-fuel"],data:[25,25,25,37],width:610,height:270},Qi={texture:Pi["button-fill-tank"],data:[82,0,60,0],width:340,height:131},Ki={texture:Pi["button-select-skin"],data:[52,57,52,57],anchor:{x:.5,y:.5},width:360,height:115},Xi={texture:Pi.gear},$i={texture:Pi["button-close"]},ts={texture:Pi["button-popup-close"]},es={texture:Pi.money,anchor:{x:0,y:.5}},is={texture:Pi.fuel,anchor:{x:.5,y:1}},ss={texture:Pi.warning},os={texture:Pi["icon-dispenser"],anchor:{x:0,y:.5},position:{x:0,y:-10}},ns={texture:Pi["icon-haptic"],position:{x:0,y:-28}},as={texture:Pi["icon-sound"],position:{x:0,y:-28}},rs={texture:Pi["handle-switcher"]},hs={texture:Pi["bg-discount"],position:{x:0,y:-110}},ls={texture:Pi.rays,scale:{x:4,y:4}},ds={AeroMaticsDisplayGreenBlueShadow:"AeroMaticsDisplayGreenBlueShadow",AeroMaticsDisplayBlueBlackShadow:"AeroMaticsDisplayBlueBlackShadow",AeroMaticsDisplayWitheGrayShadow:"AeroMaticsDisplayWitheGrayShadow",AeroMaticsDisplayWitheBlackStroke:"AeroMaticsDisplayWitheBlackStroke",AeroMaticsDisplay:"AeroMaticsDisplay"},cs={play:"play",back:"back",skins:"skins",fuel:"fuel",length:"length",size:"size",power:"power",shareScore:"shareScore",inviteFriends:"inviteFriends",shareScoreText:"shareScoreText",inviteFriendsText:"inviteFriendsText",basic:"basic",candy:"candy",plant:"plant",diamond:"diamond",minecraft:"minecraft",rock:"rock",scifi:"scifi",superhero:"superhero",unicorn:"unicorn",windmill:"windmill",locked:"locked",unlocked:"unlocked","level #":"level #","out of fuel":"out of fuel","fill tank":"fill tank","no thanks":"no thanks",continue:"continue","level completed":"level completed",max:"max","Complete N/M levels":"Complete N/M levels","Make N/M money":"Make N/M money","new skin unlocked":"new skin unlocked",select:"select",__charset__:"spielnzurckHtKafoLgGMhm FdbP%{S}!V,E?DWUv\nTNxAYBCIZORyXwjq-J.\"#$&'()*+/0123456789:;<=>@Q[\\]^_`|~"};i(7526),i(3354),i(5870),i(930),i(574),i(4116),i(3267),i(4614),i(9852),i(4306),i(6077),i(1072),i(183),i(7950),i(5940);const us=/%\{(.*?)\}/g;const ps=new class{constructor(){(0,st.Z)(this,"_translations",void 0)}async init(){this._translations=new Map;const t=Object.keys(cs).map((async t=>{const e=await Ct().getTranslation(t);this._translations.set(t,e)}));await Promise.all(t)}get(t,e){let i=this._translations.get(t)||t;return e&&(i=i.replace(us,(function(t){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];return"".concat(e[s[0]])}))),i}has(t){return this._translations.has(t)}};var _s=ps;const gs=t=>({text:_s.get(cs[t]),style:{fontName:ds.AeroMaticsDisplayWitheBlackStroke,fontSize:48},position:{x:0,y:42},buttonFit:{x:.78,y:1},anchor:{x:.5,y:1}}),ms=t=>({text:_s.get(cs[t]),style:{fontName:ds.AeroMaticsDisplayWitheBlackStroke,fontSize:33},position:{x:0,y:52},buttonFit:{x:.78,y:1},anchor:{x:.5,y:1}}),ys=t=>({text:t,style:{fontName:ds.AeroMaticsDisplayBlueBlackShadow,fontSize:33},position:{x:0,y:76},buttonFit:{x:.9,y:1}}),vs=t=>({text:"+".concat(t.toFixed(0),"$"),style:{fontName:ds.AeroMaticsDisplayWitheBlackStroke,fontSize:52,align:"center"}}),fs=()=>({input:{enable:!0},bg:Ui,label:{text:_s.get(cs.inviteFriends),style:{fontName:ds.AeroMaticsDisplayWitheBlackStroke,fontSize:52,letterSpacing:1},position:{x:28,y:-12},buttonFit:{x:.74,y:1}},textures:{up:{bg:{texture:Pi["button-invite"]},label:{tint:16777215,offset:{x:0,y:0}}},down:{bg:{texture:Pi["button-invite-pressed"]},label:{tint:16777215,offset:{x:0,y:0}}}}}),ws=()=>({input:{enable:!0},bg:Ti,label:{text:_s.get(cs.shareScore),style:{fontName:ds.AeroMaticsDisplayWitheBlackStroke,fontSize:52,letterSpacing:1},position:{x:28,y:-12},buttonFit:{x:.74,y:1}},textures:{up:{bg:{texture:Pi["button-share"]},label:{tint:16777215,offset:{x:0,y:0}}},down:{bg:{texture:Pi["button-share-pressed"]},label:{tint:16777215,offset:{x:0,y:0}}}}}),bs=()=>({input:{enable:!0},label:{text:_s.get(cs.continue),style:{fontName:ds.AeroMaticsDisplay,fontSize:48,letterSpacing:1},position:{x:0,y:0},buttonFit:{x:1,y:1}},labels:{up:{tint:4682649}}});var ks=i(5816);class xs extends Zi.TCu{constructor(){super(...arguments),(0,st.Z)(this,"userData",void 0)}shape(t){return this.drawShape(this.hitArea=t),this}input(t){return this.interactive=t,this}setUserDate(t){return this.userData=t,this}}function Cs(t){const{texture:e,position:i={x:0,y:0},scale:s={x:1,y:1},anchor:o={x:.5,y:.5},tint:n=16777215}=t,a=Zi.jyi.from(e);return a.scale.copyFrom(s),a.anchor.copyFrom(o),a.position.copyFrom(i),a.tint=n,a}function Bs(t){const{text:e,style:i,position:s={x:0,y:0},scale:o={x:1,y:1},anchor:n={x:.5,y:.5}}=t,a=new Zi.Xz2(e,i);return a.position.copyFrom(s),a.scale.copyFrom(o),a.anchor.copyFrom(n),a}const Ms=t=>{const{texture:e,data:i,width:s,height:o,tint:n=16777215,scale:a={x:1,y:1},position:r={x:0,y:0},anchor:{x:h,y:l}={x:.5,y:.5}}=t,d=new Zi.ZTM(Zi.xEZ.from(e),...i);return d.width=s,d.height=o,d.position.copyFrom(r),d.scale.copyFrom(a),d.pivot.set(h*s,l*o),d.tint=n,d};function Ss(t,e,i){t.defaultFontSize||(t.defaultFontSize=t.fontSize),t.fontSize=t.defaultFontSize;const s=e?e/t.width:1,o=i?i/t.height:1,n=Math.min(Math.min(s,o),1);t.fontSize*=n}const Zs=()=>{const{width:t,height:e}=Ct().viewBounds,i=Math.min(t,e)/Math.max(t,e);return i<.47?V.tall:i>.63?V.fat:V.normal};function Ps(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function Us(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Ps(Object(i),!0).forEach((function(e){(0,st.Z)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ps(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}const Ts=t=>({name:"popup",cells:[Us({name:"content"},t),{name:"blocker",bounds:{x:0,y:0,width:1,height:1},scale:ks.P1.fill}]}),Fs=t=>({name:"popup",cells:[Us({name:"content"},t),{name:"blocker",bounds:{x:0,y:0,width:1,height:1},scale:ks.P1.fill}]});var Ds=i(1050);class Is extends xs{constructor(t){super(),(0,st.Z)(this,"strategy",void 0),this.setStrategy(t).initInput(t.config.input)}enable(t){return this.strategy.up(),this.input(t),!t&&this.strategy.disable(),this}initInput(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{area:e,name:i,enable:s}=Object.assign({enable:!0},t);return this.setUserDate(i).shape(e||this.getLocalBounds()).enable(s).on("pointerover",this.over,this).on("pointerout",this.out,this).on("pointerdown",this.down,this).on("pointertap",this.up,this).on("pointerupoutside",this.upOut,this),this}setStrategy(t){return this.strategy=t,this.strategy.init(this),this}down(t){this.strategy.down()}up(t){this.strategy.up(),this.emit("interaction",this.userData)}over(t){this.strategy.over()}out(t){this.strategy.up()}upOut(t){this.strategy.up()}}class Es{constructor(t){(0,st.Z)(this,"view",void 0),(0,st.Z)(this,"_bgType",void 0),(0,st.Z)(this,"_labelType",void 0),(0,st.Z)(this,"_bg",void 0),(0,st.Z)(this,"_label",void 0),(0,st.Z)(this,"_textures",void 0),this._config=t}get config(){return this._config}init(t){const{bg:e,label:i,textures:s}=this._config;this._bgType=e.width&&e.height?"nineslice":"sprite",this._labelType=i.style.hasOwnProperty("fontName")?"bitmapText":"text",this._bg=this._createBg(e),this._label=this._createLabel(i),this._textures=this._createTextures(s);const o=new Zi.W20;o.addChild(this._bg),o.addChild(this._label),this._fitLabel(),t.addChild(this.view=o)}up(){var t,e;const{label:i}=this._config.textures.up;this._bg.texture=this._textures.up,this._label.tint=i.tint,this._label.position.x=((null===(t=this._config.label)||void 0===t?void 0:t.position.x)||0)+i.offset.x,this._label.position.y=((null===(e=this._config.label)||void 0===e?void 0:e.position.y)||0)+i.offset.y}down(){var t,e;if(!this._config.textures.down)return;const{label:i}=this._config.textures.down;this._bg.texture=this._textures.down,this._label.tint=i.tint,this._label.position.x=((null===(t=this._config.label)||void 0===t?void 0:t.position.x)||0)+i.offset.x,this._label.position.y=((null===(e=this._config.label)||void 0===e?void 0:e.position.y)||0)+i.offset.y}over(){var t,e;if(!this._config.textures.over)return;const{label:i}=this._config.textures.over;this._bg.texture=this._textures.over,this._label.tint=i.tint,this._label.position.x=((null===(t=this._config.label)||void 0===t?void 0:t.position.x)||0)+i.offset.x,this._label.position.y=((null===(e=this._config.label)||void 0===e?void 0:e.position.y)||0)+i.offset.y}disable(){var t,e;if(!this._config.textures.disable)return;const{label:i}=this._config.textures.disable;this._bg.texture=this._textures.disable,this._label.tint=i.tint,this._label.position.x=((null===(t=this._config.label)||void 0===t?void 0:t.position.x)||0)+i.offset.x,this._label.position.y=((null===(e=this._config.label)||void 0===e?void 0:e.position.y)||0)+i.offset.y}_fitLabel(){const{x:t,y:e}=this._config.label.buttonFit,i=t*this._bg.width,s=e*this._bg.height;"bitmapText"===this._labelType?Ss(this._label,i,s):function(t,e,i){t.defaultFontSize||(t.defaultFontSize=t.style.fontSize),t.style.fontSize=t.defaultFontSize;const{width:s,height:o,scale:n}=t,a=e?e/(s/n.x):1,r=i?i/(o/n.y):1,h=Math.min(Math.min(a,r),1);t.style.fontSize*=h}(this._label,i,s)}_createBg(t){return"nineslice"===this._bgType?Ms(t):Cs(t)}_createLabel(t){return"bitmapText"===this._labelType?Bs(t):function(t){const{text:e,style:i,position:s={x:0,y:0},scale:o={x:1,y:1},anchor:n={x:.5,y:.5}}=t,a=new Zi.xvT(e,i);return a.position.copyFrom(s),a.scale.copyFrom(o),a.anchor.copyFrom(n),a}(t)}_createTextures(t){const e={};return Object.keys(t).forEach((i=>e[i]=Zi.xEZ.from(t[i].bg.texture))),e}}class Ls{constructor(t){(0,st.Z)(this,"view",void 0),this._config=t}get config(){return this._config}init(t){const{texture:e}=this._config;t.addChild(this.view=Cs(e))}up(){const{textures:t}=this._config,{up:e}=t;e&&(this.view.texture=Zi.xEZ.from(e.texture))}down(){const{textures:t}=this._config,{down:e}=t;e&&(this.view.texture=Zi.xEZ.from(e.texture))}over(){const{textures:t}=this._config,{over:e}=t;e&&(this.view.texture=Zi.xEZ.from(e.texture))}disable(){const{textures:t}=this._config,{disable:e}=t;e&&(this.view.texture=Zi.xEZ.from(e.texture))}}class Os{constructor(t){(0,st.Z)(this,"label",void 0),this._config=t}get config(){return this._config}init(t){const{label:e}=this._config;t.addChild(this.label=Bs(e))}up(){const{labels:t}=this._config,{up:e}=t;e&&(this.label.tint=e.tint)}down(){const{labels:t}=this._config,{down:e}=t;e&&(this.label.tint=e.tint)}over(){const{labels:t}=this._config,{over:e}=t;e&&(this.label.tint=e.tint)}disable(){const{labels:t}=this._config,{disable:e}=t;e&&(this.label.tint=e.tint)}}class As extends Ds.Container{constructor(t,e){super(),(0,st.Z)(this,"bg",void 0),(0,st.Z)(this,"closeBtn",void 0),this.viewConfig=t,this.modelConfig=e,this._setStateUpdateListener()}destroy(t){s.q.event.removeListenersOf(this),super.destroy(t)}getBounds(){return this.bg?this.bg.getBounds():super.getBounds()}centralize(t,e){const{x:i,y:s,width:o,height:n}=t.getLocalBounds();t.position.set((this.bg.width-o*t.scale.x)/2+e.x-i,(this.bg.height-n*t.scale.y)/2+e.y-s)}idle(){this.closeBtn&&this.closeBtn.once("interaction",this.onCloseBtnClick,this)}init(){const{bg:t,closeBtn:e}=this.viewConfig;this._buildBg(t),this._buildCloseBtn(e),this.pivot.set(.5*this.width,.5*this.height)}async show(){}async hide(){}rebuild(t){}resizeBg(t){let{width:e,height:i}=t;this.bg.width=e,this.bg.height=i,this.bg.pivot.set(.5*e,.5*i),this.viewConfig.closeBtn}positionCloseButton(){const{width:t,height:e}=this.bg,{offset:i,align:s}=this.viewConfig.closeBtn.config[Ct().orientation]||{};this.closeBtn.x=t*(s.x-.5)+i.x,this.closeBtn.y=e*(s.y-.5)+i.y}onStateUpdate(t,e,i){this.emit(As.stateUpdateEvent,t,this.viewConfig)}onCloseBtnClick(){this.emit(As.closeBtnClickEvent)}_setStateUpdateListener(){s.q.event.on(this.stateUpdateEvent,this.onStateUpdate,this)}_buildBg(t){if(!t)return;const{data:e,dimension:i}=t;let s=null;s=i?Ms(e):Cs(e),s.interactive=!0,this.addChild(this.bg=s),this.resizeBg(t.dimension[Ct().orientation])}_buildCloseBtn(t){if(!t)return;const{data:e}=t,i=new Is(new Ls(e));this.closeBtn=i,this.addChild(i),this.positionCloseButton()}}(0,st.Z)(As,"stateUpdateEvent","state_update"),(0,st.Z)(As,"closeBtnClickEvent","close_btn_click");class qs extends Zi.W20{constructor(){super();const t=Ms(Yi);this.addChild(t);const e=Bs({text:_s.get(cs["level completed"]),style:{fontName:ds.AeroMaticsDisplay,fontSize:74,align:"center",tint:8224125,letterSpacing:2},position:{x:0,y:-10}});Ss(e,.9*t.width,.9*t.height),this.addChild(e)}}class zs extends Zi.W20{constructor(){super();const t=Ms(Yi);this.addChild(t);const e=Cs(os);e.x=-t.width/2+84,e.y+=t.y,this.addChild(e);const i=Bs({text:_s.get(cs["out of fuel"]),style:{fontName:ds.AeroMaticsDisplay,fontSize:52,align:"center",tint:8224125,letterSpacing:2},position:{x:0,y:-10}});i.x=t.width/2-180,i.y+=t.y,Ss(i,.48*t.width,.8*t.height),this.addChild(i)}}const Gs={visuals:{bg:{config:Ji},pointer:{config:rs,padding:20}},states:{enable:{bg:{idle:9097819,over:9097819},pointer:{idle:16777215,over:16777215}},disable:{bg:{idle:16733568,over:16733568},pointer:{idle:16777215,over:16777215}}},input:{enabled:!0,area:new Zi.AeJ(-73,-110,146,150)}},js={icon:as,switcher:Gs},Ws={icon:ns,switcher:Gs};var Vs=i(6055);class Rs extends Ds.Container{constructor(t){super(),(0,st.Z)(this,"_enabled",void 0),(0,st.Z)(this,"_pointer",void 0),(0,st.Z)(this,"_bg",void 0),this.config=t;const{visuals:e,input:i}=this.config;this._buildVisuals(e),this._createHitArea(i),this.switchEnable(!0),this.switchInput(!(null==i||!i.enabled))}switchEnable(t){this._enabled=t,t?this.enable():this.disable()}switchInput(t){this.interactive=t,this.buttonMode=t}enable(){const{visuals:t,states:e}=this.config,{padding:i}=t.pointer,{bg:s,pointer:o}=e.enable;this._bg.tint=s.idle,this._pointer.tint=o.idle,this._pointer.x=.5*this._bg.width-i}disable(){const{visuals:t,states:e}=this.config,{padding:i}=t.pointer,{bg:s,pointer:o}=e.disable;this._bg.tint=s.idle,this._pointer.tint=o.idle,this._pointer.x=.5*-this._bg.width+i}onDown(t){this.emit("interaction")}onOver(t){const{bg:e,pointer:i}=this._enabled?this.config.states.enable:this.config.states.disable;this._bg.tint=e.over,this._pointer.tint=i.over}onOut(t){const{bg:e,pointer:i}=this._enabled?this.config.states.enable:this.config.states.disable;this._bg.tint=e.idle,this._pointer.tint=i.idle}_buildVisuals(t){const{bg:e,pointer:i}=t,s=Ms(e.config);this.addChild(this._bg=s);const o=Cs(i.config);this.addChild(this._pointer=o)}_createHitArea(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{area:e}=t,{left:i,top:s,width:o,height:n}=this.getBounds();this.hitArea=e||new Vs.Ae(i,s,o,n),this.on("pointerdown",this.onDown,this),this.on("pointerover",this.onOver,this),this.on("pointerout",this.onOut,this)}}class Hs extends Rs{constructor(t){super(t)}}class Ns extends Ds.Container{constructor(t){let{switcher:e,icon:i}=t;super(),(0,st.Z)(this,"_bg",void 0),(0,st.Z)(this,"_icon",void 0),(0,st.Z)(this,"_switcher",void 0),this.addChild(this._bg=Ms(Ni)),this.addChild(this._icon=Cs(i)),this._switcher=new Hs(e),this.addChild(this._switcher),this._switcher.y=this._bg.height/2-40,this._switcher.on("interaction",this._onInteraction,this)}switchEnable(t){this._switcher.switchEnable(t)}switchInput(t){this._switcher.switchInput(t)}_onInteraction(){this.emit("interaction")}}const Js=async t=>new Promise((e=>{t.renderable=!1,t.alpha=.6,xi.ZP.timeline({onStart:()=>{t.show(),t.renderable=!0},onComplete:()=>{e()}}).add(xi.ZP.to(t,{alpha:1,duration:.1}),0)})),Ys=async t=>new Promise((e=>{xi.ZP.timeline({onComplete:()=>{e()},onStart:()=>{t.hide()}}).add(xi.ZP.to(t,{alpha:0,duration:.1,ease:Ci.Yv.easeInOut}),0)})),Qs=async t=>new Promise((e=>{t.renderable=!1,t.alpha=.6;const{moneyLabel:i,banner:s,buttonFillTank:o}=t;i.renderable=!1,i.scale.set(.5),i.alpha=0,s.renderable=!1,s.x-=s.width,s.alpha=0,o.renderable=!1,o.x-=o.width,o.alpha=0,xi.ZP.timeline({onStart:()=>{t.show(),t.renderable=!0},onComplete:()=>{e()}}).add(xi.ZP.to(t,{alpha:1,duration:.15})).add([xi.ZP.to(i,{pixi:{scale:1},duration:.3,onStart:()=>{i.renderable=!0},ease:Ci.eJ.easeOut}),xi.ZP.to(i,{pixi:{alpha:1},duration:.25})]).add([xi.ZP.to(s,{pixi:{x:0},duration:.3,onStart:()=>{s.renderable=!0},ease:Ci.eJ.easeOut}),xi.ZP.to(s,{pixi:{alpha:1},duration:.25})],.2).add([xi.ZP.to(o,{pixi:{x:0},duration:.3,onStart:()=>{o.renderable=!0},ease:Ci.eJ.easeOut}),xi.ZP.to(o,{pixi:{alpha:1},duration:.25})],.3)})),Ks=async t=>new Promise((e=>{xi.ZP.timeline({onComplete:()=>{e()},onStart:()=>{t.hide()}}).add(xi.ZP.to(t,{alpha:0,duration:.1,ease:Ci.Yv.easeInOut}),0)})),Xs=async t=>new Promise((e=>{t.renderable=!1,t.alpha=.6;const{moneyLabel:i,banner:s,buttonInvite:o,buttonShare:n}=t;i.renderable=!1,i.scale.set(.5),i.alpha=0,s.renderable=!1,s.scale.set(.2),s.alpha=0;const a=xi.ZP.timeline({onStart:()=>{t.show(),t.renderable=!0},onComplete:()=>{e()}}).add(xi.ZP.to(t,{alpha:1,duration:.15})).add([xi.ZP.to(i,{pixi:{scale:1},duration:.3,onStart:()=>{i.renderable=!0},ease:Ci.eJ.easeOut}),xi.ZP.to(i,{pixi:{alpha:1},duration:.25})]).add([xi.ZP.to(s,{pixi:{scale:1},duration:.3,onStart:()=>{s.renderable=!0},ease:Ci.eJ.easeOut}),xi.ZP.to(s,{pixi:{alpha:1},duration:.25})],.2);o&&(o.renderable=!1,o.scale.set(.2),o.alpha=0,a.add([xi.ZP.to(o,{pixi:{scale:1},duration:.3,onStart:()=>{o.renderable=!0},ease:Ci.eJ.easeOut}),xi.ZP.to(o,{pixi:{alpha:1},duration:.25})],.3)),n&&(n.renderable=!1,n.scale.set(.2),n.alpha=0,a.add([xi.ZP.to(n,{pixi:{scale:1},duration:.3,onStart:()=>{n.renderable=!0},ease:Ci.eJ.easeOut}),xi.ZP.to(n,{pixi:{alpha:1},duration:.25})],.4))})),$s=async t=>new Promise((e=>{xi.ZP.timeline({onComplete:()=>{e()},onStart:()=>{t.hide()}}).add(xi.ZP.to(t,{alpha:0,duration:.1,ease:Ci.Yv.easeInOut}),0)})),to=async t=>new Promise((e=>{t.renderable=!1,t.alpha=.6;const{buttonInvite:i,buttonShare:s,moneyLabel:o}=t;o.renderable=!1,o.scale.set(.5),o.alpha=0;const n=xi.ZP.timeline({onStart:()=>{t.show(),t.renderable=!0},onComplete:()=>{e()}}).add(xi.ZP.to(t,{alpha:1,duration:.15})).add([xi.ZP.to(o,{pixi:{scale:1},duration:.3,onStart:()=>{o.renderable=!0},ease:Ci.eJ.easeOut}),xi.ZP.to(o,{pixi:{alpha:1},duration:.25})]);i.renderable=!1,i.scale.set(.2),i.alpha=0,n.add([xi.ZP.to(i,{pixi:{scale:1},duration:.3,onStart:()=>{i.renderable=!0},ease:Ci.eJ.easeOut}),xi.ZP.to(i,{pixi:{alpha:1},duration:.25})],.3),s.renderable=!1,s.scale.set(.2),s.alpha=0,n.add([xi.ZP.to(s,{pixi:{scale:1},duration:.3,onStart:()=>{s.renderable=!0},ease:Ci.eJ.easeOut}),xi.ZP.to(s,{pixi:{alpha:1},duration:.25})],.4)})),eo=async t=>new Promise((e=>{xi.ZP.timeline({onComplete:()=>{e()},onStart:()=>{t.hide()}}).add(xi.ZP.to(t,{alpha:0,duration:.1,ease:Ci.Yv.easeInOut}),0)})),io=async t=>new Promise((e=>{t.renderable=!1,t.alpha=.6;const{moneyLabel:i}=t;i.renderable=!1,i.scale.set(.5),i.alpha=0,xi.ZP.timeline({onStart:()=>{t.show(),t.renderable=!0},onComplete:()=>{e()}}).add(xi.ZP.to(t,{alpha:1,duration:.15})).add([xi.ZP.to(i,{pixi:{scale:1},duration:.3,onStart:()=>{i.renderable=!0},ease:Ci.eJ.easeOut}),xi.ZP.to(i,{pixi:{alpha:1},duration:.25})])})),so=async t=>new Promise((e=>{const{moneyLabel:i}=t;xi.ZP.timeline({onComplete:()=>{e()},onStart:()=>{t.hide()}}).add([xi.ZP.to(i,{pixi:{scale:0},duration:.15,ease:Ci.eJ.easeIn}),xi.ZP.to(i,{pixi:{alpha:1},duration:.1})],0).add(xi.ZP.to(t,{alpha:0,duration:.3,ease:Ci.Yv.easeInOut}),0)})),oo=async t=>new Promise((e=>{t.renderable=!1,t.alpha=.6;const{icon:i,button:s,ray1:o,ray2:n}=t;i.renderable=!1;const a=i.scale.x;i.scale.set(0),i.alpha=0,s.renderable=!1,s.scale.set(0),s.alpha=0,o.renderable=!1;const r=o.scale.x;o.scale.set(0),o.alpha=0,n.renderable=!1,n.scale.set(0),n.alpha=0,xi.ZP.timeline({onStart:()=>{t.show(),t.renderable=!0},onComplete:()=>{e()}}).add(xi.ZP.to(t,{alpha:1,duration:.2})).add([xi.ZP.to(i,{pixi:{scale:a},duration:.3,onStart:()=>{i.renderable=!0},ease:Ci.eJ.easeOut}),xi.ZP.to(i,{pixi:{alpha:1},duration:.25})],.05).add([xi.ZP.to([o,n],{pixi:{scale:r},duration:.3,onStart:()=>{o.renderable=!0,n.renderable=!0},ease:Ci.eJ.easeOut}),xi.ZP.to([o,n],{pixi:{alpha:1},duration:.25})],.1).add([xi.ZP.to(s,{pixi:{scale:1},duration:.3,onStart:()=>{s.renderable=!0},ease:Ci.eJ.easeOut}),xi.ZP.to(s,{pixi:{alpha:1},duration:.25})])})),no=async t=>new Promise((e=>{xi.ZP.timeline({onComplete:()=>{e()},onStart:()=>{t.hide()}}).add(xi.ZP.to(t,{alpha:0,duration:.2,ease:Ci.Yv.easeInOut}),0)})),ao=Object.freeze({[tt.settings]:{model:class extends Mi{constructor(t,e){super("PopupSettingsModel",t,e)}},view:class extends As{constructor(t){super(t),(0,st.Z)(this,"_soundOption",void 0),(0,st.Z)(this,"_hapticOption",void 0),s.q.event.on(S.muteUpdate,this._onMuteUpdate,this),s.q.event.on(S.hapticUpdate,this._onHapticUpdate,this)}get stateUpdateEvent(){return _.stateUpdate}getCellConfig(t){return{bounds:{x:0,y:0,width:1,height:1},padding:.005}}idle(){super.idle(),this._switchButtonsInput(!0)}async init(){super.init();const{user:t}=Yt,{haptic:e,mute:i}=t,s=new Ns(js);s.x=.22*-this.bg.width;const o=new Ns(Ws);o.x=.22*this.bg.width,s.on("interaction",this._onSoundClick,this),o.on("interaction",this._onHapticClick,this),this.addChild(this._soundOption=s),this.addChild(this._hapticOption=o),this._switchButtonsInput(!1),this._onMuteUpdate(!!i),this._onHapticUpdate(!!e)}_onSoundClick(){s.q.event.emit(E.soundClick)}_onHapticClick(){s.q.event.emit(E.hapticClick)}_onMuteUpdate(t){this._soundOption.switchEnable(!t)}_onHapticUpdate(t){this._hapticOption.switchEnable(t)}_switchButtonsInput(t){this._soundOption.switchInput(t),this._hapticOption.switchInput(t)}},configFn:()=>({custom:{},content:{showBehavior:Js,hideBehavior:Ys},blocker:{init:{alpha:.6,interactive:!0,tint:0,backdrop:!0},show:{duration:.1},hide:{duration:.1}},bg:{data:Ri,dimension:{[j.landscape]:{width:510,height:220},[j.portrait]:{width:510,height:220}}},closeBtn:{data:{input:{enable:!0},texture:ts,textures:{up:{texture:Pi["button-popup-close"]},down:{texture:Pi["button-popup-close-pressed"]}}},config:{[j.landscape]:{align:{x:1,y:0},offset:{x:-30,y:30}},[j.portrait]:{align:{x:1,y:0},offset:{x:-30,y:30}}}}})},[tt.outOfFuel]:{model:class extends Mi{constructor(t,e){super("PopupOutOfFuelModel",t,e)}},view:class extends As{constructor(t,e){super(t,e),(0,st.Z)(this,"_moneyLabel",void 0),(0,st.Z)(this,"_banner",void 0),(0,st.Z)(this,"_buttonFillTank",void 0),(0,st.Z)(this,"_buttonNoThanks",void 0)}destroy(t){super.destroy(t),xi.ZP.killTweensOf(this._buttonNoThanks)}get stateUpdateEvent(){return u.stateUpdate}get moneyLabel(){return this._moneyLabel}get banner(){return this._banner}get buttonFillTank(){return this._buttonFillTank}get buttonNoThanks(){return this._buttonNoThanks}getCellConfig(t){return(t=>{let e=.08;switch(Zs()){case V.fat:e=.15;break;case V.tall:e=.08;break;default:e=.095}return{bounds:{x:0,y:0,width:1,height:1},padding:e}})()}idle(){super.idle(),xi.ZP.timeline({delay:1}).add([xi.ZP.to(this._buttonNoThanks,{pixi:{scale:1},duration:.3,onStart:()=>{this._buttonNoThanks.renderable=!0},ease:Ci.eJ.easeOut}),xi.ZP.to(this._buttonNoThanks,{pixi:{alpha:1},duration:.25})]),xi.ZP.to(this._buttonFillTank,{pixi:{scale:.96},duration:.6,ease:Ci.Yv.easeInOut,yoyo:!0,repeat:-1})}async init(){super.init();const t=Bs((e=this.modelConfig.money,{text:"+".concat(e.toFixed(0),"$"),style:{fontName:ds.AeroMaticsDisplayWitheGrayShadow,fontSize:52,align:"center"}}));var e;this.addChild(this._moneyLabel=t);const i=new zs;i.y+=220,this.addChild(this._banner=i);const s=new Is(new Es({input:{enable:!0},bg:Qi,label:{text:_s.get(cs["fill tank"]),style:{fontName:ds.AeroMaticsDisplayWitheBlackStroke,fontSize:52,letterSpacing:1},position:{x:28,y:-12},buttonFit:{x:.64,y:1}},textures:{up:{bg:{texture:Pi["button-fill-tank"]},label:{tint:16777215,offset:{x:0,y:0}}},down:{bg:{texture:Pi["button-fill-tank-pressed"]},label:{tint:16777215,offset:{x:0,y:0}}}}}));s.y+=i.y+470,s.once("interaction",this._onFillTankButtonClick,this),this.addChild(this._buttonFillTank=s);const o=new Is(new Os({input:{enable:!0},label:{text:_s.get(cs["no thanks"]),style:{fontName:ds.AeroMaticsDisplay,fontSize:38,letterSpacing:1},position:{x:0,y:0},buttonFit:{x:1,y:1}},labels:{up:{tint:4690073}}}));o.y+=s.y+140,o.once("interaction",this._onNoThanksButtonClick,this),this.addChild(this._buttonNoThanks=o),this._buttonNoThanks.renderable=!1,this._buttonNoThanks.scale.set(0),this._buttonNoThanks.alpha=0}_onFillTankButtonClick(){s.q.event.emit(A.fillThankClick)}_onNoThanksButtonClick(){s.q.event.emit(A.noThanksClick)}},configFn:()=>({custom:{},content:{showBehavior:Qs,hideBehavior:Ks},blocker:{init:{alpha:1,interactive:!0,tint:5172991,backdrop:!1},show:{duration:.15},hide:{duration:.15}}})},[tt.levelCompleted]:{model:class extends Mi{constructor(t,e){super("PopupLevelCompletedModel",t,e)}},view:class extends As{constructor(t,e){super(t,e),(0,st.Z)(this,"_moneyLabel",void 0),(0,st.Z)(this,"_banner",void 0),(0,st.Z)(this,"_buttonInvite",void 0),(0,st.Z)(this,"_buttonShare",void 0),(0,st.Z)(this,"_buttonContinue",void 0)}get stateUpdateEvent(){return c.stateUpdate}get moneyLabel(){return this._moneyLabel}get banner(){return this._banner}get buttonInvite(){return this._buttonInvite}get buttonShare(){return this._buttonShare}get buttonContinue(){return this._buttonContinue}getCellConfig(t){return(t=>{let e=.08;switch(Zs()){case V.fat:e=.15;break;case V.tall:e=.08;break;default:e=.095}return{bounds:{x:0,y:0,width:1,height:1},padding:e}})()}idle(){super.idle(),this._buttonContinue.scale.set(0),xi.ZP.timeline({delay:1}).add([xi.ZP.to(this._buttonContinue,{pixi:{scale:1},duration:.3,onStart:()=>{this._buttonContinue.renderable=!0},ease:Ci.eJ.easeOut}),xi.ZP.to(this._buttonContinue,{pixi:{alpha:1},duration:.25})])}async init(){super.init();const t=Ct().isFacebookPlatform(),e=Bs(vs(this.modelConfig.money));this.addChild(this._moneyLabel=e);const i=new qs;i.y+=220,this.addChild(this._banner=i);const s=new Is(new Os(bs()));if(s.once("interaction",this._onContinueButtonClick,this),s.alpha=0,this.addChild(this._buttonContinue=s),t){const t=new Is(new Es(fs()));t.y+=i.y+270,t.on("interaction",this._onInviteFriendsBtnClick,this),this.addChild(this._buttonInvite=t);const e=new Is(new Es(ws()));e.y+=t.y+t.height+20,e.on("interaction",this._onShareWithFriendsBtnClick,this),this.addChild(this._buttonShare=e),s.y+=e.y+140}else s.y+=i.y+560}_onShareWithFriendsBtnClick(){s.q.event.emit(L.shareWithFriendsClick)}_onInviteFriendsBtnClick(){s.q.event.emit(L.inviteFriendsClick)}_onContinueButtonClick(){s.q.event.emit(L.continueClick)}},configFn:()=>({custom:{},content:{showBehavior:Xs,hideBehavior:$s},blocker:{init:{alpha:.4,interactive:!0,tint:5172991,backdrop:!1},show:{duration:.15},hide:{duration:.15}}})},[tt.failedOffBoarding]:{model:class extends Mi{constructor(t,e){super("PopupFailedOffBoardingModel",t,e)}},view:class extends As{constructor(t,e){super(t,e),(0,st.Z)(this,"_moneyLabel",void 0),(0,st.Z)(this,"_buttonInvite",void 0),(0,st.Z)(this,"_buttonShare",void 0),(0,st.Z)(this,"_buttonContinue",void 0)}get stateUpdateEvent(){return d.stateUpdate}get moneyLabel(){return this._moneyLabel}get buttonInvite(){return this._buttonInvite}get buttonShare(){return this._buttonShare}get buttonContinue(){return this._buttonContinue}getCellConfig(t){return(t=>{let e=.08;switch(Zs()){case V.fat:e=.15;break;case V.tall:e=.08;break;default:e=.095}return{bounds:{x:0,y:0,width:1,height:1},padding:e}})()}idle(){super.idle(),this._buttonContinue.scale.set(0),xi.ZP.timeline({delay:1}).add([xi.ZP.to(this._buttonContinue,{pixi:{scale:1},duration:.3,onStart:()=>{this._buttonContinue.renderable=!0},ease:Ci.eJ.easeOut}),xi.ZP.to(this._buttonContinue,{pixi:{alpha:1},duration:.25})])}async init(){super.init();const t=Bs(vs(this.modelConfig.money));this.addChild(this._moneyLabel=t);const e=new Is(new Os(bs()));e.once("interaction",this._onContinueButtonClick,this),e.alpha=0,this.addChild(this._buttonContinue=e);const i=new Is(new Es(fs()));i.y+=290,i.on("interaction",this._onInviteFriendsBtnClick,this),this.addChild(this._buttonInvite=i);const s=new Is(new Es(ws()));s.y+=i.y+i.height+20,s.on("interaction",this._onShareWithFriendsBtnClick,this),this.addChild(this._buttonShare=s),e.y+=s.y+140}_onShareWithFriendsBtnClick(){s.q.event.emit(O.shareWithFriendsClick)}_onInviteFriendsBtnClick(){s.q.event.emit(O.inviteFriendsClick)}_onContinueButtonClick(){s.q.event.emit(O.continueClick)}},configFn:()=>({custom:{},content:{showBehavior:to,hideBehavior:eo},blocker:{init:{alpha:.4,interactive:!0,tint:5172991,backdrop:!1},show:{duration:.15},hide:{duration:.15}}})},[tt.abort]:{model:Si,view:class extends As{constructor(t,e){super(t,e),(0,st.Z)(this,"_moneyLabel",void 0),s.q.event.on(l.lifetimeExceededUpdate,this._onLifetimeExceeded,this)}get stateUpdateEvent(){return l.stateUpdate}get moneyLabel(){return this._moneyLabel}getCellConfig(t){return{bounds:{x:0,y:.25,width:1,height:.08},padding:.005}}async init(){super.init();const t=Bs((e=this.modelConfig.money,{text:"+".concat(e.toFixed(0),"$"),style:{fontName:ds.AeroMaticsDisplayWitheBlackStroke,fontSize:52,align:"center"}}));var e;this.addChild(this._moneyLabel=t)}_onLifetimeExceeded(){this.onCloseBtnClick()}},configFn:()=>({custom:{},content:{showBehavior:io,hideBehavior:so},blocker:{init:{alpha:1,interactive:!0,tint:5172991,backdrop:!1},show:{duration:0},hide:{duration:.15}}})},[tt.skinUnlock]:{model:class extends Mi{constructor(t,e){super("PopupSkinUnlockModel",t,e)}},view:class extends As{constructor(t,e){super(t,e),(0,st.Z)(this,"_icon",void 0),(0,st.Z)(this,"_ray1",void 0),(0,st.Z)(this,"_ray2",void 0),(0,st.Z)(this,"_button",void 0)}get stateUpdateEvent(){return g.stateUpdate}get icon(){return this._icon}get ray1(){return this._ray1}get ray2(){return this._ray2}get button(){return this._button}destroy(t){super.destroy(t),xi.ZP.killTweensOf(this._ray1),xi.ZP.killTweensOf(this._ray2)}getCellConfig(t){return{bounds:{x:0,y:0,width:1,height:.95},padding:.005}}idle(){super.idle(),this._switchButtonsInput(!0)}async init(){super.init();const t=Bs({text:_s.get(cs["new skin unlocked"]),style:{fontName:ds.AeroMaticsDisplayWitheBlackStroke,fontSize:62,align:"center",letterSpacing:1}});t.y=-326,this.addChild(t),Ss(t,.8*this.bg.width,this.bg.height);const e=Cs(ls);this._animateRay(e,1),this.addChild(this._ray1=e);const i=Cs(ls);this._animateRay(i,-1),this.addChild(this._ray2=i);const s=Cs((o=this.modelConfig.skin,{texture:Pi["icon-skin-".concat(o,"-large")],anchor:{x:.5,y:1}}));var o;s.y=210,this.addChild(this._icon=s);const n=new Is(new Es({input:{enable:!1},bg:Ki,label:{text:_s.get(cs.select),style:{fontName:ds.AeroMaticsDisplayWitheBlackStroke,fontSize:58,letterSpacing:1},position:{x:0,y:-12},buttonFit:{x:.85,y:1}},textures:{up:{bg:{texture:Pi["button-select-skin"]},label:{tint:16777215,offset:{x:0,y:0}}},down:{bg:{texture:Pi["button-select-skin-pressed"]},label:{tint:16777215,offset:{x:0,y:0}}}}}));n.y=300,n.once("interaction",this._onSelectClick,this),this.addChild(this._button=n)}_animateRay(t,e){xi.ZP.to(t,{pixi:{rotation:360*e},duration:12,repeat:-1,ease:Ci.bJ.easeNone})}_onSelectClick(){s.q.event.emit(q.selectClick,this.modelConfig.skin)}_switchButtonsInput(t){this._button.enable(t)}},configFn:()=>({custom:{},content:{showBehavior:oo,hideBehavior:no},blocker:{init:{alpha:.6,interactive:!0,tint:0,backdrop:!1},show:{duration:.2},hide:{duration:.2}},bg:{data:Hi,dimension:{[j.landscape]:{width:696,height:780},[j.portrait]:{width:696,height:780}}}})}});class ro extends bi.EventEmitter{constructor(){super(),(0,st.Z)(this,"name","popup"),(0,st.Z)(this,"onInstall",(()=>{s.q.event.on(p.queueUpdate,this._onQueueUpdate,this).on(U.settingsButtonClick,this._onSettingsClick,this).on(U.queuePopup,this._onQueuePopup,this).on(I.showComplete,this._onShowComplete,this).on(I.hideComplete,this._onHideComplete,this).on(I.hideStart,this._onHideStart,this).on(I.blockerClick,this._onBlockerClick,this).on(I.closeBtnClick,this._onCloseBtnClick,this).on(A.fillThankClick,this._hideActivePopup,this).on(A.noThanksClick,this._hideActivePopup,this).on(L.continueClick,this._hideActivePopup,this).on(O.continueClick,this._hideActivePopup,this).on(q.selectClick,this._hideActivePopup,this),setTimeout((()=>{}),2e3)}))}_onSettingsClick(){this._addInQueue(tt.settings)}_onQueuePopup(t){this._addInQueue(t.type,t.config)}_addInQueue(t,e){const{ui:i}=Yt,{popupQueue:s}=i;s.push(new ao[t].model(t,e))}_onQueueUpdate(t,e){var i,s;if((null===(i=t[0])||void 0===i?void 0:i.uuid)===(null===(s=e[0])||void 0===s?void 0:s.uuid))return;const o=(0,ki.Z)(t);if(!o)return;const{ui:n}=Yt,{popupQueue:a}=n;a.setActive(o)}_onShowComplete(){this._idleActivePopup(),this.emit(ro._showCompleteEvent)}_onHideStart(){this.emit(ro._hideStartEvent)}_onHideComplete(){const{ui:t}=Yt,{popupQueue:e}=t;e.active.setState(Bi.destroy),e.shift(),this.emit(ro._hideCompleteEvent),0===e.length&&this.emit(ro._queueEmptyEvent)}_onBlockerClick(){this._hideActivePopup()}_onCloseBtnClick(){this._hideActivePopup()}_hideActivePopup(){const{ui:t}=Yt,{popupQueue:e}=t;e.active.setState(Bi.hide)}_idleActivePopup(){const{ui:t}=Yt,{popupQueue:e}=t;e.active.setState(Bi.idle)}_hasQueue(){const{ui:t}=Yt,{popupQueue:e}=t;return e.length>0}_hasHidingPopup(){const{ui:t}=Yt,{popupQueue:e}=t;return e.active.state===Bi.hide}_hasPopupInQueue(t){const{ui:e}=Yt,{popupQueue:i}=e;return i.hasPopupInQueue(t)}}(0,st.Z)(ro,"_queueEmptyEvent","queue_empty"),(0,st.Z)(ro,"_showCompleteEvent","show_complete"),(0,st.Z)(ro,"_hideStartEvent","hide_start"),(0,st.Z)(ro,"_hideCompleteEvent","hide_complete");var ho=i(6305);const lo={"dig-0":"dig-0","dig-1":"dig-1","dig-2":"dig-2","dig-3":"dig-3","dig-4":"dig-4","level-completed":"level-completed","out-of-fuel":"out-of-fuel",tap:"tap"};var co=i(8492);class uo{constructor(){(0,st.Z)(this,"name","sound"),(0,st.Z)(this,"_sounds",{}),(0,st.Z)(this,"_pausedSounds",[]),(0,st.Z)(this,"_playDigThrottled",void 0),(0,st.Z)(this,"onInstall",(()=>{s.q.event.on(Z.loadComplete,this._onLoadComplete,this).on(Z.mute,this._onMute,this).on(Z.unmute,this._onUnmute,this)})),(0,st.Z)(this,"_onMuteUpdate",(t=>{t?this._disable():this._enable()})),(0,st.Z)(this,"_onBricksThrown",(()=>{this._playDigThrottled()})),(0,st.Z)(this,"_onButtonClick",(()=>{this._play(lo.tap)})),(0,st.Z)(this,"_onPopupShowStart",(()=>{const{ui:t}=Yt,{popupQueue:e}=t,{type:i}=e.active;switch(i){case tt.levelCompleted:this._play(lo["level-completed"]);break;case tt.outOfFuel:this._play(lo["out-of-fuel"])}})),(0,st.Z)(this,"_onLoadComplete",(t=>{if("extra"===t){s.q.event.off(Z.loadComplete,this._onLoadComplete,this),s.q.event.on(S.muteUpdate,this._onMuteUpdate,this);const{user:e}=Yt,{mute:i}=e;this._onMuteUpdate(i),this._initSounds(t),this._initPlayDigThrottle()}})),(0,st.Z)(this,"_pauseAll",(()=>{Object.values(this._sounds).forEach((t=>{t.playing()&&(t.pause(),this._pausedSounds.push(t))}))})),(0,st.Z)(this,"_resumeAll",(()=>{Object.values(this._sounds).forEach((t=>{const e=this._pausedSounds.indexOf(t);-1!==e&&(t.play(),this._pausedSounds.splice(e,1))}))})),(0,st.Z)(this,"_initSounds",(t=>{var e;const i=null===(e=co.load[t].generic)||void 0===e?void 0:e.sounds;if(!i)return;const s=window.Howler._howls;i.forEach(((t,e)=>{const i=s[e];i&&(this._sounds[t]=i)}))}))}onPause(){this._pauseAll()}onResume(){this._resumeAll()}_onMute(){window.Howler.mute(!0)}_onUnmute(){window.Howler.mute(!1)}_enable(){this._playTheme(),s.q.event.on(F.bricksThrown,this._onBricksThrown,this).on(U.settingsButtonClick,this._onButtonClick,this).on(U.playButtonClick,this._onButtonClick,this).on(U.backButtonClick,this._onButtonClick,this).on(U.skinsButtonClick,this._onButtonClick,this).on(U.skinsCloseButtonClick,this._onButtonClick,this).on(A.fillThankClick,this._onButtonClick,this).on(A.noThanksClick,this._onButtonClick,this).on(L.continueClick,this._onButtonClick,this).on(L.inviteFriendsClick,this._onButtonClick,this).on(L.shareWithFriendsClick,this._onButtonClick,this).on(O.continueClick,this._onButtonClick,this).on(O.inviteFriendsClick,this._onButtonClick,this).on(O.shareWithFriendsClick,this._onButtonClick,this).on(E.hapticClick,this._onButtonClick,this).on(E.soundClick,this._onButtonClick,this).on(I.closeBtnClick,this._onButtonClick,this).on(q.selectClick,this._onButtonClick,this).on(U.propertiesShopButtonClick,this._onButtonClick,this).on(U.skinsShopButtonClick,this._onButtonClick,this).on(I.showStart,this._onPopupShowStart,this)}_disable(){this._stopTheme(),s.q.event.off(F.bricksThrown,this._onBricksThrown,this).off(U.settingsButtonClick,this._onButtonClick,this).off(U.playButtonClick,this._onButtonClick,this).off(U.backButtonClick,this._onButtonClick,this).off(U.skinsButtonClick,this._onButtonClick,this).off(U.skinsCloseButtonClick,this._onButtonClick,this).off(A.fillThankClick,this._onButtonClick,this).off(A.noThanksClick,this._onButtonClick,this).off(L.continueClick,this._onButtonClick,this).off(L.inviteFriendsClick,this._onButtonClick,this).off(L.shareWithFriendsClick,this._onButtonClick,this).off(O.continueClick,this._onButtonClick,this).off(O.inviteFriendsClick,this._onButtonClick,this).off(O.shareWithFriendsClick,this._onButtonClick,this).off(E.hapticClick,this._onButtonClick,this).off(E.soundClick,this._onButtonClick,this).off(I.closeBtnClick,this._onButtonClick,this).off(q.selectClick,this._onButtonClick,this).off(U.propertiesShopButtonClick,this._onButtonClick,this).off(U.skinsShopButtonClick,this._onButtonClick,this).off(I.showStart,this._onPopupShowStart,this)}_initPlayDigThrottle(){const t=Array.from([0,1,2,3,4]).map((t=>this._sounds[lo["dig-".concat(t)]].duration())),e=(Math.min(...t)+Math.max(...t))/2;this._playDigThrottled=(0,je.Z)(this._playDig,1e3*e,{trailing:!0,leading:!0})}_playDig(){const t=(0,ho.Z)(uo._digSounds);this._play(lo["dig-".concat(t)],{volume:.5}).rate((0,Tt.Z)(1,1.3,!0))}_playTheme(){Object.prototype.hasOwnProperty.call(lo,"theme")&&this._fade(lo.theme,{from:0,to:.5,duration:1,kill:!1},{loop:!0,volume:.4})}_stopTheme(){Object.prototype.hasOwnProperty.call(lo,"theme")&&this._sounds[lo.theme].stop()}_play(t,e){var i,s;const o=this._sounds[t];return o.loop(null!==(i=null==e?void 0:e.loop)&&void 0!==i&&i),o.volume(null!==(s=null==e?void 0:e.volume)&&void 0!==s?s:1),o.play(),o}_fade(t,e,i){const s=this._play(t,i),{from:o=0,to:n=s.volume(),duration:a=1,kill:r=!1}=e;return s.fade(o,n,1e3*a),r&&s.once("fade",(()=>s.stop())),s}}(0,st.Z)(uo,"_digSounds",[0,1,2,3,4,1,3]);const po=(0,je.Z)((()=>{const{skinSet:t}=Yt,e=t.serialize();Ct().saveProgression(N.skins,e)}),1e3,{leading:!0,trailing:!0}),_o=()=>{po()};class go{constructor(){(0,st.Z)(this,"name","statistics"),(0,st.Z)(this,"onInstall",(()=>{s.q.event.on(r.stateUpdate,this._onLevelStateUpdate,this)}))}_onLevelStateUpdate(t){if(t===Q.idle)this._checkUnlockConditions()}_checkUnlockConditions(){const{skinSet:t,statistics:e}=Yt;t.skins.forEach((t=>{t.unlockCondition(e)&&t.locked&&(t.locked=!1,s.q.command.execute(_o),s.q.event.emit(U.queuePopup,{type:tt.skinUnlock,config:{skin:t.skin}}))}))}}const mo=async()=>{const{app:t}=window.globals;t.installPlugin(new wi),t.installPlugin(new mi),t.installPlugin(new uo),t.installPlugin(new yi),t.installPlugin(new ro),t.installPlugin(new go)},yo=()=>{s.q.command.execute(mo)},vo=()=>{},fo=()=>{},wo=()=>{},bo=async()=>{await _s.init()},ko=async()=>{await s.q.command.executeAsync(bo),s.q.command.payload("main").execute(Xe)},xo=()=>{const{completionReason:t}=Yt.game.level;return t===K.clear},Co=()=>{const{state:t}=Yt.game.level;return t===Q.complete},Bo=()=>{const{state:t}=Yt.game.level;return t===Q.play},Mo=()=>!!Yt.game.tutorial,So=(0,je.Z)((()=>{const{statistics:t}=Yt,e=t.serialize();Ct().saveProgression(N.statistics,e)}),1e3,{leading:!0,trailing:!0}),Zo=()=>{So()},Po=()=>{Yt.statistics.completedLevels+=1,s.q.command.execute(Zo)},Uo=()=>{const{crusher:t}=Yt.game;t.startSpendFuel()},To=()=>{const{crusher:t}=Yt.game;t.stopSpendFuel()},Fo=()=>{Yt.game.destroyTutorialModel()},Do=async()=>{const{ui:t,game:e,user:i}=Yt,{crusher:s}=e,{crusherPropertiesShopModel:o}=t,{money:n}=i;o.updateButtons(s,n)},Io=()=>{s.q.command.execute(Do).execute(Ve)},Eo=t=>{Yt.user.money+=t,s.q.command.execute(Io)},Lo=t=>{Yt.game.level.money+=t},Oo=()=>{const{state:t}=Yt.game.crusher;return t===it.outOfFuel},Ao=async()=>{await Ct().showInterstitialAd()},qo=async()=>{const{game:t}=Yt,{level:e}=t,{money:i}=e;s.q.command.payload(Q.reviving).execute(Ge),await s.q.command.executeAsync(Ao),s.q.event.emit(U.queuePopup,{type:tt.outOfFuel,config:{money:i}})},zo=()=>{const{game:t}=Yt,{crusher:e,level:i}=t,{joystick:s}=i,{radius:o,azimuth:n}=s;e.setVelocity(o,n)},Go=()=>{const{progress:t}=Yt.game.level;return t>=.998},jo=async()=>{s.q.command.payload(!1).execute(Ke),await Ct().showTournamentCreatorPopup(),s.q.command.payload(!0).execute(Ke)},Wo=()=>{Yt.user.level+=1,s.q.command.execute(Ve)};const Vo=(0,i(3474).Z)((()=>{const{game:t}=Yt,{crusher:e}=t,i=e.serialize();Ct().saveProgression(N.crusher,i)}),500,{leading:!1,trailing:!0}),Ro=()=>{Vo()},Ho=()=>{Yt.game.crusher.resetProgress(),s.q.command.execute(Do).execute(Ro)},No=t=>{Yt.game.level.completionReason=t},Jo=async t=>{s.q.command.payload(t).execute(No).payload(Q.complete).execute(Ge)},Yo=async()=>{const{game:t}=Yt,{level:e}=t,{money:i}=e;s.q.command.payload(K.clear).execute(Jo).execute(Wo).execute(Ho),await s.q.command.executeAsync(Ao),await s.q.command.executeAsync(jo),s.q.event.emit(U.queuePopup,{type:tt.levelCompleted,config:{money:i}})},Qo=()=>{Yt.game.level.coinsPropagator.propagate()},Ko=Object.freeze([{event:T.down,command:(t,e)=>{const{game:i}=Yt,{level:o}=i,{joystick:n}=o;s.q.command.guard(Mo).execute(Fo),n.down(t,e)}},{event:T.up,command:(t,e)=>{const{game:i}=Yt,{level:s}=i,{joystick:o}=s;o.up(t,e)}},{event:T.drag,command:(t,e)=>{const{game:i}=Yt,{level:s}=i,{joystick:o}=s;o.drag(t,e)}},{event:f.azimuthUpdate,command:t=>{s.q.command.execute(zo)}},{event:f.radiusUpdate,command:()=>{s.q.command.execute(zo)}},{event:F.bricksCollected,command:()=>{s.q.command.execute(Qo)}},{event:F.bricksThrown,command:t=>{Yt.game.level.bricksThrown(t)}},{event:r.progressUpdate,command:()=>{s.q.command.guard(Go).execute(Yo)}},{event:a.stateUpdate,command:()=>{s.q.command.guard(Oo).execute(qo)}},{event:o.propagationUpdate,command:t=>{const{money:e}=t;s.q.command.payload(e).execute(Eo).payload(e).execute(Lo)}},{event:r.moneyUpdate,command:t=>{Ct().logUpdateScore(t)}}]),Xo=()=>{Ko.forEach((t=>{let{event:e,command:i}=t;return s.q.command.off(e,i)}))},$o=()=>{Yt.game.resetCrusherModel()},tn=()=>{s.q.command.execute($o).execute(Xo)},en=()=>{const{user:t,game:e}=Yt,{level:i}=t,{level:s}=e,{money:o,completionReason:n}=s;Ct().logLevelEnd(i,o,n===K.clear)},sn=()=>{const{user:t}=Yt,{level:e}=t;Ct().logLevelStart(e)},on=()=>{s.q.command.guard(Co,xo).execute(Po).guard(Bo).execute(sn).guard(s.q.not(Bo)).execute(To).guard(Bo).execute(Uo).guard(Mo,Co).execute(Fo).guard(Co).execute(tn).guard(Co).execute(en)},nn=()=>{Ko.forEach((t=>{let{event:e,command:i}=t;return s.q.command.on(e,i)}))},an=t=>{s.q.command.execute(t?nn:Xo)},rn=()=>{const{crusher:t}=Yt.game;t.resetFuelValue()},hn=()=>{Yt.game.destroyLevelModel()},ln=async()=>{s.q.command.execute(hn).execute($o).execute(rn).payload(Y.idle).execute(Qt),await s.q.command.executeAsync(ne)},dn=async t=>{s.q.command.payload(t).execute(Jo).execute(ln)},cn=async()=>{const{game:t}=Yt,{level:e}=t,{money:i}=e;s.q.command.payload(K.abort).execute(dn),await s.q.command.executeAsync(Ao),s.q.event.emit(U.queuePopup,{type:tt.abort,config:{money:i}})},un=async()=>{s.q.command.execute(ln)},pn=async()=>await Ct().showRewardedAd(),_n=async()=>{s.q.command.execute(rn).payload(Q.play).execute(Ge)},gn=async()=>{const t=await pn();s.q.command.guard((()=>t)).execute(_n).guard(s.q.not((()=>t))).payload(K.outOfFuel).execute(dn)},mn=()=>{const{user:t}=Yt,{haptic:e}=t;t.haptic=e?0:1,s.q.command.execute(Ve)},yn=async()=>{s.q.command.execute(mn)},vn=async()=>{s.q.command.payload(!1).execute(Ke),await Ct().inviteFriends(ie.L.images["base64-logo"],_s.get(cs.inviteFriendsText,{bestScore:"100"})),s.q.command.payload(!0).execute(Ke)},fn=()=>Ct().isFacebookPlatform(),wn=async()=>{const{game:t}=Yt,{level:e}=t,{money:i}=e;s.q.command.payload(K.outOfFuel).execute(Jo),s.q.event.emit(U.queuePopup,{type:tt.failedOffBoarding,config:{money:i}})},bn=async()=>{await s.q.command.executeAsync(jo),s.q.command.guard(fn).execute(wn).guard(s.q.not(fn)).payload(K.outOfFuel).execute(dn)},kn=()=>{s.q.command.payload(Y.play).execute(Qt).payload(Q.play).execute(Ge)},xn=(t,e)=>{const{user:i}=Yt;return!!e&&i.money>=e},Cn=t=>{Yt.user.money-=t,s.q.command.execute(Io)},Bn=t=>{const{game:e}=Yt,{crusher:i}=e;i.incrementProperty(t),s.q.command.execute(Ro)},Mn=(t,e)=>{s.q.command.payload(t).execute(Bn).payload(e).execute(Cn)},Sn=async t=>{const{ui:e}=Yt,{crusherPropertiesShopModel:i}=e,o=i["".concat(t,"Button")];if(o.discount){await pn()&&s.q.command.payload(t,o.discountPrice).guard(xn).execute(Mn)}else s.q.command.payload(t,o.price).guard(xn).execute(Mn)},Zn=async()=>{s.q.command.payload(!1).execute(Ke),await Ct().shareWithFriends(ie.L.images["base64-share-score"],_s.get(cs.shareScoreText,{bestScore:"100"})),s.q.command.payload(!0).execute(Ke)},Pn=t=>{const{crusher:e}=Yt.game;e.activeSkin=t,s.q.command.execute(Ro)},Un=async t=>{s.q.command.payload(t).execute(Pn)},Tn=()=>{const{state:t}=Yt.game;s.q.command.payload(t===Y.idle?Y.shopSkins:Y.idle).execute(Qt)},Fn=()=>{s.q.command.payload(Y.idle).execute(Qt)},Dn=t=>{s.q.command.payload(t).execute(Pn)},In=()=>{s.q.command.execute(Wo).execute(ln)},En=()=>{const{user:t}=Yt,{mute:e}=t;t.mute=e?0:1,s.q.command.execute(Ve)},Ln=async()=>{s.q.command.execute(En)},On=()=>{s.q.event.on(Z.init,yo).on(Z.start,ko).on(Z.resize,fo).on(Z.pause,vo).on(Z.resume,wo).on(Z.loadStart,ei).on(Z.loadComplete,$e).on(Z.loadError,ti).on(U.skinsButtonClick,Tn).on(U.skinsCloseButtonClick,Fn).on(U.playButtonClick,kn).on(U.backButtonClick,cn).on(U.propertiesShopButtonClick,Sn).on(U.skinsShopButtonClick,Dn).on(U.skipButtonClick,In).on(E.soundClick,Ln).on(E.hapticClick,yn).on(L.shareWithFriendsClick,Zn).on(L.inviteFriendsClick,vn).on(L.continueClick,un).on(O.shareWithFriendsClick,Zn).on(O.inviteFriendsClick,vn).on(O.continueClick,un).on(A.fillThankClick,gn).on(A.noThanksClick,bn).on(q.selectClick,Un).on(y.levelUpdate,an).on(r.stateUpdate,on)},An=()=>({name:"game",bounds:Ct().viewBounds}),qn=()=>({name:"game",bounds:Ct().viewBounds}),zn=t=>{const{width:e,height:i}=t,s=60/e,o=-40/e,n=14/e,a=14/e,r=.056,h=i*r/e;return{name:"ui",bounds:t,cells:[{name:"popup",bounds:{x:0,y:0,width:1,height:1}},{name:"settings",bounds:{x:0,y:0,width:h,height:r},padding:{x:.25,y:.25,width:.6,height:.6}},{name:"skip",bounds:{x:1-h,y:0,width:h,height:r},padding:{x:.15,y:.25,width:.6,height:.6}},{name:"money",bounds:{x:0,y:.065,width:1,height:.035},align:ks.Oo.leftCenter},{name:"progress",bounds:{x:0,y:.09,width:1,height:.046},align:ks.Oo.centerTop},{name:"back",bounds:{x:o,y:.154,width:1-o,height:.06},align:ks.Oo.leftTop},{name:"fuel",padding:{x:0,y:0,width:1,height:.91},bounds:{x:.04,y:0,width:s-.04,height:1},align:ks.Oo.rightCenter},{name:"skins",bounds:{x:0,y:.33,width:1,height:.083},align:ks.Oo.rightTop},{name:"play",bounds:{x:0,y:.535,width:1,height:1-.85},padding:{x:.21,y:.21,width:1-.42,height:1-.42}},{name:"fog",bounds:{x:0,y:.738,width:1,height:1-.665},scale:ks.P1.fill},{name:"property",bounds:{x:0,y:.7,width:1,height:.161}},{name:"shop-close",bounds:{x:0,y:.655,width:1,height:.05},padding:{x:0,y:0,width:1-a,height:1},align:ks.Oo.rightCenter},{name:"shop",bounds:{x:0,y:.743,width:1,height:.156},padding:{x:n,y:0,width:1-2*n,height:1},align:ks.Oo.leftCenter},{name:"shop-interaction",bounds:{x:0,y:.743,width:1,height:.156},scale:ks.P1.fill}]}},Gn=t=>{const{width:e,height:i}=t,s=88/e,o=-50/e,n=14/e,a=26/e,r=.056,h=i*r/e;return{name:"ui",bounds:t,cells:[{name:"popup",bounds:{x:0,y:0,width:1,height:1}},{name:"settings",bounds:{x:0,y:0,width:h,height:r},padding:{x:.2,y:.2,width:.8,height:.8}},{name:"skip",bounds:{x:1-h,y:0,width:h,height:r},padding:{x:0,y:.2,width:.8,height:.8}},{name:"money",bounds:{x:0,y:.065,width:1,height:.035},align:ks.Oo.leftCenter},{name:"back",bounds:{x:o,y:.153,width:1-o,height:.06},align:ks.Oo.leftTop},{name:"progress",bounds:{x:0,y:.088,width:1,height:.05}},{name:"fuel",padding:{x:0,y:0,width:1,height:.91},bounds:{x:.06,y:0,width:s-.06,height:1},align:ks.Oo.rightCenter},{name:"skins",bounds:{x:0,y:.33,width:1,height:.083},align:ks.Oo.rightTop},{name:"play",bounds:{x:0,y:.535,width:1,height:1-.85},padding:{x:.21,y:.21,width:1-.42,height:1-.42}},{name:"fog",bounds:{x:0,y:.74,width:1,height:1-.665},scale:ks.P1.fill},{name:"property",bounds:{x:0,y:.7,width:1,height:.161}},{name:"shop-close",bounds:{x:0,y:.655,width:1,height:.05},padding:{x:0,y:0,width:1-a,height:1},align:ks.Oo.rightCenter},{name:"shop",bounds:{x:0,y:.743,width:1,height:.156},padding:{x:n,y:0,width:1-2*n,height:1},align:ks.Oo.leftCenter},{name:"shop-interaction",bounds:{x:0,y:.743,width:1,height:.156},scale:ks.P1.fill}]}},jn=t=>{const{width:e,height:i}=t,s=88/e,o=-50/e,n=14/e,a=26/e,r=.056,h=i*r/e;return{name:"ui",bounds:t,cells:[{name:"popup",bounds:{x:0,y:0,width:1,height:1}},{name:"settings",bounds:{x:0,y:0,width:h,height:r},padding:{x:.2,y:.2,width:.6,height:.6}},{name:"skip",bounds:{x:1-h,y:0,width:h,height:r},padding:{x:.2,y:.2,width:.6,height:.6}},{name:"money",bounds:{x:0,y:.053,width:1,height:.028},align:ks.Oo.leftCenter},{name:"progress",bounds:{x:0,y:.075,width:1,height:.04},align:ks.Oo.centerTop},{name:"back",bounds:{x:o,y:.125,width:1-o,height:.05},align:ks.Oo.leftTop},{name:"fuel",padding:{x:0,y:0,width:1,height:.75},bounds:{x:0,y:0,width:s,height:1},align:ks.Oo.rightCenter},{name:"skins",bounds:{x:0,y:.33,width:1,height:.083},align:ks.Oo.rightTop},{name:"play",bounds:{x:0,y:.505,width:1,height:1-.85},padding:{x:0,y:0,width:1,height:.575},align:ks.Oo.centerTop},{name:"fog",bounds:{x:0,y:.665,width:1,height:1-.665},scale:ks.P1.fill},{name:"property",bounds:{x:0,y:.685,width:1,height:.163}},{name:"shop-close",bounds:{x:0,y:.594,width:1,height:.05},padding:{x:0,y:0,width:1-a,height:1},align:ks.Oo.rightCenter},{name:"shop",bounds:{x:0,y:.682,width:1,height:.156},padding:{x:n,y:0,width:1-2*n,height:1},align:ks.Oo.leftCenter},{name:"shop-interaction",bounds:{x:0,y:.682,width:1,height:.156},scale:ks.P1.fill}]}};let Wn;!function(t){t.ui="ui",t.game="game",t.scene="scene"}(Wn||(Wn={}));class Vn{constructor(){(0,st.Z)(this,"_config",new Map)}init(){}resize(t){this._config.set(Wn.ui,(t=>{const{viewBounds:e}=Ct();switch(Zs()){case V.fat:return zn(e);case V.tall:return jn(e);default:return Gn(e)}})()).set(Wn.game,(t=>({[j.landscape]:An(),[j.portrait]:qn()}[t]))(t))}getConfig(t){return this._config.get(t)}}const Rn=new class{constructor(){(0,st.Z)(this,"_gridLayout",new Vn)}init(){this._gridLayout.init()}onResize(t){this._gridLayout.resize(t)}onPause(){}onResume(){}getGridConfig(t){return this._gridLayout.getConfig(t)}};var Hn=i(7279),Nn=i(8414),Jn=i(6712),Yn=JSON.parse('{"AeroMaticsDisplayGreenBlueShadow":{"fontFamily":"AeroMaticsDisplay","fontSize":69,"fill":"#00736e","dropShadow":true,"dropShadowAngle":0.785,"dropShadowColor":"#004584","dropShadowDistance":1},"AeroMaticsDisplayBlueBlackShadow":{"fontFamily":"AeroMaticsDisplay","fontSize":62,"fill":"#169DF3","dropShadow":true,"dropShadowAngle":0.785,"dropShadowColor":"#000000","dropShadowDistance":1},"AeroMaticsDisplayWitheGrayShadow":{"fontFamily":"AeroMaticsDisplay","fontSize":52,"fill":"#FFFFFF","dropShadow":true,"dropShadowAngle":0.785,"dropShadowColor":"#8b8b8b","dropShadowDistance":2},"AeroMaticsDisplayWitheBlackStroke":{"fontFamily":"AeroMaticsDisplay","fontSize":50,"fill":"#FFFFFF","strokeThickness":6},"AeroMaticsDisplay":{"fontFamily":"AeroMaticsDisplay","fontSize":52,"fill":"#FFFFFF"}}');function Qn(t,e,i,s,o,n,a){const r=i.text,h=i.fontProperties;e.translate(s,o),e.scale(n,n);const l=a.strokeThickness/2,d=-a.strokeThickness/2;if(e.font=a.toFontString(),e.lineWidth=a.strokeThickness,e.textBaseline=a.textBaseline,e.lineJoin=a.lineJoin,e.miterLimit=a.miterLimit,e.fillStyle=function(t,e,i,s,o,n){const a=i.fill;if(!Array.isArray(a))return a;if(1===a.length)return a[0];let r;const h=i.dropShadow?i.dropShadowDistance:0,l=i.padding||0,d=t.width/s-h-2*l,c=t.height/s-h-2*l,u=a.slice(),p=i.fillGradientStops.slice();if(!p.length){const t=u.length+1;for(let e=1;e<t;++e)p.push(e/t)}if(u.unshift(a[0]),p.unshift(0),u.push(a[a.length-1]),p.push(1),i.fillGradientType===Zi.M_1.LINEAR_VERTICAL){r=e.createLinearGradient(d/2,l,d/2,c+l);let t=0;const s=(n.fontProperties.fontSize+i.strokeThickness)/c;for(let e=0;e<o.length;e++){const i=n.lineHeight*e;for(let e=0;e<u.length;e++){let o=0;o="number"==typeof p[e]?p[e]:e/u.length;const n=i/c+o*s;let a=Math.max(t,n);a=Math.min(a,1),r.addColorStop(a,u[e]),t=a}}}else{r=e.createLinearGradient(l,c/2,d+l,c/2);const t=u.length+1;let i=1;for(let e=0;e<u.length;e++){let s;s="number"==typeof p[e]?p[e]:i/t,r.addColorStop(s,u[e]),i++}}return r}(t,e,a,n,[r],i),e.strokeStyle=a.stroke,a.dropShadow){const t=a.dropShadowColor,i=Zi.P6Y.hex2rgb("number"==typeof t?t:Zi.P6Y.string2hex(t)),s=a.dropShadowBlur*n,o=a.dropShadowDistance*n;e.shadowColor="rgba(".concat(255*i[0],",").concat(255*i[1],",").concat(255*i[2],",").concat(a.dropShadowAlpha,")"),e.shadowBlur=s,e.shadowOffsetX=Math.cos(a.dropShadowAngle)*o,e.shadowOffsetY=Math.sin(a.dropShadowAngle)*o}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;a.stroke&&a.strokeThickness&&e.strokeText(r,l,d+i.lineHeight-h.descent),a.fill&&e.fillText(r,l,d+i.lineHeight-h.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function Kn(t){"string"==typeof t&&(t=[t]);const e=[];for(let s=0,o=t.length;s<o;s++){const o=t[s];if(Array.isArray(o)){if(2!==o.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got ".concat(o.length,"."));const t=o[0].charCodeAt(0),i=o[1].charCodeAt(0);if(i<t)throw new Error("[BitmapFont]: Invalid character range.");for(let s=t,o=i;s<=o;s++)e.push(String.fromCharCode(s))}else e.push(...(i=o,Array.from?Array.from(i):i.split("")))}var i;if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}function Xn(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}class $n{constructor(){(0,st.Z)(this,"_loader",new Zi.aNw)}async load(t,e){return new Promise((async i=>{const{images:s,spines:o,atlases:n,fonts:a,sounds:r}=t;!(0,Hn.Z)(s)&&await this.__loadImages__(s),!(0,Hn.Z)(n)&&await this.__loadAtlases__(n),!(0,Hn.Z)(r)&&await this.__loadSounds__(r),!(0,Hn.Z)(o)&&await this.__loadSpines__(o),!(0,Hn.Z)(a)&&await this.__loadFonts__(a),this._loader.load((()=>i())),this._loader.onProgress.add((()=>e()))}))}async onGenericAssetLoad(t,e){switch(t){case"sound":this._processSound(e);break;case"font":this._processFont(e)}}_processSound(t){}_processFont(t){const e=(0,Jn.Z)(Yn,(e=>e.fontFamily===t));Object.keys(e).forEach((t=>{const i=(0,Nn.Z)({fontSize:60,fill:"#ffffff"},e[t]);!function(t,e,i){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!t)throw new Error("[BitmapFont] Property `name` is required.");const{chars:o,padding:n,resolution:a,textureWidth:r,textureHeight:h}=Object.assign({},Zi.UPD.defaultOptions,i),l=Kn(o),d=e instanceof Zi.pn8?e:new Zi.pn8(e),c=r,u=new Zi.d0Z;u.info[0]={face:d.fontFamily,size:d.fontSize},u.common[0]={lineHeight:d.fontSize};let p,_,g,m=0,y=0,v=0;const f=[],w=[];for(let t=0;t<l.length;t++){p||(p=document.createElement("canvas"),p.width=r,p.height=h,_=p.getContext("2d"),g=new Zi.VL4(p,{resolution:a}),f.push(g),w.push(new Zi.xEZ(g)),u.page.push({id:w.length-1,file:""}));const e=Zi._A.measureText(l[t],d,!1,p),i=e.width,s=Math.ceil(e.height),o=Math.ceil(("italic"===d.fontStyle?2:1)*i);if(y>=h-s*a){if(0===y)throw new Error("[BitmapFont] textureHeight ".concat(h,"px is ")+"too small for ".concat(d.fontSize,"px fonts"));--t,p=null,_=null,g=null,y=0,m=0,v=0;continue}if(v=Math.max(s+e.fontProperties.descent,v),o*a+m>=c){--t,y+=v*a,y=Math.ceil(y),m=0,v=0;continue}Qn(p,_,e,m,y,a,d);const b=Xn(e.text);u.char.push({id:b,page:w.length-1,x:m/a,y:y/a,width:o,height:s,xoffset:0,yoffset:0,xadvance:Math.ceil(i-(d.dropShadow?d.dropShadowDistance:0)-(d.stroke?d.strokeThickness:0))}),m+=(o+2*n)*a,m=Math.ceil(m)}if(s)for(let t=0,e=l.length;t<e;t++){const i=l[t];for(let t=0;t<e;t++){const e=l[t],s=_.measureText(i).width,o=_.measureText(e).width,n=_.measureText(i+e).width-(s+o);n&&u.kerning.push({first:Xn(i),second:Xn(e),amount:n})}}const b=new Zi.UPD(u,w,!0);void 0!==Zi.UPD.available[t]&&Zi.UPD.uninstall(t),Zi.UPD.available[t]=b}(t,new Zi.pn8(i),(0,Nn.Z)({chars:cs.__charset__,textureHeight:1024,textureWidth:1024,padding:.1*i.fontSize,resolution:di()},i))}))}async __loadAtlases__(t){return new Promise((e=>{t.forEach((t=>{const e=ie.L.atlases[t].image,i=ie.L.atlases[t].json;this._loader.add({key:t,url:e,onComplete:t=>{var e,s;e=t,s=i,new Zi.c2G(e.texture.baseTexture,s).parse((()=>{}))}})})),e()}))}async __loadImages__(t){return new Promise((e=>{t.forEach((t=>{const e=ie.L.images[t];this._loader.add({key:t,url:e})})),e()}))}async __loadSounds__(t){return new Promise((e=>{t.forEach((t=>{const e=ie.L.sounds[t];this._loader.add({key:t,url:e})})),e()}))}async __loadSpines__(t){return new Promise((e=>{t.forEach((t=>{const e=ie.L.spines[t].image;ie.L.spines[t].json,ie.L.spines[t].atlas;this._loader.add({key:t,url:e,onComplete:t=>{}})})),e()}))}async __loadFonts__(t){return new Promise((t=>{t()}))}}var ta=i(3671);class ea{constructor(t,e){(0,st.Z)(this,"_view",new ia),this._parent=t,this._interaction=e,this._view=new ia,this._parent.addChild(this._view)}setInteractive(t){t?this._setListeners():this._removeListeners()}destroy(){this.setInteractive(!1),this._view.destroy()}_setListeners(){this._removeListeners(),this._interaction.on("pointerdown",this._onDown,this)}_removeListeners(){this._interaction.off("pointerdown",this._onDown,this),this._interaction.off("pointerup",this._onUp,this),this._interaction.off("pointerupoutside",this._onUp,this),this._interaction.off("pointermove",this._onMove,this)}_onDown(t){t.target||(this._view.down(t,this._parent),this._interaction.on("pointerup",this._onUp,this),this._interaction.on("pointerupoutside",this._onUp,this),this._interaction.on("pointermove",this._onMove,this))}_onUp(t){this._view.up(t,this._parent),this._interaction.off("pointerup",this._onUp,this),this._interaction.off("pointermove",this._onMove,this),this._interaction.off("pointerupoutside",this._onUp,this)}_onMove(t){this._view.drag(t,this._parent)}}class ia extends Zi.W20{constructor(){super(),(0,st.Z)(this,"_handle",void 0),(0,st.Z)(this,"_bg",void 0),(0,st.Z)(this,"_interactionData",void 0),(0,st.Z)(this,"_dragging",void 0),(0,st.Z)(this,"_azimuth",0),(0,st.Z)(this,"_radius",0),(0,st.Z)(this,"_bgHeightHalf",0),(0,st.Z)(this,"_bgWidthHalf",0),this._createBg(),this._createHandle(),s.q.event.on(f.azimuthUpdate,this._onAzimuthUpdate,this),s.q.event.on(f.radiusUpdate,this._onRadiusUpdate,this),this.visible=!1}destroy(){s.q.event.off(f.azimuthUpdate,this._onAzimuthUpdate,this),s.q.event.off(f.radiusUpdate,this._onRadiusUpdate,this),super.destroy({children:!0})}down(t,e){this.visible=!0,this._interactionData=t.data,this._dragging=!0;const i=this._interactionData.getLocalPosition(e.parent);this.position.copyFrom(i),s.q.event.emit(T.down,this.position,i),this._moveJoystick(i)}up(t,e){if(!this._interactionData)return;this.visible=!1;const i=this._interactionData.getLocalPosition(e.parent);s.q.event.emit(T.up,this.position,i),this._interactionData=null,this._dragging=!1}drag(t,e){if(this._dragging){const t=this._interactionData.getLocalPosition(e.parent);s.q.event.emit(T.drag,this.position,t),this._moveJoystick(t)}}_createBg(){this._bg=Cs({texture:Pi["joystick/background"]}),this.addChild(this._bg),this._bgHeightHalf=this._bg.height/2,this._bgWidthHalf=this._bg.width/2}_createHandle(){this._handle=Cs({texture:Pi["joystick/handle"]}),this.addChild(this._handle)}_onAzimuthUpdate(t){this._azimuth=t,this._positionHandle()}_onRadiusUpdate(t){this._radius=t,this._positionHandle()}_positionHandle(){const t=this._radius*Math.cos(this._azimuth)*this._bgHeightHalf,e=this._radius*Math.sin(this._azimuth)*this._bgWidthHalf;this._handle.position.set(t,e)}_moveJoystick(t){const e=this.parent.toLocal(this._handle.position,this),i=t.x-e.x,s=t.y-e.y;(Math.abs(i)>ia._moveThreshold||Math.abs(s)>ia._moveThreshold)&&(this.x=(0,ta.t7)(this.x,this.x+i,ri/50),this.y=(0,ta.t7)(this.y,this.y+s,ri/50))}}(0,st.Z)(ia,"_moveThreshold",10);class sa extends Zi.W20{constructor(){super(),(0,st.Z)(this,"_joystickAdapter",void 0),this.name="GameView",s.q.event.on(r.joystickUpdate,this._onJoystickUpdate,this),s.q.event.on(y.stateUpdate,this._onGameStateUpdate,this)}getGridConfig(){return Rn.getGridConfig(Wn.game)}rebuild(t){}update(t,e){}_onGameStateUpdate(t){var e;if(t===Y.play)null===(e=this._joystickAdapter)||void 0===e||e.setInteractive(!0)}_onJoystickUpdate(t){t?this._createJoystick():this._destroyJoystick()}_createJoystick(){this._joystickAdapter=new ea(this,Ct().getRuntime("pixi").renderer.plugins.interaction)}_destroyJoystick(){this._joystickAdapter.destroy(),this._joystickAdapter=null}}var oa=i(1428);class na extends Is{constructor(t,e){super(t),this._uuid=e,this.cancelDiscount()}get uuid(){return this._uuid}updateTag(t){this.strategy.updateTag(t)}cancelDiscount(){this.strategy.cancelDiscount()}setDiscount(t){this.strategy.setDiscount(t)}up(){super.up(null)}down(){super.down(null)}over(){super.over(null)}disable(){super.enable(!1)}}class aa{constructor(t){(0,st.Z)(this,"view",void 0),(0,st.Z)(this,"_bg",void 0),(0,st.Z)(this,"_iconBg",void 0),(0,st.Z)(this,"_icon",void 0),(0,st.Z)(this,"_discountBg",void 0),(0,st.Z)(this,"_name",void 0),(0,st.Z)(this,"_tag",void 0),(0,st.Z)(this,"_discountLabel",void 0),(0,st.Z)(this,"_textures",void 0),this._config=t}get config(){return this._config}updateTag(t){this._tag.text=t,this._fitLabelWithConfig(this._tag,this._config.tag.buttonFit)}cancelDiscount(){this._discountBg&&(this._discountBg.visible=!1),this._discountLabel&&(this._discountLabel.visible=!1)}setDiscount(t){this._discountBg&&(this._discountBg.visible=!0),this._discountLabel&&(this._discountLabel.visible=!0,this._discountLabel.text=t),this._fitLabelWithConfig(this._discountLabel,this._config.discountLabel.buttonFit)}init(t){const{bg:e,iconBg:i,discountBg:s,icon:o,name:n,tag:a,textures:r,discountLabel:h}=this._config;this._bg=this._createBg(e),this._iconBg=this._createBg(i),this._icon=this._createIcon(o),this._name=this._createLabel(n),this._tag=this._createLabel(a),this._textures=this._createTextures(r);const l=new Zi.W20;l.addChild(this._bg),l.addChild(this._iconBg),l.addChild(this._icon),l.addChild(this._name),l.addChild(this._tag),s&&(this._discountBg=this._createIcon(s),l.addChild(this._discountBg)),h&&(this._discountLabel=this._createLabel(h),l.addChild(this._discountLabel)),this._fitLabel(),t.addChild(this.view=l)}up(){var t,e,i,s;const{name:o,tag:n}=this._config.textures.up,{bg:a,discountBg:r,iconBg:h}=this._textures.up;this._bg.texture=a,this._iconBg.texture=h,r&&(this._discountBg.texture=r),this._name.tint=o.tint,this._name.position.x=((null===(t=this._config.name)||void 0===t?void 0:t.position.x)||0)+o.offset.x,this._name.position.y=((null===(e=this._config.name)||void 0===e?void 0:e.position.y)||0)+o.offset.y,this._tag.tint=n.tint,this._tag.position.x=((null===(i=this._config.tag)||void 0===i?void 0:i.position.x)||0)+n.offset.x,this._tag.position.y=((null===(s=this._config.tag)||void 0===s?void 0:s.position.y)||0)+n.offset.y,this.view.scale.set(1)}down(){var t,e,i,s;if(!this._config.textures.down)return;const{name:o,tag:n}=this._config.textures.down,{bg:a,discountBg:r,iconBg:h}=this._textures.down;this._bg.texture=a,this._iconBg.texture=h,r&&(this._discountBg.texture=r),this._name.tint=o.tint,this._name.position.x=((null===(t=this._config.name)||void 0===t?void 0:t.position.x)||0)+o.offset.x,this._name.position.y=((null===(e=this._config.name)||void 0===e?void 0:e.position.y)||0)+o.offset.y,this._tag.tint=n.tint,this._tag.position.x=((null===(i=this._config.tag)||void 0===i?void 0:i.position.x)||0)+n.offset.x,this._tag.position.y=((null===(s=this._config.tag)||void 0===s?void 0:s.position.y)||0)+n.offset.y,this.view.scale.set(1)}over(){var t,e,i,s;if(!this._config.textures.over)return;const{name:o,tag:n}=this._config.textures.over,{bg:a,discountBg:r,iconBg:h}=this._textures.over;this._bg.texture=a,this._iconBg.texture=h,r&&(this._discountBg.texture=r),this._name.tint=o.tint,this._name.position.x=((null===(t=this._config.name)||void 0===t?void 0:t.position.x)||0)+o.offset.x,this._name.position.y=((null===(e=this._config.name)||void 0===e?void 0:e.position.y)||0)+o.offset.y,this._tag.tint=n.tint,this._tag.position.x=((null===(i=this._config.tag)||void 0===i?void 0:i.position.x)||0)+n.offset.x,this._tag.position.y=((null===(s=this._config.tag)||void 0===s?void 0:s.position.y)||0)+n.offset.y,this.view.scale.set(1)}disable(){var t,e,i,s;if(!this._config.textures.disable)return;const{name:o,tag:n}=this._config.textures.disable,{bg:a,discountBg:r,iconBg:h}=this._textures.disable;this._bg.texture=a,this._iconBg.texture=h,r&&(this._discountBg.texture=r),this._name.tint=o.tint,this._name.position.x=((null===(t=this._config.name)||void 0===t?void 0:t.position.x)||0)+o.offset.x,this._name.position.y=((null===(e=this._config.name)||void 0===e?void 0:e.position.y)||0)+o.offset.y,this._tag.tint=n.tint,this._tag.position.x=((null===(i=this._config.tag)||void 0===i?void 0:i.position.x)||0)+n.offset.x,this._tag.position.y=((null===(s=this._config.tag)||void 0===s?void 0:s.position.y)||0)+n.offset.y,this.view.scale.set(1)}_fitLabel(){this._fitLabelWithConfig(this._name,this._config.name.buttonFit),this._fitLabelWithConfig(this._tag,this._config.tag.buttonFit),this._config.discountLabel&&this._fitLabelWithConfig(this._discountLabel,this._config.discountLabel.buttonFit)}_fitLabelWithConfig(t,e){const{x:i,y:s}=e;Ss(t,i*this._bg.width,s*this._bg.height)}_createIcon(t){return Cs(t)}_createBg(t){return Ms(t)}_createLabel(t){return Bs(t)}_createTextures(t){const e={};return Object.keys(t).forEach((i=>{var s;return e[i]={bg:Zi.xEZ.from(t[i].bg.texture),iconBg:Zi.xEZ.from(t[i].iconBg.texture),discountBg:null!==(s=t[i].discountBg)&&void 0!==s&&s.texture?Zi.xEZ.from(t[i].discountBg.texture):void 0}})),e}}class ra extends aa{disable(){super.disable(),this.view.scale.set(.9)}}class ha extends Zi.W20{constructor(){super(),(0,st.Z)(this,"_buttons",new Map),s.q.event.on(m.fuelButtonUpdate,this._onCrusherPropertiesShopButtonUpdate,this).on(m.lengthButtonUpdate,this._onCrusherPropertiesShopButtonUpdate,this).on(m.powerButtonUpdate,this._onCrusherPropertiesShopButtonUpdate,this).on(m.sizeButtonUpdate,this._onCrusherPropertiesShopButtonUpdate,this)}_onCrusherPropertiesShopButtonUpdate(t){this._updatePropertyButton(t)}_onButtonInteraction(t){this.emit("interaction",t)}_updatePropertyButton(t){let e=this._buttons.get(t.name);e||(e=this._buildButton(t)),e.enable(t.enabled),e.updateTag((0,oa.Z)(t.price)?_i(t.price):_s.get("max")),t.discount?e.setDiscount(_i(t.discountPrice)):e.cancelDiscount()}_buildButton(t){const{name:e}=t,i=new na(new ra((t=>{return{input:{enable:!0,area:new Zi.AeJ(-85,-115,170,230)},bg:Li,iconBg:Ii,discountBg:hs,icon:(e=t,{texture:Pi["icon-property-".concat(e)],position:{x:0,y:-40}}),name:gs(t),tag:{text:"5$",style:{fontName:ds.AeroMaticsDisplayBlueBlackShadow,fontSize:62},position:{x:0,y:66},buttonFit:{x:.62,y:1}},discountLabel:{text:"1.3k$",style:{fontName:ds.AeroMaticsDisplayWitheBlackStroke,fontSize:36},position:{x:22,y:-118},buttonFit:{x:.5,y:1},anchor:{x:.5,y:.5}},textures:{up:{bg:{texture:Pi["button-property"]},iconBg:{texture:Pi["bg-property-blue"]},discountBg:{texture:Pi["bg-discount"]},name:{tint:16777215,offset:{x:0,y:0}},tag:{tint:16777215,offset:{x:0,y:0}}},down:{bg:{texture:Pi["button-property-pressed"]},iconBg:{texture:Pi["bg-property-blue-dark"]},discountBg:{texture:Pi["bg-discount-pressed"]},name:{tint:16777215,offset:{x:0,y:0}},tag:{tint:16777215,offset:{x:0,y:0}}},disable:{bg:{texture:Pi["button-property-pressed"]},iconBg:{texture:Pi["bg-property-blue-dark"]},name:{tint:16777215,offset:{x:0,y:0}},tag:{tint:16777215,offset:{x:0,y:0}}}}};var e})(e)),e);return i.x+=this._buttons.size*(i.width+ha._gap),i.on("interaction",(()=>this._onButtonInteraction(e)),this),this.addChild(i),this._buttons.set(e,i),i}}(0,st.Z)(ha,"_gap",13);const la={duration:.115,ease:Ci.Yv.easeInOut,paused:!0,universal:!0,yoyo:!0,repeat:-1,pixi:{scale:.7}};class da extends Zi.W20{constructor(){super(),(0,st.Z)(this,"_bg",void 0),(0,st.Z)(this,"_fill",void 0),(0,st.Z)(this,"_fillMask",void 0),(0,st.Z)(this,"_full",0),(0,st.Z)(this,"_warning",void 0),(0,st.Z)(this,"_warningTween",void 0),this._build()}setFuel(t){this._fillMask.scale.y=this._full*t}alarm(){this._warning.visible=!0,this._warningTween.restart()}calm(){this._warning.visible=!1,this._warningTween.pause()}_build(){this._buildBg(),this._buildFuelIcon(),this._buildFill(),this._buildWarningIcon()}_buildWarningIcon(){this._warning=Cs(ss),this._warning.visible=!1,this.addChild(this._warning),this._warningTween=xi.ZP.to(this._warning,la)}_buildFuelIcon(){const t=Cs(is);t.y=-this._bg.height/2-4,this.addChild(t)}_buildFill(){this._fill=Ms(Vi),this._fill.y=this._bg.height/2-8;const{width:t,height:e}=Zi.xEZ.WHITE;this._full=this._fill.height/e,this._fillMask=Cs({texture:Zi.xEZ.WHITE,scale:{x:this._fill.width/t,y:this._full},tint:16711935,anchor:{x:.5,y:1},position:{x:0,y:this._fill.height/2}}),this.addChild(this._fillMask),this._fill.mask=this._fillMask,this.addChild(this._fill)}_buildBg(){this._bg=Ms(Wi),this.addChild(this._bg)}}class ca extends Zi.W20{constructor(){super(),(0,st.Z)(this,"_bg",void 0),(0,st.Z)(this,"_fill",void 0),(0,st.Z)(this,"_label",void 0),(0,st.Z)(this,"_labelHeight",void 0),(0,st.Z)(this,"_full",0),this._build()}setProgress(t){this._fill.width=this._full*t}setLevel(t){this._label.text=_s.get("level #",{level:t}),Ss(this._label,.9*this._bg.width,this._labelHeight)}_build(){this._buildBg(),this._buildFill(),this._buildLabel()}_buildLabel(){this._label=Bs({text:"LEVEL 1",style:{fontName:ds.AeroMaticsDisplay,fontSize:34,tint:3289650},position:{x:0,y:28}}),this.addChild(this._label),this._labelHeight=this._label.height}_buildFill(){this._fill=Ms(ji),this._fill.x=-this._bg.width/2+10,this._full=this._fill.width,this.addChild(this._fill)}_buildBg(){this._bg=Ms(Gi),this.addChild(this._bg)}}class ua extends Zi.W20{constructor(){super(),(0,st.Z)(this,"_bg",void 0),(0,st.Z)(this,"_label",void 0),this._build()}setMoney(t){this._label.text=_i(t),Ss(this._label,.55*this._bg.width,this._bg.height)}_build(){this._buildPlain(),this._buildIcon(),this._buildLabel()}_buildLabel(){this._label=Bs({text:"2.5k$",style:{fontName:ds.AeroMaticsDisplayWitheBlackStroke,fontSize:34},anchor:{x:1,y:.5},position:{x:0,y:-3}}),this._label.x=this._bg.width/2-20,this.addChild(this._label)}_buildIcon(){const t=Cs(es);t.x=-this._bg.width/2+14,this.addChild(t)}_buildPlain(){this._bg=Ms(zi),this.addChild(this._bg)}}var pa=i(8545),_a=i(4569),ga=i(3144);class ma extends _a.j{constructor(){super(pa.xE.WHITE),(0,st.Z)(this,"_showTween",void 0),(0,st.Z)(this,"_hideTween",void 0)}setRenderable(t){return this.renderable=t,this}setInteractive(t){return this.interactive=t,this}setParentGroup(t){return this.parentGroup=t,this}setTint(t){return this.tint=t,this}setAlpha(t){return this.alpha=t,this.setRenderable(!(0===this.alpha)),this}async show(t){return new Promise((e=>{this._showTween=ga.ZP.from(this,{alpha:0,duration:t,onComplete:()=>{e()}})}))}async hide(t){return new Promise((e=>{this._hideTween=ga.ZP.to(this,{alpha:0,duration:t,onComplete:()=>{this.reset(),e()}})}))}reset(){this._showTween&&this._showTween.totalProgress(1).kill(),this._hideTween&&this._hideTween.totalProgress(1).kill(),this.setInteractive(!1),this.setParentGroup(null),this.setTint(16777215),this.setAlpha(0)}}class ya extends ks.D3{constructor(){super(),(0,st.Z)(this,"_blocker",void 0),(0,st.Z)(this,"_active",void 0),s.q.event.on(p.activeUpdate,this._onActiveUpdate,this),this._buildBlocker()}getGridConfig(){const{orientation:t}=Ct();return((t,e)=>({[j.landscape]:Ts(e),[j.portrait]:Fs(e)}[t]))(t,this._active?this._active.getCellConfig(t):{})}rebuild(t){this._active&&this._active.rebuild(this.grid.getCellByName("content")),super.rebuild(t)}_onActiveUpdate(t){t?this._buildPopup(t):this._destroyActivePopup()}_buildPopup(t){const{view:e,configFn:i}=ao[t.type];this._active=new e(i(),t.config),this._active.on(As.stateUpdateEvent,this._onActiveStateUpdate,this),this._active.on(As.closeBtnClickEvent,this._onActiveCloseClick,this),this.setChild("content",this._active),this.parent.addChild(this)}_destroyActivePopup(){this._active.off(As.stateUpdateEvent),this._active.off(As.closeBtnClickEvent),this.removeContent(this._active),this.removeChild(this._active),this._active.destroy({children:!0}),this._active=null,this.rebuild(this.getGridConfig())}async _onActiveStateUpdate(t,e){switch(t){case et.init:this._active.init(),this.emit(ya.activePopupInit);break;case et.idle:this._active.idle(),this._idleBlocker(e.blocker);break;case et.show:this._onActiveShowStart(),await Promise.all([e.content.showBehavior(this._active),this._showBlocker(e.blocker)]),this._onActiveShowComplete();break;case et.hide:this._onActiveHideStart(),await Promise.all([e.content.hideBehavior(this._active),this._hideBlocker(e.blocker)]),this._onActiveHideComplete()}}async _showBlocker(t){const{init:e,show:i}=t,{alpha:o,interactive:n,tint:a}=e,{duration:r}=i;this._blocker.setAlpha(o),this._blocker.setInteractive(n),this._blocker.setTint(a),s.q.event.emit(I.blockerShowStart),await this._blocker.show(r)}async _hideBlocker(t){const{hide:e,init:i}=t,{backdrop:o}=i;o&&this._blocker.off("pointertap",this._onBlockerClick,this),await this._blocker.hide(e.duration),s.q.event.emit(I.blockerHideComplete)}_idleBlocker(t){const{backdrop:e}=t.init;e&&this._blocker.once("pointertap",this._onBlockerClick,this)}_onBlockerClick(){s.q.event.emit(I.blockerClick)}_onActiveShowStart(){s.q.event.emit(I.showStart)}_onActiveShowComplete(){s.q.event.emit(I.showComplete)}_onActiveHideStart(){s.q.event.emit(I.hideStart)}_onActiveHideComplete(){s.q.event.emit(I.hideComplete)}_onActiveCloseClick(){s.q.event.emit(I.closeBtnClick)}_buildBlocker(){this._blocker=new ma,this._blocker.setAlpha(0),this.setChild("blocker",this._blocker)}}(0,st.Z)(ya,"activePopupInit","active_popup_init");i(9992);class va extends Zi.W20{constructor(){super(),(0,st.Z)(this,"_internalBounds",void 0),(0,st.Z)(this,"_button",void 0),(0,st.Z)(this,"_buttonOpenTween",void 0),(0,st.Z)(this,"_open",!1),this._build()}getBounds(){return this._internalBounds.getBounds()}open(){this._buttonOpenTween.play(),this._open=!0}close(){this._buttonOpenTween.reverse(),this._open=!1}_build(){this._buildInternalBounds(),this._buildSkinsButton(),this._buildSkinsButtonTween()}_buildInternalBounds(){const{width:t,height:e}=Ai,{width:i,height:s}=Zi.xEZ.WHITE;this._internalBounds=Cs({texture:Zi.xEZ.WHITE,scale:{x:t/i,y:e/s}}),this._internalBounds.renderable=!1,this.addChild(this._internalBounds)}_buildSkinsButton(){const t=new Is(new Es({input:{enable:!0},bg:Ai,label:{text:_s.get(cs.skins),style:{fontName:ds.AeroMaticsDisplayGreenBlueShadow,fontSize:58},position:{x:92,y:-10},anchor:{x:0,y:.5},buttonFit:{x:.38,y:1}},textures:{up:{bg:{texture:Pi["button-skins"]},label:{tint:16777215,offset:{x:0,y:0}}},down:{bg:{texture:Pi["button-skins-pressed"]},label:{tint:16777215,offset:{x:0,y:0}}}}}));t.x-=56,t.on("interaction",this._onSkinsButtonInteraction,this),this.addChild(this._button=t)}_buildSkinsButtonTween(){this._buttonOpenTween=xi.ZP.to(this._button,{x:-this._internalBounds.width/2,duration:.4,ease:Ci.lD.easeInOut,paused:!0,universal:!0})}_onSkinsButtonInteraction(){this.emit("interaction")}}let fa,wa,ba,ka,xa,Ca,Ba,Ma,Sa,Za=()=>fa||"undefined"!=typeof window&&(fa=window.gsap),Pa={},Ua=t=>Sa(t).id,Ta=t=>Pa[Ua("string"==typeof t?ba(t)[0]:t)],Fa=t=>{let e,i=xa;if(t-Ba>=.05)for(Ma=Ba,Ba=t;i;)e=i.g(i.t,i.p),(e!==i.v1||t-i.t1>.2)&&(i.v2=i.v1,i.v1=e,i.t2=i.t1,i.t1=t),i=i._next},Da={deg:360,rad:2*Math.PI},Ia=()=>{fa=Za(),fa&&(ba=fa.utils.toArray,ka=fa.utils.getUnit,Sa=fa.core.getCache,Ca=fa.ticker,wa=1)};class Ea{constructor(t,e,i,s){this.t=t,this.p=e,this.g=t._gsap.get,this.rCap=Da[i||ka(this.g(t,e))],this.v1=this.v2=0,this.t1=this.t2=Ca.time,s&&(this._next=s,s._prev=this)}}class La{constructor(t,e){wa||Ia(),this.target=ba(t)[0],Pa[Ua(this.target)]=this,this._props={},e&&this.add(e)}static register(t){fa=t,Ia()}get(t,e){let i,s,o,n=this._props[t]||void 0;return i=parseFloat(e?n.v1:n.g(n.t,n.p)),s=i-parseFloat(n.v2),o=n.rCap,o&&(s%=o,s!==s%(o/2)&&(s=s<0?s+o:s-o)),a=s/((e?n.t1:Ca.time)-n.t2),Math.round(1e4*a)/1e4;var a}getAll(){let t,e={},i=this._props;for(t in i)e[t]=this.get(t);return e}isTracking(t){return t in this._props}add(t,e){t in this._props||(xa||(Ca.add(Fa),Ba=Ma=Ca.time),xa=this._props[t]=new Ea(this.target,t,e,xa))}remove(t){let e,i,s=this._props[t];s&&(e=s._prev,i=s._next,e&&(e._next=i),i?i._prev=e:xa===s&&(Ca.remove(Fa),xa=0),delete this._props[t])}kill(t){for(let t in this._props)this.remove(t);t||delete Pa[Ua(this.target)]}static track(t,e,i){wa||Ia();let s,o,n=[],a=ba(t),r=e.split(","),h=(i||"").split(","),l=a.length;for(;l--;){for(s=Ta(a[l])||new La(a[l]),o=r.length;o--;)s.add(r[o],h[o]||h[0]);n.push(s)}return n}static untrack(t,e){let i=(e||"").split(",");ba(t).forEach((t=>{let e=Ta(t);e&&(i.length?i.forEach((t=>e.remove(t))):e.kill(1))}))}static isTracking(t,e){let i=Ta(t);return i&&i.isTracking(e)}static getVelocity(t,e){let i=Ta(t);return i&&i.isTracking(e)?i.get(e):void 0}}La.getByTarget=Ta,Za()&&fa.registerPlugin(La);let Oa,Aa,qa,za,Ga,ja,Wa,Va,Ra,Ha,Na,Ja,Ya=La.getByTarget,Qa=()=>Oa||"undefined"!=typeof window&&(Oa=window.gsap)&&Oa.registerPlugin&&Oa,Ka=t=>"number"==typeof t,Xa=t=>"object"==typeof t,$a=t=>"function"==typeof t,tr=Array.isArray,er=t=>t,ir=1e10,sr=(t,e,i)=>{for(let s in e)s in t||s===i||(t[s]=e[s]);return t},or=t=>{let e,i,s={};for(e in t)s[e]=Xa(i=t[e])&&!tr(i)?or(i):i;return s},nr=(t,e,i,s,o)=>{let n,a,r,h,l=e.length,d=0,c=ir;if(Xa(t)){for(;l--;){for(r in n=e[l],a=0,t)h=n[r]-t[r],a+=h*h;a<c&&(d=l,c=a)}if((o||ir)<ir&&o<Math.sqrt(c))return t}else for(;l--;)n=e[l],a=n-t,a<0&&(a=-a),a<c&&n>=s&&n<=i&&(d=l,c=a);return e[d]},ar=(t,e,i,s,o,n,a)=>{if("auto"===t.end)return t;let r,h,l=t.end;if(i=isNaN(i)?ir:i,s=isNaN(s)?-ir:s,Xa(e)){if(r=e.calculated?e:($a(l)?l(e,a):nr(e,l,i,s,n))||e,!e.calculated){for(h in r)e[h]=r[h];e.calculated=!0}r=r[o]}else r=$a(l)?l(e,a):tr(l)?nr(e,l,i,s,n):parseFloat(l);return r>i?r=i:r<s&&(r=s),{max:r,min:r,unitFactor:t.unitFactor}},rr=(t,e,i)=>isNaN(t[e])?i:+t[e],hr=(t,e)=>.05*e*t/Ha,lr=(t,e,i)=>Math.abs((e-t)*Ha/i/.05),dr={resistance:1,checkpoint:1,preventOvershoot:1,linkedProps:1,radius:1,duration:1},cr=(t,e,i,s)=>{if(e.linkedProps){let o,n,a,r,h,l,d=e.linkedProps.split(","),c={};for(o=0;o<d.length;o++)n=d[o],a=e[n],a&&(Ka(a.velocity)?r=a.velocity:(h=h||Ya(t),r=h&&h.isTracking(n)?h.get(n):0),l=Math.abs(r/rr(a,"resistance",s)),c[n]=parseFloat(i(t,n))+hr(r,l));return c}},ur=()=>{Oa=Qa(),Oa&&(qa=Oa.parseEase,za=Oa.utils.toArray,Wa=Oa.utils.getUnit,Ra=Oa.core.getCache,Na=Oa.utils.clamp,Ga=qa("power3"),Ha=Ga(.05),Va=Oa.core.PropTween,Oa.config({resistance:100,unitFactors:{time:1e3,totalTime:1e3,progress:1e3,totalProgress:1e3}}),ja=Oa.config(),Oa.registerPlugin(La),Aa=1)};const pr={version:"3.10.4",name:"inertia",register(t){Oa=t,ur()},init(t,e,i,s,o){Aa||ur();let n=Ya(t);if("auto"===e){if(!n)return;e=n.getAll()}this.target=t,this.tween=i,Ja=e;let a,r,h,l,d,c,u,p,_,g=t._gsap,m=g.get,y=e.duration,v=Xa(y),f=e.preventOvershoot||v&&0===y.overshoot,w=rr(e,"resistance",ja.resistance),b=Ka(y)?y:function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if("string"==typeof t&&(t=za(t)[0]),!t)return 0;let a,r,h,l,d,c,u,p,_,g,m=0,y=ir,v=e.inertia||e,f=Ra(t).get,w=rr(v,"resistance",ja.resistance);for(a in g=cr(t,v,f,w),v)dr[a]||(r=v[a],Xa(r)||(p=p||Ya(t),p&&p.isTracking(a)?r=Ka(r)?{velocity:r}:{velocity:p.get(a)}:(l=+r||0,h=Math.abs(l/w))),Xa(r)&&(Ka(r.velocity)?l=r.velocity:(p=p||Ya(t),l=p&&p.isTracking(a)?p.get(a):0),h=Na(s,i,Math.abs(l/rr(r,"resistance",w))),d=parseFloat(f(t,a))||0,c=d+hr(l,h),"end"in r&&(r=ar(r,g&&a in g?g:c,r.max,r.min,a,v.radius,l),n&&(Ja===e&&(Ja=v=or(e)),v[a]=sr(r,v[a],"end"))),"max"in r&&c>+r.max+1e-10?(_=r.unitFactor||ja.unitFactors[a]||1,u=d>r.max&&r.min!==r.max||l*_>-15&&l*_<45?s+.1*(i-s):lr(d,r.max,l),u+o<y&&(y=u+o)):"min"in r&&c<+r.min-1e-10&&(_=r.unitFactor||ja.unitFactors[a]||1,u=d<r.min&&r.min!==r.max||l*_>-45&&l*_<15?s+.1*(i-s):lr(d,r.min,l),u+o<y&&(y=u+o)),u>m&&(m=u)),h>m&&(m=h));return m>y&&(m=y),m>i?i:m<s?s:m}(t,e,v&&y.max||10,v&&y.min||.2,v&&"overshoot"in y?+y.overshoot:f?0:1,!0);for(a in e=Ja,Ja=0,_=cr(t,e,m,w),e)dr[a]||(r=e[a],$a(r)&&(r=r(s,t,o)),Ka(r)?d=r:Xa(r)&&!isNaN(r.velocity)?d=+r.velocity:n&&n.isTracking(a)&&(d=n.get(a)),c=hr(d,b),p=0,h=m(t,a),l=Wa(h),h=parseFloat(h),Xa(r)&&(u=h+c,"end"in r&&(r=ar(r,_&&a in _?_:u,r.max,r.min,a,e.radius,d)),"max"in r&&+r.max<u?f||r.preventOvershoot?c=r.max-h:p=r.max-h-c:"min"in r&&+r.min>u&&(f||r.preventOvershoot?c=r.min-h:p=r.min-h-c)),this._props.push(a),this._pt=new Va(this._pt,t,a,h,0,er,0,g.set(t,a,this)),this._pt.u=l||0,this._pt.c1=c,this._pt.c2=p);return i.duration(b)},render(t,e){let i=e._pt;for(t=Ga(e.tween._time/e.tween._dur);i;)i.set(i.t,i.p,(s=i.s+i.c1*t+i.c2*t*t,Math.round(1e4*s)/1e4+i.u),i.d,t),i=i._next;var s}};"track,untrack,isTracking,getVelocity,getByTarget".split(",").forEach((t=>pr[t]=La[t])),Qa()&&Oa.registerPlugin(pr);var _r=pr;class gr{getText(t,e,i){let s;switch(t){case"superhero":s=i?_s.get("Complete N/M levels",{count:"".concat(e.completedLevels,"/",1)}):_s.get(cs.unlocked);break;case"unicorn":s=i?_s.get(cs["Complete N/M levels"],{count:"".concat(e.completedLevels,"/",3)}):_s.get(cs.unlocked);break;default:s=_s.get(i?cs.locked:cs.unlocked)}return s}}class mr extends Zi.W20{constructor(t,e){super(),(0,st.Z)(this,"_internalBounds",void 0),(0,st.Z)(this,"_closeButton",void 0),(0,st.Z)(this,"_skinButtons",[]),(0,st.Z)(this,"_interaction",void 0),(0,st.Z)(this,"_interactionData",void 0),(0,st.Z)(this,"_dragging",!1),(0,st.Z)(this,"_moveThresholdExceed",!1),(0,st.Z)(this,"_lastDragPosition",void 0),(0,st.Z)(this,"_velocityTracker",void 0),(0,st.Z)(this,"_interactedButton",void 0),(0,st.Z)(this,"_maxScrollX",void 0),(0,st.Z)(this,"_minScrollX",void 0),(0,st.Z)(this,"_buttonsContainer",void 0),(0,st.Z)(this,"_app",void 0),(0,st.Z)(this,"_statusTextFactory",void 0),this._scrollArea=t,this._model=e,this._app=Ct(),this._statusTextFactory=new gr,this._build()}get interaction(){return this._interaction}get closeButton(){return this._closeButton}getBounds(){return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((e=>Ct().delay({delay:t,callback:e})))}(0).then((()=>{const{width:t}=this._buttonsContainer.getBounds();this._maxScrollX=this._scrollArea.x,this._minScrollX=this._maxScrollX-(t/this._app.viewScale-this._scrollArea.width)})),this._internalBounds.getBounds()}updateSkinButtons(){const{statistics:t,skinSet:e}=Yt;this._skinButtons.forEach((i=>{const{skin:s,locked:o}=e.getSkinByUuid(i.uuid);i.enable(!o),i.updateTag(this._statusTextFactory.getText(s,t,o))}))}_build(){this._buildButtons(),this._buildBounds(),this._buildInteraction(),this._buildCloseButton()}_buildButtons(){this._buttonsContainer=new Zi.W20,this._model.skins.forEach(((t,e)=>{const{skin:i,locked:s,uuid:o}=t,n=this._statusTextFactory.getText(i,Yt.statistics,s),a=new na(new aa(((t,e)=>{return{input:{enable:!1},bg:Oi,iconBg:Ei,icon:(i=t,{texture:Pi["icon-skin-".concat(i)],position:{x:0,y:24},anchor:{x:.5,y:1}}),name:ms(t),tag:ys(e),textures:{up:{bg:{texture:Pi["button-shop"]},iconBg:{texture:Pi["bg-shop-blue"]},name:{tint:16777215,offset:{x:0,y:0}},tag:{tint:16777215,offset:{x:0,y:0}}},down:{bg:{texture:Pi["button-shop-pressed"]},iconBg:{texture:Pi["bg-shop-blue-dark"]},name:{tint:16777215,offset:{x:0,y:0}},tag:{tint:16777215,offset:{x:0,y:0}}},disable:{bg:{texture:Pi["button-shop-pressed"]},iconBg:{texture:Pi["bg-shop-blue-dark"]},name:{tint:16777215,offset:{x:0,y:0}},tag:{tint:16777215,offset:{x:0,y:0}}}}};var i})(i,n)),o);a.setUserDate(i),a.on("interaction",this._onButtonClick,this),a.enable(!s),a.x+=a.width/2+e*(a.width+mr._gap),this._buttonsContainer.addChild(a),this._skinButtons.push(a)})),this.addChild(this._buttonsContainer)}_buildBounds(){const{width:t,height:e}=Zi.xEZ.WHITE,i=this._skinButtons[0],{width:s,height:o}=i.getBounds();this._internalBounds=Cs({texture:Zi.xEZ.WHITE,scale:{x:s/t,y:o/e},position:{x:i.x,y:i.y}}),this._internalBounds.renderable=!1,this.addChild(this._internalBounds)}_buildInteraction(){this._interaction=Cs({texture:Zi.xEZ.WHITE}),this._interaction.renderable=!1,this._interaction.interactive=!0,this._interaction.on("pointerdown",this._onDown,this)}_buildCloseButton(){this._closeButton=new Is(new Ls({input:{enable:!0},texture:$i,textures:{up:{texture:Pi["button-close"]},down:{texture:Pi["button-close-pressed"]}}})),this._closeButton.on("interaction",this._onCloseButtonInteraction,this)}_onButtonClick(t){this.emit("interaction",t)}_onDown(t){var e;this._velocityTracker=_r.track(this,"x")[0],this._interactionData=t.data,this._dragging=!0,this._lastDragPosition=this._interactionData.getLocalPosition(this._interaction.parent),this._addAuxiliaryListeners(),xi.ZP.killTweensOf(this),this._interactedButton=this._findInteractedButton(this._lastDragPosition),null===(e=this._interactedButton)||void 0===e||e.down()}_findInteractedButton(t){let{x:e,y:i}=t;const{viewScale:s}=this._app;return e*=s,i*=s,this._skinButtons.find((t=>{const s=t.getBounds();return t.interactive&&s.contains(e,i)}))}_onUp(t){this._interactionData=null,this._dragging=!1;const e=this._velocityTracker.get("x");var i;(_r.untrack(this),this._velocityTracker=null,this._moveThresholdExceed)?(xi.ZP.to(this,{inertia:{x:{velocity:e/devicePixelRatio,min:this._minScrollX,max:this._maxScrollX},resistance:1e3*devicePixelRatio}}),this._moveThresholdExceed=!1):null===(i=this._interactedButton)||void 0===i||i.up();this._removeAuxiliaryListeners()}_onMove(t){if(!this._dragging)return;const e=this._interactionData.getLocalPosition(this._interaction.parent),i=e.x-this._lastDragPosition.x;if(Math.abs(i)>mr._moveThreshold){var s;null===(s=this._interactedButton)||void 0===s||s.up(),this._interactedButton=null,this._moveThresholdExceed=!0;const t=this.x+i;t>this._maxScrollX?this.x=this._maxScrollX:t<this._minScrollX?this.x=this._minScrollX:this.x=t}this._lastDragPosition=e}_addAuxiliaryListeners(){this._interaction.on("pointerup",this._onUp,this),this._interaction.on("pointerupoutside",this._onUp,this),this._interaction.on("pointermove",this._onMove,this)}_removeAuxiliaryListeners(){this._interaction.off("pointerup",this._onUp,this),this._interaction.off("pointerupoutside",this._onUp,this),this._interaction.off("pointermove",this._onMove,this)}_onCloseButtonInteraction(){this.emit("close")}}(0,st.Z)(mr,"_gap",28),(0,st.Z)(mr,"_moveThreshold",2);class yr extends ks.D3{constructor(){super(),(0,st.Z)(this,"_buttonPlay",void 0),(0,st.Z)(this,"_buttonSettings",void 0),(0,st.Z)(this,"_buttonSkins",void 0),(0,st.Z)(this,"_buttonBack",void 0),(0,st.Z)(this,"_crusherPropertiesShopView",void 0),(0,st.Z)(this,"_skinsView",void 0),(0,st.Z)(this,"_fog",void 0),(0,st.Z)(this,"_moneyIndicator",void 0),(0,st.Z)(this,"_progress",void 0),(0,st.Z)(this,"_fuelIndicator",void 0),(0,st.Z)(this,"_popup",void 0),s.q.event.on(y.stateUpdate,this._onGameStateUpdate,this).on(a.fuelUpdate,this._onFuelUpdate,this).on(a.configUpdate,this._onCrusherUpdate,this).on(a.stateUpdate,this._onCrusherStateUpdate,this).on(S.moneyUpdate,this._onUserMoneyUpdate,this).on(r.progressUpdate,this._onLevelProgressUpdate,this).on(M.crusherPropertiesShopModelUpdate,this._onCrusherPropertiesShopUpdate,this).on(Z.loadComplete,this._onAppLoadComplete,this),this._build()}getGridConfig(){return Rn.getGridConfig(Wn.ui)}_onGameStateUpdate(t){switch(t){case Y.idle:this._switchToBasics();break;case Y.shopSkins:this._switchToSkins();break;case Y.play:this._switchToPlay()}}_onAppLoadComplete(t){if("extra"===t){this._buttonSkins=new va,this._buttonSkins.on("interaction",this._onSkinsButtonInteraction,this);const{game:t}=Yt,{state:e}=t;e===Y.idle&&this.setChild("skins",this._buttonSkins);const{area:i}=this.getCellByName("shop");this._skinsView=new mr(i,Yt.skinSet),this._skinsView.on("interaction",this._onSkinsViewInteraction,this),this._skinsView.on("close",this._onSkinsClose,this)}}_onCrusherPropertiesShopUpdate(){this._crusherPropertiesShopView=new ha,this._crusherPropertiesShopView.on("interaction",this._onPropertiesShopInteraction,this)}_onFuelUpdate(){const{fuelRemaining:t}=Yt.game.crusher;this._fuelIndicator.setFuel(t)}_onCrusherUpdate(){this._onFuelUpdate()}_onLevelProgressUpdate(t){this._progress.setProgress(t)}_onUserMoneyUpdate(t){this._moneyIndicator.setMoney(t)}_userLevelUpdate(){const{level:t}=Yt.user;this._progress.setLevel(t)}_onCrusherStateUpdate(t){switch(t){case it.warning:this._fuelIndicator.alarm();break;case it.idle:case it.outOfFuel:this._fuelIndicator.calm()}}_build(){const{money:t,level:e}=Yt.user;this._fog=Ms(qi),this._buttonPlay=new Is(new Es({input:{enable:!0},bg:Fi,label:{text:_s.get(cs.play),style:{fontName:ds.AeroMaticsDisplayGreenBlueShadow,fontSize:58},position:{x:0,y:-10},buttonFit:{x:.85,y:1}},textures:{up:{bg:{texture:Pi.button},label:{tint:16777215,offset:{x:0,y:0}}},down:{bg:{texture:Pi["button-pressed"]},label:{tint:16777215,offset:{x:0,y:0}}}}})),this._buttonPlay.on("interaction",this._onPlayButtonInteraction,this),this._buttonSettings=new Is(new Ls({input:{enable:!0},texture:Xi,textures:{up:{texture:Pi.gear},down:{texture:Pi["gear-pressed"]}}})),this._buttonSettings.on("interaction",this._onSettingsButtonInteraction,this),this.setChild("settings",this._buttonSettings),this._progress=new ca,this._progress.setLevel(e),this._fuelIndicator=new da,this._onFuelUpdate(),this.setChild("fuel",this._fuelIndicator),this._moneyIndicator=new ua,this._moneyIndicator.setMoney(t),this.setChild("money",this._moneyIndicator),this._buttonBack=new Is(new Es({input:{enable:!0},bg:Di,label:{text:_s.get(cs.back),style:{fontName:ds.AeroMaticsDisplayGreenBlueShadow,fontSize:58},position:{x:-50,y:-10},anchor:{x:1,y:.5},buttonFit:{x:.51,y:1}},textures:{up:{bg:{texture:Pi.button},label:{tint:16777215,offset:{x:0,y:0}}},down:{bg:{texture:Pi["button-pressed"]},label:{tint:16777215,offset:{x:0,y:0}}}}})),this._buttonBack.on("interaction",this._onBackButtonInteraction,this),this._popup=new ya,this._popup.on(ya.activePopupInit,this._rebuildPopup,this),this.setChild("popup",this._popup)}_rebuildPopup(){this.rebuildChild(this._popup)}_switchToBasics(){var t;this._showBasics(),this._hideBackButton(),this._hideLevelProgress(),this._hideSkins(),null===(t=this._buttonSkins)||void 0===t||t.close()}_switchToSkins(){this._buttonSkins.open(),this._showSkins(),this._hideProperties()}_switchToPlay(){var t;this._showBackButton(),this._showLevelProgress(),this._hideBasics(),this._hideSkins(),this._userLevelUpdate(),null===(t=this._buttonSkins)||void 0===t||t.close()}_showBasics(){this.setChild("fog",this._fog),this.setChild("play",this._buttonPlay),this._buttonSkins&&this.setChild("skins",this._buttonSkins),this.setChild("property",this._crusherPropertiesShopView)}_hideBasics(){this.removeContent(this._buttonPlay),this.removeChild(this._buttonPlay),this.removeContent(this._buttonSkins),this.removeChild(this._buttonSkins),this.removeContent(this._crusherPropertiesShopView),this.removeChild(this._crusherPropertiesShopView),this.removeContent(this._fog),this.removeChild(this._fog)}_showLevelProgress(){this.setChild("progress",this._progress)}_hideLevelProgress(){this.removeContent(this._progress),this.removeChild(this._progress)}_hideBackButton(){this.removeContent(this._buttonBack),this.removeChild(this._buttonBack)}_showBackButton(){this.setChild("back",this._buttonBack)}_hideSkins(){this._skinsView&&(this.removeContent(this._skinsView),this.removeChild(this._skinsView),this.removeContent(this._skinsView.interaction),this.removeChild(this._skinsView.interaction),this.removeContent(this._skinsView.closeButton),this.removeChild(this._skinsView.closeButton))}_showSkins(){this._skinsView&&(this._skinsView.updateSkinButtons(),this.setChild("shop",this._skinsView),this.setChild("shop-close",this._skinsView.closeButton),this.setChild("shop-interaction",this._skinsView.interaction))}_hideProperties(){this.removeContent(this._crusherPropertiesShopView),this.removeChild(this._crusherPropertiesShopView)}_onSettingsButtonInteraction(){s.q.event.emit(U.settingsButtonClick)}_onSkipButtonInteraction(){s.q.event.emit(U.skipButtonClick)}_onBackButtonInteraction(){s.q.event.emit(U.backButtonClick)}_onPlayButtonInteraction(){s.q.event.emit(U.playButtonClick)}_onSkinsButtonInteraction(){s.q.event.emit(U.skinsButtonClick)}_onSkinsViewInteraction(t){s.q.event.emit(U.skinsShopButtonClick,t)}_onSkinsClose(){s.q.event.emit(U.skinsCloseButtonClick)}_onPropertiesShopInteraction(t){s.q.event.emit(U.propertiesShopButtonClick,t)}}class vr extends Zi.W20{constructor(){super(),(0,st.Z)(this,"_game",void 0),(0,st.Z)(this,"_ui",void 0),(0,st.Z)(this,"resize",(()=>{var t,e;null===(t=this._ui)||void 0===t||t.rebuild(this._ui.getGridConfig()),null===(e=this._game)||void 0===e||e.rebuild(this._game.getGridConfig())})),(0,st.Z)(this,"update",((t,e)=>{var i;null===(i=this._game)||void 0===i||i.update(t,e)})),s.q.event.on(C.gameUpdate,this._onGameUpdate,this),s.q.event.on(C.uiUpdate,this._onUIUpdate,this)}_onGameUpdate(){this._game=new sa,this.addChild(this._game)}_onUIUpdate(){this._ui=new yr,this.addChild(this._ui)}}class fr{constructor(t){(0,st.Z)(this,"name","pixi"),(0,st.Z)(this,"stage",void 0),(0,st.Z)(this,"ticker",void 0),(0,st.Z)(this,"renderer",void 0),(0,st.Z)(this,"_loader",void 0),(0,st.Z)(this,"onPause",(()=>{Rn.onPause()})),(0,st.Z)(this,"onResume",(()=>{Rn.onResume()})),(0,st.Z)(this,"update",((t,e)=>{this.renderer.reset(),this.stage.update(t,e),this.ticker.update(t),this.renderer.render(this.stage),this.renderer.reset()})),this.renderer=new Zi.Thl(function(t){const e=window.globals.app.getRuntime("three");return{view:t,context:null==e?void 0:e.renderer.getContext(),resolution:di(),backgroundAlpha:0,backgroundColor:0,clearBeforeRender:!e}}(t)),this._loader=new $n,this.stage=new vr,this.ticker=Zi.vB5.shared,Zi.vB5.shared.autoStart=!1}get loader(){return this._loader}onInstall(t,e,i){Rn.init(),this.onResize(t,e,i)}onResize(t,e,i){Rn.onResize(t);const s=Math.min(1,e);this.renderer.resize(i.width*s,i.height*s),this.stage.scale.set(s),this.stage.resize()}}i(1131);i(8492);class wr extends he.cPb{}const br={boxSize:8,holePosition:-3.5,holeSize:1,holeBoxIndex:9,grassThickness:1,width:24,height:6,cesspool:{width:3,height:3},threshold:{left:.225,right:.026}};let kr,xr;!function(t){t.wall="wall",t.hole="hole",t.threshold="threshold",t.crusherHead="crusher-head"}(kr||(kr={})),function(t){t[t.none=0]="none",t[t.crusherHead=1]="crusherHead",t[t.crusherHeadSensor=2]="crusherHeadSensor",t[t.brick=4]="brick",t[t.brickStatic=8]="brickStatic",t[t.ground=16]="ground",t[t.collectorGate=32]="collectorGate",t[t.cesspool=64]="cesspool",t[t.coin=128]="coin"}(xr||(xr={}));const Cr=t=>{const{b2Vec2:e}=bt;return new e(t.get_x(),t.get_y())},Br=(t,e)=>new bt.b2Vec2(t,e),Mr=t=>{const{_malloc:e,b2Vec2:i,b2PolygonShape:s,HEAPF32:o,wrapPointer:n}=bt,a=new s,r=e(8*t.length);let h=0;for(let e=0;e<t.length;e++)o[r+h>>2]=t[e].get_x(),o[r+(h+4)>>2]=t[e].get_y(),h+=8;const l=n(r,i);return a.Set(l,t.length),a},Sr=(t,e,i)=>{const s=new bt.b2RevoluteJointDef;return s.Initialize(t,e,i),Ct().physics2dWorld.CreateJoint(s)};function Zr(t){const{bodyDef:e,fixturesDefs:i,userData:s,filters:o}=t,n=new bt.b2BodyDef;Object.keys(e).forEach((t=>{const i="set_".concat(t);n[i](e[t])}));const a=Ct().physics2dWorld.CreateBody(n);return a.__userData__=s,i.forEach(((t,e)=>{const i=new bt.b2FixtureDef;Object.keys(t).forEach((e=>{const s="set_".concat(e);i[s](t[e])})),o&&i.set_filter(o[e]),a.CreateFixture(i)})),a}function Pr(t){return t*z}function Ur(t){return t*t*t*z}function Tr(t,e){return t*t*z/e}const Fr=Pr,Dr=Pr,Ir=Pr,Er=Pr,Lr=Ur,Or=Ur,Ar=(t,e,i,s,o)=>{const{b2PolygonShape:n}=bt,a=e,r=new n;return r.SetAsBox(a/2,100),{userData:{id:t,target:s,group:kr.threshold},bodyDef:{type:bt.b2_staticBody,position:Br(i.x,i.y-100)},filters:o,fixturesDefs:[{shape:r,isSensor:!0}]}};var qr=i(2644);i(2994),i(1382),i(8857),i(5688),i(315);const zr=(()=>{const t=new he.Pa4,e=new he._fP,i=new he.Pa4;return function(s){s.compose(t,e,i)}})(),Gr=(()=>{const t=new he.Pa4,e=new he._fP,i=new he.Pa4(1,1,1);return function(s){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0;e.setFromEuler(new he.USm(d,c,u)),i.set(r,h,l),t.set(o,n,a),s.compose(t,e,i)}})(),jr=(()=>{const t=new he.Ilk;return function(e,i){const s=e.getAttribute("position").array.length,o=new Float32Array(s),n=t.set(i);for(let t=0;t<o.length;t+=3)o[t]=n.getRGB(n).r,o[t+1]=n.getRGB(n).g,o[t+2]=n.getRGB(n).b;return e.setAttribute("color",new he.TlE(o,3)),e}})();const Wr=new class{constructor(){(0,st.Z)(this,"_skyGeometry",new he._12(1,1)),(0,st.Z)(this,"_groundBoxGeometry",new he.nvb(br.boxSize,br.boxSize,br.boxSize)),(0,st.Z)(this,"_brickGeometry",new he.nvb(1,1,1)),(0,st.Z)(this,"_collectorRoofBoundingBox",void 0),(0,st.Z)(this,"_collectorFrontWallBoundingBox",void 0),(0,st.Z)(this,"_collectorPlatformBoundingBox",void 0),(0,st.Z)(this,"_collectorLeftWallBoundingBox",void 0),(0,st.Z)(this,"_collectorTopGeometry",void 0),(0,st.Z)(this,"_collectorFoundationGeometry",void 0),(0,st.Z)(this,"_propagatorTubeGeometry",new he.fHI(1,1,1,14,1)),(0,st.Z)(this,"_gasCanGeometry",void 0),(0,st.Z)(this,"_coinGeometry",new he.BVQ(1,0,5,20)),(0,st.Z)(this,"_dummyMatrix",new he.yGw)}getSkyGeometry(t,e){return Gr(this._dummyMatrix,0,0,0,t,e),this._skyGeometry.applyMatrix4(this._dummyMatrix),zr(this._dummyMatrix),this._skyGeometry}getGroundBoxGeometry(){return this._groundBoxGeometry}getBrickGeometry(t){return Gr(this._dummyMatrix,0,0,0,t,t,t),this._brickGeometry.applyMatrix4(this._dummyMatrix),zr(this._dummyMatrix),this._brickGeometry}getPropagatorTubeGeometry(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=this._propagatorTubeGeometry.clone();return Gr(this._dummyMatrix,-14.289+t,1.73+e,.53,2.25,4.42,2.25),i.applyMatrix4(this._dummyMatrix),zr(this._dummyMatrix),i}getCollectorTopGeometry(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this._collectorTopGeometry)return this._collectorTopGeometry;const i=new he.DvJ(1,1,1),s=new he.DvJ(1,1,1),o=new he.DvJ(1,1,1);return Gr(this._dummyMatrix,-5.3+t,15+e,.15,14.85,1.25,6.83),i.applyMatrix4(this._dummyMatrix),i.computeBoundingBox(),this._collectorRoofBoundingBox=i.boundingBox,zr(this._dummyMatrix),Gr(this._dummyMatrix,-5.4+t,12+e,-5.28,14.97,13.6,6.53),s.applyMatrix4(this._dummyMatrix),zr(this._dummyMatrix),Gr(this._dummyMatrix,-9.35+t,10.42+e,3.83,6.45,10,.885),o.applyMatrix4(this._dummyMatrix),o.computeBoundingBox(),this._collectorFrontWallBoundingBox=o.boundingBox,zr(this._dummyMatrix),this._collectorTopGeometry=(0,qr.qf)([i,s,o]),this._collectorTopGeometry}getCollectorFoundationGeometry(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this._collectorFoundationGeometry)return this._collectorFoundationGeometry;const i=new he.DvJ(1,1,1),s=new he.DvJ(1,1,1),o=new he.DvJ(1,1,1);return Gr(this._dummyMatrix,-5.179+t,5.05+e,.15,14.558,1.37,6.83),i.applyMatrix4(this._dummyMatrix),i.computeBoundingBox(),this._collectorPlatformBoundingBox=i.boundingBox,zr(this._dummyMatrix),Gr(this._dummyMatrix,4.05+t,4.27+e,.151,4.635,1.5,6.83,0,0,(0,ta.Id)(-18.889)),s.applyMatrix4(this._dummyMatrix),zr(this._dummyMatrix),Gr(this._dummyMatrix,-14.18+t,8+e,.151,7.97,11.611,6.83),o.applyMatrix4(this._dummyMatrix),o.computeBoundingBox(),this._collectorLeftWallBoundingBox=o.boundingBox,zr(this._dummyMatrix),this._collectorFoundationGeometry=(0,qr.qf)([i,s,o]),this._collectorFoundationGeometry}getGasCanGeometry(t){if(this._gasCanGeometry)return this._gasCanGeometry;const{blackBandageHeight:e,cylinderHeight:i,sphereRadius:s}=t,o=new he.fHI(1,1,1,14,1),n=new he.fHI(1,1,1,14,1),a=new he.fHI(1,1,1,14,1),r=new he.xo$(1,32,8,0,2*Math.PI,.3,Math.PI/2-.3);return jr(o,16711725),jr(n,2500134),jr(a,2500134),jr(r,16711725),Gr(this._dummyMatrix,0,i/2,0,3.5,i,3.5),o.applyMatrix4(this._dummyMatrix),zr(this._dummyMatrix),Gr(this._dummyMatrix,0,i+e/2,0,3.6,e,3.6),n.applyMatrix4(this._dummyMatrix),zr(this._dummyMatrix),Gr(this._dummyMatrix,0,i+e+s+.2,0,1,.7,1),a.applyMatrix4(this._dummyMatrix),zr(this._dummyMatrix),Gr(this._dummyMatrix,0,i+e,0,s,s,s),r.applyMatrix4(this._dummyMatrix),zr(this._dummyMatrix),this._gasCanGeometry=(0,qr.qf)([o,n,a,r]),this._gasCanGeometry}getCollectorRoofBoundingBox(){return this._collectorRoofBoundingBox}getCollectorFrontWallBoundingBox(){return this._collectorFrontWallBoundingBox}getCollectorPlatformBoundingBox(){return this._collectorPlatformBoundingBox}getCollectorLeftWallBoundingBox(){return this._collectorLeftWallBoundingBox}getCoinGeometry(){return this._coinGeometry}getJointGeometry(t,e,i,s,o,n){const a=new he.fHI(1,1,1,15,1),r=new he.fHI(1,1,1,15,1);jr(a,o),Gr(this._dummyMatrix,0,0,0,t,i,t,Math.PI/2,0,0),a.applyMatrix4(this._dummyMatrix),zr(this._dummyMatrix),jr(r,n),Gr(this._dummyMatrix,0,0,i/2+s/2,e,s,e,Math.PI/2,0,0),r.applyMatrix4(this._dummyMatrix),zr(this._dummyMatrix);return(0,qr.qf)([a,r])}getJointPinGeometry(t,e){return new he.fHI(t,t,e,15,1)}};class Vr{constructor(t){(0,st.Z)(this,"_groundBody",void 0),(0,st.Z)(this,"_cesspoolBody",void 0),(0,st.Z)(this,"_leftThresholdBody",void 0),(0,st.Z)(this,"_rightThresholdBody",void 0),(0,st.Z)(this,"_groundGroup",void 0),this._parent=t,this._createMesh(),this._createBody()}destroy(){}_createBody(){const{threshold:t,holePosition:e,holeSize:i,width:s,grassThickness:o,boxSize:n,holeBoxIndex:a,cesspool:{width:r,height:h}}=br,{left:l,right:d}=t,c=(-a+e)*n-n/2,u=s*n;this._groundBody=Zr(((t,e,i,s,o)=>{const{b2PolygonShape:n}=bt,a=new n;return a.SetAsBox(e/2,.5),(new n).SetAsBox(.5,.5),{userData:{id:t,target:s},bodyDef:{type:bt.b2_staticBody,position:Br(i.x+e/2,i.y+.5)},filters:o,fixturesDefs:[{shape:a,friction:.4,restitution:0}]}})("ground",u,{x:c,y:0},null,Vr.groundBodyFilters)),this._cesspoolBody=Zr(((t,e,i,s,o,n,a,r)=>{const h=Mr([Br(0,0),Br(0,i+s),Br(-2,i+s),Br(-2,0)]),l=Mr([Br(o,0),Br(o,s),Br(o+e-o,s),Br(o+e-o,0)]),d=Mr([Br(0,i+s),Br(e,i+s),Br(e,i+s+2),Br(0,i+s+2)]),c=Mr([Br(e,s),Br(e,i+s),Br(e+2,i+s),Br(e+2,s)]),u=Mr([Br(0,0),Br(o,0),Br(o,-1),Br(0,-1)]);return{userData:{id:t,target:a},bodyDef:{type:bt.b2_staticBody,position:Br(n.x,n.y)},filters:r,fixturesDefs:[{shape:h,friction:.4,restitution:0},{shape:l,friction:.4,restitution:0},{shape:d,friction:.4,restitution:0},{shape:c,friction:.4,restitution:0},{shape:u,friction:.4,restitution:0}]}})("cesspool",r*n,h*n,o*n,i*n,{x:(e-i/2)*n,y:0},null,Vr.cesspoolBodyFilters)),this._leftThresholdBody=Zr(Ar("threshold_l",1,{x:c+u*l,y:0},null,Vr.thresholdBodyFilters)),this._rightThresholdBody=Zr(Ar("threshold_r",1,{x:c+u-u*d,y:0},null,Vr.thresholdBodyFilters))}_createMesh(){this._createWrapperGroup(),this._createGrass(),this._createSand()}_createWrapperGroup(){const{boxSize:t,holeBoxIndex:e,holePosition:i}=br,s=t/2,o=new he.ZAu;o.position.set((-e+i)*t,-s,0),this._parent.add(this._groundGroup=o)}_createGrass(){const{grassThickness:t,width:e,boxSize:i,holeBoxIndex:s,holeSize:o}=br,n=t*e*2,a=new he.SPe(Wr.getGroundBoxGeometry(),Ze.getGrassMaterial(),n);a.receiveShadow=!0,a.castShadow=!0,this._groundGroup.add(a);for(let s=0;s<t;s++)for(let o=0;o<e;o++){const n=s*e+o;Gr(Vr._dummyMatrix,o*i,-s*i,0,1,1,1,0,Math.PI/2*o),a.setMatrixAt(n,Vr._dummyMatrix),zr(Vr._dummyMatrix),Gr(Vr._dummyMatrix,o*i,-s*i,-i),a.setMatrixAt(n+e*t,Vr._dummyMatrix),zr(Vr._dummyMatrix)}for(let t=0;t<o;t++)Gr(Vr._dummyMatrix,0,0,0,0,0,0),a.setMatrixAt(s+t,Vr._dummyMatrix),zr(Vr._dummyMatrix);for(let i=0;i<t;i++)for(let t=s;t<s+o;t++){const s=i*e+t;Gr(Vr._dummyMatrix,0,0,0,0,0,0),a.setMatrixAt(s,Vr._dummyMatrix),zr(Vr._dummyMatrix)}}_createSand(){const{width:t,height:e,cesspool:i,boxSize:s,holeBoxIndex:o,grassThickness:n}=br,{width:a,height:r}=i,h=t*e*2,l=new he.SPe(Wr.getGroundBoxGeometry(),Ze.getSandMaterial(),h);l.position.set(0,-s*n,0),l.receiveShadow=!0,l.castShadow=!0,this._groundGroup.add(l);for(let i=0;i<e;i++)for(let o=0;o<t;o++){const n=i*t+o;Gr(Vr._dummyMatrix,o*s,-i*s,0),l.setMatrixAt(n,Vr._dummyMatrix),zr(Vr._dummyMatrix),Gr(Vr._dummyMatrix,o*s,-i*s,-s),l.setMatrixAt(n+t*e,Vr._dummyMatrix),zr(Vr._dummyMatrix)}const d=o;for(let e=0;e<0+r;e++)for(let i=d;i<d+a;i++){const s=e*t+i;Gr(Vr._dummyMatrix,0,0,0,0,0,0),l.setMatrixAt(s,Vr._dummyMatrix),zr(Vr._dummyMatrix)}}}(0,st.Z)(Vr,"groundBodyFilters",void 0),(0,st.Z)(Vr,"thresholdBodyFilters",void 0),(0,st.Z)(Vr,"cesspoolBodyFilters",void 0),(0,st.Z)(Vr,"_dummyMatrix",new he.yGw);{const{ground:t,brick:e,cesspool:i,coin:s}=xr,o=new bt.b2Filter,n=new bt.b2Filter,a=new bt.b2Filter;o.set_categoryBits(t),a.set_categoryBits(i),n.set_maskBits(e),a.set_maskBits(s),Vr.groundBodyFilters=[o],Vr.thresholdBodyFilters=[n],Vr.cesspoolBodyFilters=[a,a,a,a,a]}class Rr{constructor(t){this._parent=t;const e=Wr.getSkyGeometry(Rr._width,Rr._height),i=new he.Kj0(e,Ze.getSkyMaterial());i.position.set(-13,Rr._height/2,-12),this._parent.add(i)}}(0,st.Z)(Rr,"_width",380),(0,st.Z)(Rr,"_height",140);class Hr{constructor(t){(0,st.Z)(this,"_hand",void 0),this._parent=t;const e=new he.jyi(Ze.getTutorialMaterial());e.position.set(0,0,5),e.scale.set(10,242*.05,1),this._parent.add(this._hand=e),this._hand.visible=!1}destroy(){xi.ZP.killTweensOf(this._hand.position),xi.ZP.killTweensOf(this._hand.material),xi.ZP.killTweensOf(this._hand.scale),this._hand.clear(),this._hand.material.dispose(),this._hand.geometry.dispose(),this._hand.removeFromParent(),this._hand=null}show(){const t=-6,e=40,i=5,{x:s,y:o}=this._hand.scale;xi.ZP.timeline({onComplete:()=>{},onStart:()=>{this._hand.visible=!0,this._hand.material.opacity=0,this._hand.material.rotation=Math.PI/6,this._hand.position.set(t+10,e-17,i)},delay:1,repeatDelay:1,repeat:-1,universal:!0}).add(xi.ZP.to(this._hand.position,{x:t,y:e,duration:.4,ease:Ci.Ll.easeOut}),0).add(xi.ZP.to(this._hand.material,{opacity:1,rotation:0,duration:.4,ease:Ci.Ll.easeOut}),0).add(xi.ZP.to(this._hand.scale,{x:.8*s,y:.8*o,duration:.2,ease:Ci.Yv.easeInOut}),">0").add(xi.ZP.to(this._hand.material,{rotation:"+".concat(Math.PI/18),duration:.2,ease:Ci.Yv.easeInOut}),"<").add(xi.ZP.to(this._hand.position,{x:"+=20",y:"-=10",duration:1,ease:Ci.Yv.easeInOut})).add(xi.ZP.to(this._hand.position,{x:"+=4",y:"-=8",duration:.3,ease:Ci.Ll.easeOut})).add(xi.ZP.to(this._hand.material,{rotation:Math.PI/6,opacity:0,duration:.2,ease:Ci.Ll.easeOut}),"<")}}class Nr extends class{constructor(t){(0,st.Z)(this,"pool",new Map),(0,st.Z)(this,"params",void 0),this.params=t}recycle(){this.pool.forEach((t=>t.forEach((t=>this.params.destructorFn(t))))),this.pool.clear()}reserve(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),s=1;s<e;s++)i[s-1]=arguments[s];const o=this.params.constructorFn(t,i);this.params.resetFn(o),this.placeInPool(t,o)}spawn(t){const e=this.pool.get(t);for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];return null!=e&&e.length?e.pop():this.params.constructorFn(t,s)}despawn(t,e){this.params.resetFn(e),this.placeInPool(t,e)}placeInPool(t,e){this.pool.has(t)?this.pool.get(t).push(e):this.pool.set(t,[e])}}{spawn(t){const e=this.pool.get(t);return null!=e&&e.length?e.pop():null}}const Jr=Object.freeze({[X.coin0]:1.5*.8,[X.coin1]:1.5*.8,[X.coin2]:1.5,[X.coin3]:1.5,[X.coin4]:1.5});class Yr{constructor(t,e,i){this._index=t,this._type=e,this._view=i}sync(t,e){var i;const s=Jr[this._type];Gr(Yr.dummyMatrix,t.x,-t.y,0,s,.3,s,Math.PI/2,Math.PI-e,0),null===(i=this._view)||void 0===i||i.setMatrixAt(this._index,Yr.dummyMatrix),zr(Yr.dummyMatrix)}}(0,st.Z)(Yr,"dummyMatrix",new he.yGw);class Qr{constructor(t,e,i,s){(0,st.Z)(this,"_body",void 0),(0,st.Z)(this,"_emissionTime",void 0),this.index=t,this.uuid=e,this._type=i,this._view=s,this._createBody()}get body(){return this._body}get type(){return this._type}update(t,e){t>=this._emissionTime+Qr.lifeSpan&&s.q.event.emit(D.timeIsUp,this.uuid)}destroy(){this.body.SetEnabled(!1),Ct().physics2dWorld.DestroyBody(this.body)}emit(t,e,i){this._emissionTime=i;const s=Ct();this.body.SetTransform(new bt.b2Vec2(t,e),0),this.body.SetEnabled(!0),s.physics2dSyncManager.syncBodyTarget(this._body)}reset(){this._emissionTime=0,this.setEnabled(!1)}setEnabled(t){this._body.SetEnabled(t),zr(Yr.dummyMatrix),this._view.setMatrixAt(this.index,Yr.dummyMatrix)}_createBody(){this._body=Zr(((t,e,i,s)=>{const{b2CircleShape:o}=bt,n=new o;return n.set_m_radius(e),{userData:{id:t,target:i},bodyDef:{type:bt.b2_dynamicBody,position:Br(0,0),angularDamping:Er(.05),linearDamping:Er(0),bullet:!1},filters:s,fixturesDefs:[{shape:n,friction:.4,restitution:0,density:Tr(1,e*e*Math.PI)}]}})(this.uuid,Jr[this._type],new Yr(this.index,this._type,this._view),Qr.coinBodyFilters)),Ct().physics2dSyncManager.syncBodyTarget(this._body,!0),this.setEnabled(!1)}}(0,st.Z)(Qr,"coinBodyFilters",void 0),(0,st.Z)(Qr,"lifeSpan",2e3);{const{coin:t,cesspool:e}=xr,i=new bt.b2Filter;i.set_categoryBits(t),i.set_maskBits(e|t),Qr.coinBodyFilters=[i]}class Kr{constructor(t,e){(0,st.Z)(this,"_coinsPool",void 0),(0,st.Z)(this,"_spawnedCoins",void 0),(0,st.Z)(this,"_coinsViews",new Map),(0,st.Z)(this,"_constructCoinComponent",((t,e)=>new Qr(e,(0,Bt.Z)("".concat(t,"_")),X[t],this._coinsViews.get(X[t])))),(0,st.Z)(this,"_destructCoinComponent",(t=>{t.destroy()})),(0,st.Z)(this,"_resetCoinComponent",(t=>{t.reset()})),(0,st.Z)(this,"_spawnCoinComponent",((t,e,i)=>{const s=this._coinsPool.spawn(t);return s?(s.emit(e,i,Ct().lastTime),this._spawnedCoins.push(s),s):null})),(0,st.Z)(this,"_despawnCoinComponent",(t=>{t.reset(),this._coinsPool.despawn(t.type,t)})),this._parent=t,this._model=e,this._spawnedCoins=[],this._coinsPool=new Nr({constructorFn:this._constructCoinComponent,destructorFn:this._destructCoinComponent,resetFn:this._resetCoinComponent}),this._createCoinsViews(),this._initCoinsPool(),s.q.event.on(o.propagationUpdate,this._onPropagationUpdate,this).on(D.timeIsUp,this._onCoinTimeIsUp,this)}update(t,e){this._coinsViews.forEach((t=>{t.instanceMatrix.needsUpdate=!0})),this._spawnedCoins.forEach((i=>i.update(t,e)))}destroy(){s.q.event.removeListenersOf(this),this._coinsViews.forEach((t=>{t.clear(),t.removeFromParent()})),this._coinsViews.clear(),this._coinsViews=null,this._destroyCoins(),this._destroyPool()}_onCoinTimeIsUp(t){this._removeCoin(t)}_onPropagationUpdate(t){const{coinType:e}=t,{holePosition:i,boxSize:s}=br,o=i*s,n=(0,Tt.Z)(o-Fr(.2),o+Fr(.2),!0);this._spawnCoinComponent(e,n,5)}_createCoinsViews(){const t=Wr.getCoinGeometry();for(const e in X)if(Object.prototype.hasOwnProperty.call(X,e)){const i=Ze.getCoinMaterial(X[e]),s=new he.SPe(t,i,10);s.castShadow=!0,this._parent.add(s),this._coinsViews.set(X[e],s)}}_initCoinsPool(){for(const t in X)if(Object.prototype.hasOwnProperty.call(X,t)){const e=X[t];for(let t=0;t<10;t++)this._coinsPool.reserve(e,t)}}_removeCoin(t){for(let e=0;e<this._spawnedCoins.length;e++){const i=this._spawnedCoins[e];if(i.uuid===t)return this._spawnedCoins.splice(e,1),this._despawnCoinComponent(i),i}}_destroyCoins(){this._spawnedCoins.forEach((t=>t.destroy())),this._spawnedCoins=null}_destroyPool(){this._coinsPool.recycle(),this._coinsPool=null}_poolUnusedCoins(){}}class Xr{constructor(){(0,st.Z)(this,"level",void 0)}init(t){this.level=t}}class $r extends Xr{constructor(t){super(),(0,st.Z)(this,"_propagator",void 0),this.model=t}init(t){super.init(t),this._createPropagator(),this.update(t)}destroy(){var t;null===(t=this._propagator)||void 0===t||t.destroy(),this._propagator=null}update(t,e,i){var s;null===(s=this._propagator)||void 0===s||s.update(e,i)}_createPropagator(){this._propagator=new Kr(this.level,this.model)}}class th{constructor(t,e){(0,st.Z)(this,"_offsetY",void 0),(0,st.Z)(this,"_offsetX",void 0),(0,st.Z)(this,"_roofBoundingBox",void 0),(0,st.Z)(this,"_frontWallBoundingBox",void 0),(0,st.Z)(this,"_leftWallBoundingBox",void 0),(0,st.Z)(this,"_platformBoundingBox",void 0),(0,st.Z)(this,"_holeBody",void 0),(0,st.Z)(this,"_roofBody",void 0),(0,st.Z)(this,"_gateBody",void 0),(0,st.Z)(this,"_propagatorPartMesh",void 0),(0,st.Z)(this,"_topMesh",void 0),(0,st.Z)(this,"_foundationMesh",void 0),(0,st.Z)(this,"_gasCanMesh",void 0),this._parent=t,this._model=e;const{holePosition:i,boxSize:s}=br,o=i*s;this._offsetX=o+14.2,this._offsetY=-5.39,this._createView(),this._createBody()}destroy(){this._topMesh.clear(),this._topMesh.removeFromParent(),this._foundationMesh.clear(),this._foundationMesh.removeFromParent(),this._propagatorPartMesh.clear(),this._propagatorPartMesh.geometry.dispose(),this._propagatorPartMesh.removeFromParent(),this._gasCanMesh.clear(),this._gasCanMesh.removeFromParent(),this._gateBody.SetEnabled(!1),this._roofBody.SetEnabled(!1),this._holeBody.SetEnabled(!1),Ct().physics2dWorld.DestroyBody(this._gateBody),Ct().physics2dWorld.DestroyBody(this._roofBody),Ct().physics2dWorld.DestroyBody(this._holeBody)}_createView(){this._createTop(),this._createFoundation(),this._createPropagatorPart(),this._createGasCan()}_createTop(){const t=Ze.getCollectorYellowMaterial(),e=Wr.getCollectorTopGeometry(this._offsetX,this._offsetY);this._roofBoundingBox=Wr.getCollectorRoofBoundingBox(),this._frontWallBoundingBox=Wr.getCollectorFrontWallBoundingBox();const i=new he.Kj0(e,t);i.castShadow=!0,i.receiveShadow=!0,this._parent.add(this._topMesh=i)}_createFoundation(){const t=Ze.getCollectorBlueMaterial(),e=Wr.getCollectorFoundationGeometry(this._offsetX,this._offsetY);this._platformBoundingBox=Wr.getCollectorPlatformBoundingBox(),this._leftWallBoundingBox=Wr.getCollectorLeftWallBoundingBox();const i=new he.Kj0(e,t);i.castShadow=!0,i.receiveShadow=!0,this._parent.add(this._foundationMesh=i)}_createPropagatorPart(){const t=Ze.getPropagatorTubeMaterial(),e=Wr.getPropagatorTubeGeometry(this._offsetX,this._offsetY),i=new he.Kj0(e,t);i.castShadow=!0,i.receiveShadow=!0,this._parent.add(this._propagatorPartMesh=i)}_createGasCan(){const t=Ze.getGasCanMaterial(),e=Wr.getGasCanGeometry({blackBandageHeight:.9,cylinderHeight:10.1,sphereRadius:3.4}),i=new he.Kj0(e,t);i.receiveShadow=!0,this._parent.add(this._gasCanMesh=i),i.position.set(this._offsetX-18,this._offsetY+5.05,-7)}_createBody(){this._createHoleBody(),this._createRoofBody(),this._createGateBody()}_createHoleBody(){const{min:t,max:e}=this._frontWallBoundingBox,{x:i,y:s}=t,{x:o,y:n}=e,a=Math.abs(n-s-1),r={x:i+Math.abs(i-o)/2,y:-s};this._holeBody=Zr(((t,e,i,s,o,n)=>{const{b2PolygonShape:a}=bt,r=new a;return r.SetAsBox(e/2,i/2),{userData:{id:t,target:o,group:kr.hole},bodyDef:{type:bt.b2_staticBody,position:Br(s.x,s.y-i/2)},filters:n,fixturesDefs:[{shape:r,isSensor:!0}]}})("hole",1,a,r,null,th.collectorSensorFilters))}_createRoofBody(){this._roofBody=Zr(((t,e,i,s,o,n)=>{const{min:{x:a,y:r},max:{x:h,y:l}}=e,{min:{x:d,y:c},max:{x:u,y:p}}=i,{min:{y:_},max:{x:g,y:m}}=s,y=Mr([Br(g+5,2-m),Br(g,-m),Br(g,-_),Br(u,-_),Br(u,-m)]),v=Mr([Br(u,-c),Br(d,-c),Br(d,-p),Br(u,-p)]),f=Mr([Br(a,-r),Br(a,-l),Br(h,-l),Br(h,-r)]);return{userData:{id:t,target:o},bodyDef:{type:bt.b2_staticBody,position:Br(0,0)},filters:n,fixturesDefs:[{shape:y,friction:.4,restitution:0},{shape:v,friction:.4,restitution:0},{shape:f,friction:.4,restitution:0}]}})("roof",this._roofBoundingBox,this._leftWallBoundingBox,this._platformBoundingBox,null,th.collectorWallsFilters))}_createGateBody(){this._gateBody=Zr(((t,e,i,s,o)=>{const{min:{y:n},max:{x:a}}=e,{max:{x:r,y:h}}=i,l=new bt.b2EdgeShape;return l.SetTwoSided(new bt.b2Vec2(a,-n),new bt.b2Vec2(r,-h)),{userData:{id:t,target:s},bodyDef:{type:bt.b2_staticBody,position:Br(0,0)},filters:o,fixturesDefs:[{shape:l}]}})("roof",this._roofBoundingBox,this._platformBoundingBox,null,th.collectorGateFilters))}}(0,st.Z)(th,"collectorSensorFilters",void 0),(0,st.Z)(th,"collectorGateFilters",void 0),(0,st.Z)(th,"collectorWallsFilters",void 0);{const{ground:t,brick:e,crusherHead:i,collectorGate:s}=xr,o=new bt.b2Filter,n=new bt.b2Filter,a=new bt.b2Filter;a.set_categoryBits(t),n.set_categoryBits(s),o.set_maskBits(e),n.set_maskBits(i),a.set_maskBits(e|i),th.collectorSensorFilters=[o],th.collectorGateFilters=[n],th.collectorWallsFilters=[a,a,a]}class eh extends Xr{constructor(t){super(),(0,st.Z)(this,"_collector",void 0),this.model=t}init(t){super.init(t),this._createCollector(),this.update(t)}destroy(){this._collector.destroy(),this._collector=null}update(t,e,i){}_createCollector(){this._collector=new th(this.level,this.model)}}var ih=i(2228),sh=i(9437);class oh{getGeometry(t,e){let i;switch(e){case J.base:i=this._getBaseGeometry(t);break;case J.simple:i=this._getSimpleGeometry(t);break;case J.head:i=this._getHeadGeometry(t)}return i}_getBaseGeometry(t){const e=.5,i=oh._geometrySample.clone(),s=oh._geometrySample.clone();return Gr(oh._dummyMatrix,-1,t/2,0,e,t,e),i.applyMatrix4(oh._dummyMatrix),zr(oh._dummyMatrix),Gr(oh._dummyMatrix,1,t/2,0,e,t,e),s.applyMatrix4(oh._dummyMatrix),zr(oh._dummyMatrix),(0,qr.qf)([i,s])}_getSimpleGeometry(t){const e=oh._geometrySample.clone();return Gr(oh._dummyMatrix,0,t/2,0,1.2,t,1.2),e.applyMatrix4(oh._dummyMatrix),zr(oh._dummyMatrix),e}_getHeadGeometry(t){const e=.35,i=oh._geometrySample.clone(),s=oh._geometrySample.clone();return Gr(oh._dummyMatrix,0,t/2,-.95-e,e,t,e),i.applyMatrix4(oh._dummyMatrix),zr(oh._dummyMatrix),Gr(oh._dummyMatrix,0,t/2,.95+e,e,t,e),s.applyMatrix4(oh._dummyMatrix),zr(oh._dummyMatrix),(0,qr.qf)([i,s])}}(0,st.Z)(oh,"_geometrySample",new he.fHI(1,1,1,15,1)),(0,st.Z)(oh,"_dummyMatrix",new he.yGw);class nh extends he.Kj0{constructor(t,e){super(),this._config=t,this._skin=e,this._build(),this.castShadow=!0,this.receiveShadow=!0}destroy(){this.clear(),this.geometry.dispose(),this.removeFromParent()}_build(){const{radius1:t,radius2:e,height1:i,height2:s}=this._config,{color1:o,color2:n,material:a}=Le.getJointMaterialConfig(this._skin),r=(s-i)/2;this.geometry=Wr.getJointGeometry(t,e,i,r,o,n),this.material=a}}class ah{constructor(t,e){this._bone=t,this._joint=e}sync(t,e){const{x:i,y:s}=t;this._bone.position.set(i,-s,0),this._bone.rotation.set(0,0,-e),this._joint.position.set(i,-s,0)}}class rh{constructor(t,e,i,s,o){(0,st.Z)(this,"_body",void 0),(0,st.Z)(this,"_boneMesh",void 0),(0,st.Z)(this,"_jointMesh",void 0),this._parent=t,this._config=e,this._skin=i,this._id=s,this._linkPosition=o,this._createMesh(),this._createBody()}get body(){return this._body}destroy(){this._boneMesh.clear(),this._boneMesh.removeFromParent(),this._boneMesh.material.dispose(),this._boneMesh.geometry.dispose(),this._boneMesh=null,this._jointMesh.destroy(),this._jointMesh=null,this._body.SetEnabled(!1),Ct().physics2dWorld.DestroyBody(this._body),this._body=null}setEnabled(t){this._body.SetEnabled(t)}get tipPosition(){const t=Cr(this._body.GetPosition()),e=this._body.GetAngle();return t.x=t.x+Math.sin(e)*this._config.height,t.y=t.y-Math.cos(e)*this._config.height,t}get linkPosition(){return this._linkPosition}_createMesh(){this._createBoneMesh(),this._createJointMesh()}_createBoneMesh(){const{height:t,type:e}=this._config,i=rh._armGeometryFactory.getGeometry(t,e),s=Le.getArmMaterial(this._skin);this._boneMesh=new he.Kj0(i,s),this._boneMesh.position.set(-19,0,0),this._boneMesh.castShadow=!0,this._boneMesh.receiveShadow=!0,this._parent.add(this._boneMesh)}_createJointMesh(){this._jointMesh=new nh(this._config.joint,this._skin),this._parent.add(this._jointMesh)}_createBody(){this._body=Zr(((t,e,i,s)=>{const{width:o,height:n,mass:a,angularDrag:r,drag:h}=e,l=Mr([Br(-o/2,0),Br(o/2,0),Br(o/2,-n),Br(-o/2,-n)]);return{userData:{id:t,target:i},filters:s,bodyDef:{type:bt.b2_dynamicBody,linearDamping:Er(h),angularDamping:Er(r),bullet:!1},fixturesDefs:[{shape:l,density:Tr(a,o*n)}]}})(this._id,this._config,new ah(this._boneMesh,this._jointMesh),rh.bodyFilters)),this._body.SetEnabled(!1),this._body.SetTransform(this._linkPosition,pi*this._config.angle),Ct().physics2dSyncManager.syncBodyTarget(this._body,!0)}}(0,st.Z)(rh,"bodyFilters",void 0),(0,st.Z)(rh,"_armGeometryFactory",new oh);{const{none:t}=xr,e=new bt.b2Filter;e.set_maskBits(t),rh.bodyFilters=[e]}class hh{constructor(t,e){(0,st.Z)(this,"_body",void 0),this._parent=t,this._config=e,this._createBody()}get body(){return this._body}destroy(){this._body.SetEnabled(!1),Ct().physics2dWorld.DestroyBody(this._body),this._body=null}setEnabled(t){this._body.SetEnabled(t)}_createBody(){const{x:t,y:e}=this._config.position;this._body=Zr(((t,e,i,s)=>{const{radius:o,mass:n,angularDrag:a,drag:r}=e,{b2CircleShape:h}=bt,l=new h;return l.m_radius=o,{userData:{id:t,target:i},filters:s,bodyDef:{type:bt.b2_staticBody,linearDamping:Er(r),angularDamping:Er(a),bullet:!1},fixturesDefs:[{shape:l,density:Tr(n,Math.PI*o*o)}]}})("base",this._config,void 0,rh.bodyFilters)),this._body.SetEnabled(!1),this._body.SetTransform(Br(t,e),0)}}class lh{constructor(t,e){this._disk=t,this._joint=e}sync(t,e){const{x:i,y:s}=t;this._disk.position.set(i,-s,0),this._joint.position.set(i,-s,0)}}class dh{constructor(t,e,i,s,o){(0,st.Z)(this,"_body",void 0),(0,st.Z)(this,"_disk",void 0),(0,st.Z)(this,"_jointMesh",void 0),this._parent=t,this._config=e,this._skin=i,this._power=s,this._linkPosition=o,this._createMesh(),this._createBody()}get body(){return this._body}destroy(){this._disk.destroy(),this._disk=null,this._jointMesh.destroy(),this._jointMesh=null,this._body.SetEnabled(!1),Ct().physics2dWorld.DestroyBody(this._body),this._body=null}update(){var t;null===(t=this._disk)||void 0===t||t.update()}setEnabled(t){this._body.SetEnabled(t)}_createMesh(){this._createDiskMesh(),this._createJointMesh()}_createDiskMesh(){const t=Le.getHeadDisk(this._skin,this._config.radius,this._power);this._parent.add(this._disk=t)}_createJointMesh(){this._jointMesh=new nh(this._config.joint,this._skin),this._parent.add(this._jointMesh)}_createBody(){this._body=Zr(((t,e,i,s)=>{const{radius:o,mass:n,angularDrag:a,drag:r}=e,{b2CircleShape:h}=bt,l=.35*o,d=new h;d.m_radius=o;const c=new h;return c.m_radius=l,{userData:{id:t,target:i,group:kr.crusherHead},filters:s,bodyDef:{type:bt.b2_dynamicBody,linearDamping:Er(r),angularDamping:Er(a),bullet:!1,fixedRotation:!0},fixturesDefs:[{shape:c,density:Tr(n,Math.PI*l*l),friction:1,restitution:0},{shape:d,density:Tr(.01*n,Math.PI*o*o),isSensor:!0}]}})("head",this._config,new lh(this._disk,this._jointMesh),dh.bodyFilters)),this._body.SetEnabled(!1),this._body.SetTransform(this._linkPosition,0),this._body.SetGravityScale(0),Ct().physics2dSyncManager.syncBodyTarget(this._body,!0)}}(0,st.Z)(dh,"bodyFilters",void 0);{const{crusherHead:t,crusherHeadSensor:e,brick:i,brickStatic:s,ground:o,collectorGate:n}=xr,a=new bt.b2Filter,r=new bt.b2Filter;a.set_categoryBits(t),a.set_maskBits(i|s|o|n),r.set_categoryBits(e),r.set_maskBits(s),dh.bodyFilters=[a,r]}class ch{constructor(t,e){(0,st.Z)(this,"_base",void 0),(0,st.Z)(this,"_arms",[]),(0,st.Z)(this,"_upperArms",[]),(0,st.Z)(this,"_head",void 0),(0,st.Z)(this,"_config",void 0),(0,st.Z)(this,"_skin",void 0),this._parent=t,this._model=e,this._config=this._model.config,this._skin=this._model.activeSkin,this._createBase();const i=this._createArms();this._createHead(i)}destroy(){this._upperArms.length=0,this._head.destroy(),this._head=null,this._arms.forEach((t=>t.destroy())),this._arms.length=0,this._base.destroy(),this._base=null}setEnabled(t){this._head.setEnabled(t),this._arms.forEach((e=>e.setEnabled(t))),this._base.setEnabled(t)}update(){for(const t of this._upperArms)t.body.ApplyForceToCenter(ch._constantForce,!1);const{velocity:t}=this._model;ch._velocity.x=Ir(t.x),ch._velocity.y=Ir(t.y),this._head.body.SetLinearVelocity(ch._velocity),this._head.update()}_createHead(t){this._head=new dh(this._parent,this._config.head,this._skin,this._config.power,t);const e=(0,ih.Z)(this._arms);Sr(this._head.body,e.body,t)}_createArms(){let t=this._base.body,e=Cr(this._base.body.GetPosition());return this._arms=this._config.arms.map(((i,s)=>{const o=new rh(this._parent,i,this._skin,"arm".concat(s),e);return Sr(o.body,t,e),t=o.body,e=o.tipPosition,o})),this._upperArms=(0,sh.Z)(this._arms,1,this._arms.length),e}_createBase(){this._base=new hh(this._parent,this._config.base)}}(0,st.Z)(ch,"_constantForce",new bt.b2Vec2(Lr(0),12*Lr(-3))),(0,st.Z)(ch,"_velocity",new bt.b2Vec2(Ir(0),Ir(0)));class uh extends Xr{constructor(t){super(),(0,st.Z)(this,"_crane",void 0),this.model=t}init(t){super.init(t),this._crane=new ch(t,this.model),this.update(t),s.q.event.on(r.stateUpdate,this._onLevelStateUpdate,this)}destroy(){s.q.event.removeListenersOf(this),this._crane.destroy(),this._crane=null}update(t,e,i){var s;null===(s=this._crane)||void 0===s||s.update()}_onLevelStateUpdate(t){switch(t){case Q.play:this._crane.setEnabled(!0);break;case Q.idle:case Q.reviving:this._crane.setEnabled(!1)}}}var ph=i(161);const _h=new(i.n(ph)()),gh={contact:null,isSensor:null,pair:[{fixture:null,body:null,userData:null},{fixture:null,body:null,userData:null}]};class mh{constructor(t){this._world=t;const e=Object.assign(new bt.JSContactListener,{BeginContact:t=>{this._updateContactInfo(bt.wrapPointer(t,bt.b2Contact)),_h.emit(P.beginContact,gh)},EndContact:t=>{this._updateContactInfo(bt.wrapPointer(t,bt.b2Contact)),_h.emit(P.endContact,gh)},PreSolve:(t,e)=>{},PostSolve:(t,e)=>{_h.emit(P.postSolve,gh)}});this._world.SetContactListener(e)}static contactContainsGroups(t,e){const{pair:i}=gh;return i[0].userData.group===t&&i[1].userData.group===e||i[1].userData.group===t&&i[0].userData.group===e}static contactContains(t,e,i,s){const{pair:o}=gh;return o[0].userData[e]===t&&o[1].userData[s]===i||o[1].userData[e]===t&&o[0].userData[s]===i}static getFromPair(t,e,i){const[s,o]=t;return s.userData[i]===e&&s||o.userData[i]===e&&o}_updateContactInfo(t){const e=t.GetFixtureA(),i=t.GetFixtureB(),s=e.GetBody(),o=i.GetBody(),n=s.__userData__,a=o.__userData__,r=gh.pair[0],h=gh.pair[1];gh.contact=t,gh.isSensor=e.IsSensor()||i.IsSensor(),r.fixture=e,r.body=s,r.userData=n,h.fixture=i,h.body=o,h.userData=a}}i(5682),i(1045),i(7244),i(2068),i(5519),i(9432),i(3574),i(3619),i(3862),i(6881),i(5359),i(8208),i(3608),i(5676),i(5993),i(4456);class yh{constructor(t,e){(0,st.Z)(this,"_xLockedRotation",void 0),(0,st.Z)(this,"_yLockedRotation",void 0),(0,st.Z)(this,"_scaleValue",void 0),(0,st.Z)(this,"_zOffset",void 0),this._index=t;const{rotation:i,scale:s,zOffset:o}=e,{x:n,y:a}=i,{probability:r,value:h}=o;this._xLockedRotation=(0,Tt.Z)(n.min,n.max,!0),this._yLockedRotation=(0,Tt.Z)(a.min,a.max,!0),this._scaleValue=(0,Tt.Z)(s.min,s.max,!0),this._zOffset=Math.random()<=r?(0,Tt.Z)(h.min,h.max,!0):0}sync(t,e){Gr(yh.dummyMatrix,t.x,-t.y,this._zOffset,this._scaleValue,this._scaleValue,this._scaleValue,this._xLockedRotation,this._yLockedRotation,-e),yh.wall.setMatrixAt(this._index,yh.dummyMatrix)}}(0,st.Z)(yh,"wall",void 0),(0,st.Z)(yh,"dummyMatrix",new he.yGw);class vh{constructor(t,e,i){this._index=t,this._id=e,this._body=i}get index(){return this._index}get id(){return this._id}get body(){return this._body}destroy(){this._body.SetEnabled(!1),Ct().physics2dWorld.DestroyBody(this._body),this._body=null}}class fh{constructor(t,e){(0,st.Z)(this,"_wall",void 0),(0,st.Z)(this,"_bricks",new Map),(0,st.Z)(this,"_bricksToRemove",new Set),(0,st.Z)(this,"_bricksToCollect",new Set),(0,st.Z)(this,"_bricksToActivate",[]),(0,st.Z)(this,"_bricksInContact",new Map),(0,st.Z)(this,"_activeBricks",new Map),this._parent=t,this._model=e,this._createBricks()}destroy(){this._destroyView(),this._destroyBodies(),this._bricks.clear(),this._bricksInContact.clear(),this._activeBricks.clear(),this._bricksToRemove.clear(),this._bricksToCollect.clear(),this._bricksToActivate.length=0}update(t,e){this._wall.instanceMatrix.needsUpdate=!0,this._collectBricks(),this._removeBricks(),this._activateBricks(),this._cullActiveBricks()}crush(t){if(!this._bricksInContact.size)return;[...this._bricksInContact.values()].forEach((e=>{1===(0,Tt.Z)(1,31-t,!1)&&(this._bricksToActivate.push(e),this._bricksInContact.delete(e.id))}))}addBrickInContact(t){const e=this._bricks.get(t);this._bricksInContact.set(t,e)}removeBrickInContact(t){this._bricksInContact.delete(t)}queueBrickToCollect(t){this._activeBricks.delete(t);const e=this._bricks.get(t);e&&this._bricksToCollect.add(e)}queueBrickToRemove(t){this._activeBricks.delete(t);const e=this._bricks.get(t);e&&(this._bricksToCollect.has(e)||this._bricksToRemove.add(e))}_cullActiveBricks(){const{bricksCullLimit:t}=fi,{size:e}=this._activeBricks;if(e<=t)return;let i=0;const s=e-t,o=this._activeBricks.entries();for(;i<s;){i++;const{value:t}=o.next(),[e,s]=t;this._bricksToCollect.has(s)||this._bricksToRemove.has(s)||this.queueBrickToCollect(e)}}_collectBricks(){const{size:t}=this._bricksToCollect;t&&(this._destroyBricks([...this._bricksToCollect]),this._bricksToCollect.clear(),s.q.event.emit(F.bricksCollected,length))}_removeBricks(){this._bricksToRemove.size&&(this._destroyBricks([...this._bricksToRemove]),this._bricksToRemove.clear())}_activateBricks(){if(!this._bricksToActivate.length)return;const{length:t}=this._bricksToActivate,e=[...this._bricksToActivate];this._bricksToActivate.length=0,e.forEach((t=>{this._activeBricks.set(t.id,t),this._activateBrick(t)})),s.q.event.emit(F.bricksThrown,t)}_destroyBricks(t){t.forEach((t=>{this._destroyBrick(t)}))}_destroyBrick(t){const{index:e,id:i}=t;t.destroy(),this._bricks.delete(i),zr(yh.dummyMatrix),this._wall.setMatrixAt(e,yh.dummyMatrix)}_activateBrick(t){const{body:e}=t;e.SetType(bt.b2_dynamicBody),e.GetFixtureList().SetFilterData(fh.brickBodyFilter);const i=(0,Tt.Z)(Or(-1),Or(1),!0),s=(0,Tt.Z)(Or(-.5),Or(2),!0);e.ApplyLinearImpulseToCenter(new bt.b2Vec2(i,s),!0)}_createBricks(){const{bricksData:t,bricksCount:e}=this._model,{physics2dSyncManager:i}=Ct(),s=Wr.getBrickGeometry(fh._brickSize),o=Ze.getWallMaterial(),n=new he.SPe(s,o,e);n.castShadow=!0,this._parent.add(this._wall=n),yh.wall=this._wall,t.forEach(((t,e)=>{const{x:s,y:o,color:a}=t;n.setColorAt(e,new he.Ilk(a));const{x:r,y:h}=this._model.config.position,l=this._makeBody(e,"".concat(s,"_").concat(o),s+r,o+h);this._bricks.set("".concat(s,"_").concat(o),new vh(e,"".concat(s,"_").concat(o),l)),i.syncBodyTarget(l)}))}_makeBody(t,e,i,s){return Zr(((t,e,i,s,o)=>{const{b2CircleShape:n}=bt,a=new n;return a.m_radius=e/2,{userData:{id:t,target:s,group:kr.wall},bodyDef:{type:bt.b2_staticBody,position:Br(i.x,i.y),bullet:!1,angularDamping:Er(.05),linearDamping:Er(0)},filters:o,fixturesDefs:[{shape:a,density:Tr(.1,Math.PI*a.m_radius*a.m_radius),friction:.6,restitution:0}]}})(e,fh._brickSize,{x:i*fh._brickSize,y:-s*fh._brickSize-fh._brickSize/2},new yh(t,this._model.config.distortion),[fh.brickStaticBodyFilter]))}_destroyView(){this._wall.clear(),this._wall.removeFromParent(),this._wall=null}_destroyBodies(){this._bricks.forEach((t=>{t.destroy()}))}}(0,st.Z)(fh,"brickBodyFilter",void 0),(0,st.Z)(fh,"brickStaticBodyFilter",void 0),(0,st.Z)(fh,"_brickSize",1.073164);{const{brick:t,brickStatic:e,crusherHead:i,crusherHeadSensor:s}=xr,o=new bt.b2Filter,n=new bt.b2Filter;o.set_categoryBits(t),n.set_categoryBits(e),n.set_maskBits(i|s|t),fh.brickBodyFilter=o,fh.brickStaticBodyFilter=n}class wh extends Xr{constructor(t){super(),(0,st.Z)(this,"_wall",void 0),this.model=t,_h.on(P.beginContact,this._onBeginContact,this),_h.on(P.endContact,this._onEndContact,this)}init(t){super.init(t),this._createWall(),this.update(t)}destroy(){var t;_h.off(P.beginContact,this._onBeginContact,this),_h.off(P.endContact,this._onEndContact,this),null===(t=this._wall)||void 0===t||t.destroy(),this._wall=null}update(t,e,i){this._wall.update(e,i)}crush(t){this._wall.crush(t)}_createWall(){this._wall=new fh(this.level,this.model)}_onEndContact(t){let{isSensor:e,pair:i,contact:s}=t;if(e&&mh.contactContainsGroups(kr.wall,kr.crusherHead)){const t=mh.getFromPair(i,kr.wall,"group"),{id:e}=t.userData;this._wall.removeBrickInContact(e)}}_onBeginContact(t){let{isSensor:e,pair:i,contact:s}=t;if(e){if(mh.contactContainsGroups(kr.wall,kr.crusherHead)){const t=mh.getFromPair(i,kr.wall,"group"),{id:e}=t.userData;this._wall.addBrickInContact(e)}if(mh.contactContains(kr.hole,"group",kr.wall,"group")){const t=mh.getFromPair(i,kr.wall,"group");t&&this._wall.queueBrickToCollect(t.userData.id)}else if(mh.contactContains(kr.wall,"group",kr.threshold,"group")){const t=mh.getFromPair(i,kr.wall,"group");t&&this._wall.queueBrickToRemove(t.userData.id)}}}}class bh extends he.ZAu{constructor(t){super(),(0,st.Z)(this,"_managers",void 0),(0,st.Z)(this,"_crushTickerTask",void 0),(0,st.Z)(this,"update",((t,e)=>{ci(this._managers,(i=>i.update(this,t,e)))})),(0,st.Z)(this,"_physicsUpdate",(()=>{this._managers[H.wall].crush(this._model.crusher.config.power)})),this._model=t,this._managers={},s.q.event.on(r.stateUpdate,this._onLevelStateUpdate,this).on(r.crusherUpdate,this._onCrusherUpdate,this).on(r.wallUpdate,this._onWallUpdate,this).on(r.collectorUpdate,this._onCollectorUpdate,this).on(r.coinsPropagatorUpdate,this._onCoinsPropagatorUpdate,this).on(a.configUpdate,this._rebuildCrusher,this).on(a.activeSkinUpdate,this._rebuildCrusher,this)}get managers(){return this._managers}destroy(){s.q.event.removeListenersOf(this),this._destroyManagers(),this.clear(),this.removeFromParent()}_onLevelStateUpdate(t){var e;switch(null===(e=this._crushTickerTask)||void 0===e||e.destroy(),t){case Q.idle:ci(this._managers,(t=>t.init(this)));break;case Q.play:this._crushTickerTask=Ct().delay({callback:this._physicsUpdate,delay:20,context:this,loop:!0});break;case Q.complete:s.q.event.off(a.configUpdate,this._rebuildCrusher,this)}}_onCrusherUpdate(t){t&&(this._managers[H.crusher]=new uh(t))}_onWallUpdate(t){t&&(this._managers[H.wall]=new wh(t))}_onCollectorUpdate(t){t&&(this._managers[H.collector]=new eh(t))}_onCoinsPropagatorUpdate(t){t&&(this._managers[H.coins]=new $r(t))}_destroyManagers(){ci(this._managers,(t=>t.destroy())),this._managers=null}_rebuildCrusher(){var t;null===(t=this._managers[H.crusher])||void 0===t||t.destroy(),delete this._managers[H.crusher];const{game:e}=Yt,{crusher:i}=e;this._managers[H.crusher]=new uh(i),this._managers[H.crusher].init(this)}}class kh extends he.xsS{constructor(){super(),(0,st.Z)(this,"_level",void 0),(0,st.Z)(this,"_ground",void 0),(0,st.Z)(this,"_sky",void 0),(0,st.Z)(this,"_tutorial",void 0),(0,st.Z)(this,"update",((t,e)=>{var i;null===(i=this._level)||void 0===i||i.update(t,e)})),this.background=new he.Ilk(14483449),s.q.event.on(C.groundUpdate,this._onGroundUpdate,this).on(C.gameUpdate,this._onGameUpdate,this).on(y.levelUpdate,this._onLevelUpdate,this).on(y.tutorialUpdate,this._onTutorialUpdate,this).on(y.stateUpdate,this._onGameStateUpdate,this),this._setupLight()}_onGameStateUpdate(t){var e;if(t===Y.play)null===(e=this._tutorial)||void 0===e||e.show()}_onTutorialUpdate(t){t?this._createTutorial():this._destroyTutorial()}_onLevelUpdate(t){t?this._createLevel(t):this._destroyLevel()}_onGroundUpdate(t){t&&this._buildGround()}_onGameUpdate(t){t&&this._buildSky()}_createTutorial(){this._tutorial=new Hr(this)}_destroyTutorial(){this._tutorial.destroy(),this._tutorial=null}_createLevel(t){this._level=new bh(t),this.add(this._level)}_destroyLevel(){this._level.destroy(),this._level=null}_setupLight(){const t=new he.Mig(9547989,.7);this.add(t);const e=new he.Ox3(16774358,1);e.castShadow=!0,e.shadow.camera.left=-70,e.shadow.camera.right=70,e.shadow.camera.top=70,e.shadow.camera.bottom=-50,e.shadow.mapSize.width=512,e.shadow.mapSize.height=512,e.shadow.normalBias=.4;const i=new he.Pa4(0,0,100);i.applyEuler(new he.USm((0,ta.Id)(-48.717),(0,ta.Id)(-8.682),(0,ta.Id)(.101),"YZX")),e.shadow.camera.near=10,e.shadow.camera.far=150,e.position.copy(i),this.add(e)}_buildGround(){this._ground=new Vr(this)}_buildSky(){this._sky=new Rr(this)}}i(634),i(6882);var xh=i(1895);function Ch(t){var e,i,s,o=2;for("undefined"!=typeof Symbol&&(i=Symbol.asyncIterator,s=Symbol.iterator);o--;){if(i&&null!=(e=t[i]))return e.call(t);if(s&&null!=(e=t[s]))return new Bh(e.call(t));i="@@asyncIterator",s="@@iterator"}throw new TypeError("Object is not async iterable")}function Bh(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return Bh=function(t){this.s=t,this.n=t.next},Bh.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var i=this.s.return;return void 0===i?Promise.resolve({value:t,done:!0}):e(i.apply(this.s,arguments))},throw:function(t){var i=this.s.return;return void 0===i?Promise.reject(t):e(i.apply(this.s,arguments))}},new Bh(t)}class Mh{constructor(){(0,st.Z)(this,"name","three"),(0,st.Z)(this,"_manager",void 0),(0,st.Z)(this,"_gltfLoader",void 0),(0,st.Z)(this,"_textureLoader",void 0),(0,st.Z)(this,"_resources",void 0),(0,st.Z)(this,"_processSound",(t=>{})),(0,st.Z)(this,"_processFont",(t=>{})),this._manager=new he.lLk,this._resources={models:new Map,textures:new Map,maps:new Map,fonts:new Map},this._gltfLoader=new xh.E(this._manager),this._textureLoader=new he.dpR(this._manager)}get resources(){return this._resources}async load(t){return new Promise((e=>{const{textures:i,models:s}=t;Promise.all([this.__loadModels__(s),this.__loadTextures__(i)]).then((()=>e()))}))}async onGenericAssetLoad(t,e){switch(t){case"sound":this._processSound(e);break;case"font":this._processFont(e)}}async __loadModels__(t){var e,i=!1,s=!1;try{for(var o,n=Ch(t);i=!(o=await n.next()).done;i=!1){const t=o.value,e=ie.L.models[t],i=await this._gltfLoader.loadAsync(e);this._resources.models.set(t,i)}}catch(t){s=!0,e=t}finally{try{i&&null!=n.return&&await n.return()}finally{if(s)throw e}}}async __loadTextures__(t){var e,i=!1,s=!1;try{for(var o,n=Ch(t);i=!(o=await n.next()).done;i=!1){const t=o.value,e=ie.L.images[t],i=await this._textureLoader.loadAsync(e);this._resources.textures.set(t,i)}}catch(t){s=!0,e=t}finally{try{i&&null!=n.return&&await n.return()}finally{if(s)throw e}}}}class Sh{constructor(t){(0,st.Z)(this,"name","three"),(0,st.Z)(this,"camera",void 0),(0,st.Z)(this,"renderer",void 0),(0,st.Z)(this,"scene",void 0),(0,st.Z)(this,"_loader",void 0),(0,st.Z)(this,"onPause",(()=>{})),(0,st.Z)(this,"onResume",(()=>{})),(0,st.Z)(this,"update",((t,e)=>{this.renderer.resetState(),this.scene.update(t,e),this.renderer.render(this.scene,this.camera),this.renderer.resetState()})),this.renderer=new he.CP7(function(t){return{canvas:t,antialias:!((0,si.Z)().apple.device&&15.4===parseFloat(gi.os.version)),precision:"highp",powerPreference:"high-performance"}}(t)),this.renderer.setPixelRatio(di()),this._loader=new Mh,this.camera=new wr,this.scene=new kh}get loader(){return this._loader}onResize(t,e,i){this.renderer.setSize(i.width*e,i.height*e),this.camera.aspect=i.width/i.height,this.camera.updateProjectionMatrix()}}var Zh=i(241),Ph=i(8036);function Uh(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function Th(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Uh(Object(i),!0).forEach((function(e){(0,st.Z)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Uh(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}xi.ZP.registerPlugin(Ph.w),xi.ZP.registerPlugin(pr),xi.ZP.registerPlugin({name:"universal",init:()=>{}}),xi.ZP.defaults({ease:Ci.bJ.easeNone}),Ph.w.registerPIXI(Th(Th({},Ds),Zh));class Fh{constructor(){(0,st.Z)(this,"name","tween")}onPause(){xi.ZP.ticker.sleep()}onResume(){xi.ZP.ticker.wake()}onResize(){xi.ZP.globalTimeline.getChildren().filter((t=>!(!0===t.vars.universal||t.parent&&!0===t.parent.vars.universal))).forEach((t=>{t.totalProgress(1)}))}}var Dh=i(8492);class Ih{constructor(t){(0,st.Z)(this,"_app",void 0),(0,st.Z)(this,"firstInteraction",(()=>{this._app.firstInteraction()})),(0,st.Z)(this,"interaction",(()=>{this._app.interaction()})),this._app=t}get runtimes(){return this._app.runtimes}get plugins(){return this._app.plugins}get canvas(){return this._app.canvas}get viewScale(){return this._app.viewScale}set viewScale(t){this._app.viewScale=t}get viewBounds(){return this._app.viewBounds}get designBounds(){return this._app.designBounds}get orientation(){return this._app.orientation}set orientation(t){this._app.orientation=t}get physics2dWorld(){return this._app.physics2dWorld}get physics2dSyncManager(){return this._app.physics2dSyncManager}get physics2dContactManager(){return this._app.physics2dContactManager}get physics2dDebugManager(){return this._app.physics2dDebugManager}get physics3dWorld(){return this._app.physics3dWorld}get physics3dSyncManager(){return this._app.physics3dSyncManager}get physics3dContactManager(){return this._app.physics3dContactManager}get physics3dDebugManager(){return this._app.physics3dDebugManager}get physics3dMaterials(){return this._app.physics3dMaterials}get isReady(){return this._app.isReady}get isVisible(){return this._app.isVisible}set isVisible(t){this._app.isVisible=t}get interacted(){return this._app.interacted}set interactive(t){this._app.interactive=t}get interactive(){return this._app.interactive}get tickerStarted(){return this._app.tickerStarted}get lastTime(){return this._app.lastTime}init(){this._app.init()}start(){this._app.start()}show(){this._app.show()}lockOrientation(t){this._app.lockOrientation(t)}pause(){this._app.pause()}resume(){this._app.resume()}mute(){this._app.mute()}unmute(){this._app.unmute()}resize(){this._app.resize()}post(t,e){this._app.post(t,e)}delay(t){return this._app.delay(t)}cancel(t){this._app.cancel(t)}add(t,e){this._app.add(t,e)}remove(t,e){this._app.remove(t,e)}loadChunk(t){this._app.loadChunk(t)}installRuntime(t){this._app.installRuntime(t)}uninstallRuntime(t){this._app.uninstallRuntime(t)}installPlugin(t){this._app.installPlugin(t)}uninstallPlugin(t){this._app.uninstallPlugin(t)}getRuntime(t){return this._app.getRuntime(t)}showInterstitialAd(){return this._app.showInterstitialAd()}showRewardedAd(){return this._app.showRewardedAd()}logLevelStart(t){this._app.logLevelStart(t)}logUpdateScore(t){this._app.logUpdateScore(t)}logLevelEnd(t,e,i){this._app.logLevelEnd(t,e,i)}saveProgression(t,e){return this._app.saveProgression(t,e)}getSavedProgression(t){return this._app.getSavedProgression(t)}isFacebookPlatform(){return this._app.isFacebookPlatform()}showTournamentCreatorPopup(){return this._app.showTournamentCreatorPopup()}getTranslation(t){return this._app.getTranslation(t)}inviteFriends(t,e){return this._app.inviteFriends(t,e)}shareWithFriends(t,e){return this._app.shareWithFriends(t,e)}vibrate(t){this._app.vibrate(t)}getGPUTier(){return this._app.getGPUTier()}update(t,e){this._app.update(t,e)}}const Eh={pointer:{down:"pointerdown"},mouse:{down:"mousedown"},touch:{down:"touchstart"}};var Lh=i(9081),Oh=i(5310),Ah=i.n(Oh),qh=i(8492);function zh(t){var e,i,s,o=2;for("undefined"!=typeof Symbol&&(i=Symbol.asyncIterator,s=Symbol.iterator);o--;){if(i&&null!=(e=t[i]))return e.call(t);if(s&&null!=(e=t[s]))return new Gh(e.call(t));i="@@asyncIterator",s="@@iterator"}throw new TypeError("Object is not async iterable")}function Gh(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return Gh=function(t){this.s=t,this.n=t.next},Gh.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var i=this.s.return;return void 0===i?Promise.resolve({value:t,done:!0}):e(i.apply(this.s,arguments))},throw:function(t){var i=this.s.return;return void 0===i?Promise.reject(t):e(i.apply(this.s,arguments))}},new Gh(t)}class jh extends Ih{constructor(){super(...arguments),(0,st.Z)(this,"_assetsToLoad",0),(0,st.Z)(this,"_assetsLoaded",0),(0,st.Z)(this,"_onAssetLoad",(()=>{this._assetsLoaded++,s.q.event.emit(Z.loadProgress,this._assetsLoaded/this._assetsToLoad)}))}static _getChunkLength(t){let e=0;const i=Object.keys(t);for(const s of i){const i=Object.keys(t[s]);for(const o of i){const i=t[s][o].length;i&&(e+=i)}}return e}async loadChunk(t){const e=qh.load[t],i=Object.keys(e);this._assetsLoaded=0,this._assetsToLoad=jh._getChunkLength(e),s.q.event.emit(Z.loadStart,t);const{sounds:o,fonts:n}=e.generic;!(0,Hn.Z)(o)&&await this._loadSounds(o),!(0,Hn.Z)(n)&&await this._loadFonts(n);var a,r=!1,h=!1;try{for(var l,d=zh(i);r=!(l=await d.next()).done;r=!1){const t=l.value,i=this.getRuntime(t);i&&await i.loader.load(e[t],this._onAssetLoad)}}catch(t){h=!0,a=t}finally{try{r&&null!=d.return&&await d.return()}finally{if(h)throw a}}s.q.event.emit(Z.loadComplete,t)}async _loadSounds(t){var e,i=!1,s=!1;try{for(var o,n=zh(t);i=!(o=await n.next()).done;i=!1){const t=o.value;await new Promise((async e=>{new Lh.Howl({src:ie.L.sounds[t],autoplay:!1,onload:i=>{this.runtimes.forEach((e=>{var i;return null===(i=e.loader)||void 0===i?void 0:i.onGenericAssetLoad("sound",t)})),this._onAssetLoad(),e()}})}))}}catch(t){s=!0,e=t}finally{try{i&&null!=n.return&&await n.return()}finally{if(s)throw e}}}async _loadFonts(t){return new Promise(((e,i)=>{Ah().load({custom:{families:t},active:e,inactive:i,fontactive:t=>{var e;this.runtimes.forEach((e=>{var i;return null===(i=e.loader)||void 0===i?void 0:i.onGenericAssetLoad("font",t)})),this._onAssetLoad(),null===(e=document.getElementById(t))||void 0===e||e.remove()},fontinactive:t=>{window.console.error("".concat(t," font is not found!"))}})}))}}window.devicePixelRatio,Math.PI;class Wh{constructor(t){this._world=t}sync(){for(let t=this._world.GetBodyList();bt.getPointer(t);t=t.GetNext())t.GetType()!==bt.b2_staticBody&&this.syncBodyTarget(t)}syncBodyTarget(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.__userData__&&(e||t.IsEnabled())){const e=t.__userData__.target;if(!e)return;const{p:i,q:s}=t.GetTransform();e.sync(i,s.GetAngle())}}}var Vh=i(8492);const Rh=.06;class Hh{constructor(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,st.Z)(this,"priority",void 0),(0,st.Z)(this,"next",null),(0,st.Z)(this,"previous",null),(0,st.Z)(this,"_fn",void 0),(0,st.Z)(this,"_context",void 0),(0,st.Z)(this,"_once",void 0),(0,st.Z)(this,"_destroyed",!1),this._fn=t,this._context=e,this.priority=i,this._once=s}match(t,e){return this._fn===t&&this._context===e}emit(t){var e;this._fn&&(this._context?this._fn.call(this._context,t):null===(e=this._fn)||void 0===e||e.call(this,t));const i=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),i}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._destroyed=!0,this._fn=null,this._context=void 0,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}class Nh{constructor(t){(0,st.Z)(this,"_delay",void 0),(0,st.Z)(this,"_completeHandler",void 0),(0,st.Z)(this,"update",(t=>{const e=t/Rh;var i;(this.config.delay-=e,this.config.delay<=0)&&(this.config.delay=0,null===(i=this._completeHandler)||void 0===i||i.call(this,this))})),this.config=t,this._delay=t.delay}get delay(){return this._delay}get elapsed(){return this.config.delay}get remaining(){return this._delay-this.elapsed}reset(){this.config.delay=this._delay}onComplete(t,e){this._completeHandler=t.bind(e)}destroy(){this._completeHandler=void 0}}class Jh{constructor(){(0,st.Z)(this,"autoStart",!1),(0,st.Z)(this,"deltaTime",1),(0,st.Z)(this,"deltaMS",void 0),(0,st.Z)(this,"elapsedMS",void 0),(0,st.Z)(this,"lastTime",-1),(0,st.Z)(this,"speed",1),(0,st.Z)(this,"started",!1),(0,st.Z)(this,"_head",void 0),(0,st.Z)(this,"_requestId",null),(0,st.Z)(this,"_maxElapsedMS",100),(0,st.Z)(this,"_minElapsedMS",0),(0,st.Z)(this,"_protected",!1),(0,st.Z)(this,"_lastFrame",-1),(0,st.Z)(this,"_tick",void 0),(0,st.Z)(this,"_onTickerTaskComplete",(t=>{const{callback:e,context:i,args:s,loop:o}=t.config;e.apply(i,s),o?t.reset():this.cancel(t)})),this._head=new Hh(null,null,1/0),this.deltaMS=1/Rh,this.elapsedMS=1/Rh,this._tick=t=>{this._requestId=null,this.started&&(this._update(t),this.started&&null===this._requestId&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,Rh);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(0===t)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t+=1;return t}add(t,e){return this._addListener(new Hh(t,e,0))}remove(t,e){let i=this._head.next;for(;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this}post(t,e){return this._addListener(new Hh(t,e,0,!0))}delay(t){return this._createTask(t)}cancel(t){this.remove(t.update,this),t.destroy()}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy()}}_requestIfNeeded(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}_addListener(t){let e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this}_createTask(t){const e=new Nh(t);return e.onComplete(this._onTickerTaskComplete,this),this.add(e.update,this),e}_update(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:performance.now();if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const t=e-this._lastFrame|0;if(t<this._minElapsedMS)return;this._lastFrame=e-t%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*Rh;const i=this._head;let s=i.next;for(;s;)s=s.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}}var Yh=i(8492);let Qh=new class{constructor(){(0,st.Z)(this,"_orientation",j.landscape),(0,st.Z)(this,"_designBounds",{x:0,y:0,width:0,height:0}),(0,st.Z)(this,"_viewBounds",{x:0,y:0,width:0,height:0}),(0,st.Z)(this,"_viewScale",1),(0,st.Z)(this,"_canvas",void 0),(0,st.Z)(this,"_runtimes",void 0),(0,st.Z)(this,"_plugins",void 0),(0,st.Z)(this,"_isReady",!1),(0,st.Z)(this,"_interacted",!1),(0,st.Z)(this,"_isVisible",!1),this._canvas=document.getElementById("game_canvas"),this._canvas.classList.add("invisible-game"),this._runtimes=new Map,this._plugins=new Map}get runtimes(){return this._runtimes}get plugins(){return this._plugins}get canvas(){return this._canvas}get viewScale(){return this._viewScale}set viewScale(t){this._viewScale=t}get designBounds(){return this._designBounds}get viewBounds(){return this._viewBounds}get orientation(){return this._orientation}set orientation(t){this._orientation=t}get isReady(){return this._isReady}get isVisible(){return this._isVisible}set isVisible(t){this._isVisible=t}get interacted(){return this._interacted}set interactive(t){window.console.warn("Method not implemented.")}get interactive(){return window.console.warn("Method not implemented."),!1}get physics2dWorld(){throw new Error("Method not implemented.")}get physics2dSyncManager(){throw new Error("Method not implemented.")}get physics2dContactManager(){throw new Error("Method not implemented.")}get physics2dDebugManager(){throw new Error("Method not implemented.")}get physics3dWorld(){throw new Error("Method not implemented.")}get physics3dSyncManager(){throw new Error("Method not implemented.")}get physics3dContactManager(){throw new Error("Method not implemented.")}get physics3dDebugManager(){throw new Error("Method not implemented.")}get physics3dMaterials(){throw new Error("Method not implemented.")}get tickerStarted(){return!1}get lastTime(){throw new Error("Method not implemented.")}async init(){this.installRuntime(new Sh(this._canvas)),this.installRuntime(new fr(this._canvas)),this.installPlugin(new Fh),Dh.extensions.stats.enabled,this._isReady=!0,s.q.event.emit(Z.init)}start(){s.q.event.emit(Z.start)}show(){this._canvas.classList.remove("invisible-game"),this._canvas.classList.add("fade-in-game")}pause(){this._plugins.forEach((t=>{var e;return null===(e=t.onPause)||void 0===e?void 0:e.call(t)})),this._runtimes.forEach((t=>{var e;return null===(e=t.onPause)||void 0===e?void 0:e.call(t)})),s.q.event.emit(Z.pause)}resume(){this._plugins.forEach((t=>{var e;return null===(e=t.onResume)||void 0===e?void 0:e.call(t)})),this._runtimes.forEach((t=>{var e;return null===(e=t.onResume)||void 0===e?void 0:e.call(t)})),s.q.event.emit(Z.resume)}mute(){s.q.event.emit(Z.mute)}unmute(){s.q.event.emit(Z.unmute)}resize(){this._plugins.forEach((t=>{var e;return null===(e=t.onResize)||void 0===e?void 0:e.call(t,this._orientation,this._viewScale,this._viewBounds)})),this._runtimes.forEach((t=>{var e;return null===(e=t.onResize)||void 0===e?void 0:e.call(t,this._orientation,this._viewScale,this._viewBounds)})),s.q.event.emit(Z.resize,this._orientation,this._viewScale,this._viewBounds)}firstInteraction(){this._interacted=!0,s.q.event.emit(Z.firstInteraction)}interaction(){s.q.event.emit(Z.interaction)}lockOrientation(t){window.console.warn("Method not implemented.")}post(t,e){window.console.warn("Method not implemented.")}delay(t){return window.console.warn("Method not implemented."),null}cancel(t){window.console.warn("Method not implemented.")}add(t,e){window.console.warn("Method not implemented.")}remove(t,e){window.console.warn("Method not implemented.")}loadChunk(t){window.console.warn("Method not implemented.")}logLevelStart(t){window.console.warn("Method not implemented.")}logUpdateScore(t){window.console.warn("Method not implemented.")}logLevelEnd(t,e,i){window.console.warn("Method not implemented.")}installRuntime(t){var e;this._runtimes.set(t.name,t),null===(e=t.onInstall)||void 0===e||e.call(t,this._orientation,this._viewScale,this._viewBounds)}uninstallRuntime(t){var e;this._runtimes.delete(t.name),null===(e=t.onUninstall)||void 0===e||e.call(t)}installPlugin(t){var e;this._plugins.set(t.name,t),null===(e=t.onInstall)||void 0===e||e.call(t,this._orientation,this._viewScale,this._viewBounds)}uninstallPlugin(t){var e;this._plugins.delete(t.name),null===(e=t.onUninstall)||void 0===e||e.call(t)}getRuntime(t){return this._runtimes.get(t)}showInterstitialAd(){return window.console.warn("Method not implemented."),Promise.resolve(!1)}showRewardedAd(){return window.console.warn("Method not implemented."),Promise.resolve(!1)}saveProgression(t,e){return window.console.warn("Method not implemented."),Promise.resolve(void 0)}getSavedProgression(t){return window.console.warn("Method not implemented."),Promise.resolve(void 0)}isFacebookPlatform(){throw new Error("Method not implemented.")}showTournamentCreatorPopup(){throw new Error("Method not implemented.")}getTranslation(t){throw new Error("Method not implemented.")}inviteFriends(t,e){throw new Error("Method not implemented.")}shareWithFriends(t,e){throw new Error("Method not implemented.")}vibrate(t){window.console.warn("Method not implemented.")}getGPUTier(){return window.console.warn("Method not implemented."),null}update(t,e){this._runtimes.forEach((i=>i.update(t,e)))}};Qh=new class extends Ih{constructor(t){super(t),(0,st.Z)(this,"_syncManager",void 0),(0,st.Z)(this,"_contactManager",void 0),(0,st.Z)(this,"_debugManager",void 0),(0,st.Z)(this,"_world",void 0),this._world=new bt.b2World(new bt.b2Vec2(0,Dr(9.81))),this._contactManager=new mh(this._world),this._syncManager=new Wh(this._world)}get physics2dWorld(){return this._world}get physics2dSyncManager(){return this._syncManager}get physics2dContactManager(){return this._contactManager}get physics2dDebugManager(){return this._debugManager}update(t,e){super.update(t,e),this._step()}_step(){var t;this._world.Step(.02,15,13),this._syncManager.sync(),null===(t=this._debugManager)||void 0===t||t.draw()}}(Qh),Qh=new class extends Ih{constructor(t){super(t),(0,st.Z)(this,"_ticker",void 0),(0,st.Z)(this,"_update",(()=>{const{lastTime:t,deltaMS:e}=this._ticker;super.update(t,e)})),this._ticker=new Jh}init(){this._ticker.add(this._update),this._ticker.maxFPS=60,this._ticker.start(),super.init()}get tickerStarted(){return this._ticker.started}get lastTime(){return this._ticker.lastTime}post(t,e){this._ticker.post(t,e)}delay(t){return this._ticker.delay(t)}cancel(t){this._ticker.cancel(t)}add(t,e){this._ticker.add(t,e)}remove(t,e){this._ticker.remove(t,e)}pause(){this._ticker.stop(),super.pause()}resume(){this._ticker.start(),super.resume()}}(Qh),Qh=new class extends Ih{constructor(t){super(t),(0,st.Z)(this,"_h5sdk",void 0);const{H5SDK:e}=window;this._h5sdk=e}vibrate(t){this._h5sdk.performHapticFeedBack(t)}}(Qh),Qh=new class extends Ih{constructor(t){super(t),(0,st.Z)(this,"_h5sdk",void 0),(0,st.Z)(this,"_onPause",(()=>{this.isVisible=!1,this.pause()})),(0,st.Z)(this,"_onResume",(()=>{this.isVisible=!0,this.resume()}));const{H5SDK:e}=window;this._h5sdk=e}init(){super.init(),this._addVisibleChangeCallback()}_addVisibleChangeCallback(){this._h5sdk.addEventListener("pause",this._onPause),this._h5sdk.addEventListener("resume",this._onResume)}}(Qh),Qh=new class extends Ih{constructor(t){super(t),(0,st.Z)(this,"_h5sdk",void 0),(0,st.Z)(this,"_onUnmute",(()=>{this.unmute()})),(0,st.Z)(this,"_onMute",(()=>{this.mute()}));const{H5SDK:e}=window;this._h5sdk=e}init(){super.init(),this._addSoundChangeCallback()}_addSoundChangeCallback(){this._h5sdk.addEventListener("mute",this._onMute),this._h5sdk.addEventListener("unmute",this._onUnmute)}}(Qh),Qh=new jh(Qh),Qh=new class extends Ih{constructor(){super(...arguments),(0,st.Z)(this,"_pointerType","mouse"),(0,st.Z)(this,"_gameDiv",void 0)}init(){super.init(),this._gameDiv=document.getElementById("game_div"),this._detectPointerType(),this._addInteractionEvents()}set interactive(t){this._gameDiv.style.pointerEvents=t?"auto":"none"}get interactive(){return"none"!==this._gameDiv.style.pointerEvents}_detectPointerType(){switch(!0){case"onpointerdown"in window:this._pointerType="pointer";break;case"ontouchstart"in window:this._pointerType="touch";break;default:this._pointerType="mouse"}}_addInteractionEvents(){const t=Eh[this._pointerType].down;this.canvas.addEventListener(t,this.firstInteraction,{once:!0}),this.canvas.addEventListener(t,this.interaction,{once:!1})}}(Qh),Qh=new class extends Ih{constructor(t){super(t),(0,st.Z)(this,"_h5sdk",void 0),(0,st.Z)(this,"_onProgress",(t=>{this._h5sdk.notifyLoadingProgress(100*t)})),(0,st.Z)(this,"_onComplete",(()=>{s.q.event.off(Z.loadProgress,this._onProgress),this._h5sdk.notifyLoadingComplete()}));const{H5SDK:e}=window;this._h5sdk=e}init(){super.init(),this._addProgressCallback()}_addProgressCallback(){s.q.event.on(Z.loadProgress,this._onProgress),s.q.event.once(Z.loadComplete,this._onComplete)}}(Qh),Qh=new class extends Ih{constructor(t){super(t),(0,st.Z)(this,"_h5sdk",void 0);const{H5SDK:e}=window;this._h5sdk=e}showInterstitialAd(){return this._h5sdk.requestInterstitialAd()}showRewardedAd(){return this._h5sdk.requestRewardedAd()}}(Qh),Qh=new class extends Ih{constructor(t){super(t),(0,st.Z)(this,"_h5sdk",void 0);const{H5SDK:e}=window;this._h5sdk=e}logLevelStart(t){this._h5sdk.notifyLevelStart(t)}logUpdateScore(t){this._h5sdk.notifyUpdateScore(Math.floor(t))}logLevelEnd(t,e,i){this._h5sdk.notifyLevelEnd(t,Math.floor(e),i)}}(Qh),Qh=new class extends Ih{constructor(t){super(t),(0,st.Z)(this,"_h5sdk",void 0);const{H5SDK:e}=window;this._h5sdk=e}saveProgression(t,e){return this._h5sdk.saveProgression(t,e)}getSavedProgression(t){return this._h5sdk.getSavedProgression(t)}}(Qh),Qh=new class extends Ih{constructor(t){super(t),(0,st.Z)(this,"_h5sdk",void 0);const{H5SDK:e}=window;this._h5sdk=e}isFacebookPlatform(){return this._h5sdk.getPlatform().isFacebook()}getTranslation(t){return this._h5sdk.getPlatform().getTranslation(t)}showTournamentCreatorPopup(){return this.isFacebookPlatform()&&this._h5sdk.getPlatform().showTournamentCreatorPopup()}inviteFriends(t,e){return this.isFacebookPlatform()&&this._h5sdk.getPlatform().inviteFriends(t,e)}shareWithFriends(t,e){return this.isFacebookPlatform()&&this._h5sdk.getPlatform().shareWithFriends(t,e)}}(Qh),Qh=new class extends Ih{constructor(){super(...arguments),(0,st.Z)(this,"_lockOrientation",void 0),(0,st.Z)(this,"_gameDiv",void 0),(0,st.Z)(this,"_lockOrientationDiv",void 0),(0,st.Z)(this,"_gameBounds",{x:0,y:0,width:0,height:0}),(0,st.Z)(this,"_resize",(()=>{this._updateOrientation(),this._resizeGameDiv(),this._calculateTransform(),window.scroll(0,0),this.resize()})),(0,st.Z)(this,"_calculateDesignBounds",(()=>{const{size:t}=Vh,{width:e,height:i}=li(t.landscape,t.portrait);this.designBounds.x=0,this.designBounds.y=0,this.designBounds.width=e,this.designBounds.height=i}))}init(){super.init(),this._gameDiv=document.getElementById("game_div"),this._lockOrientationDiv=document.getElementById("lock_orientation_div"),window.addEventListener("orientationchange",this._resize),window.addEventListener("resize",this._resize),this._resize()}lockOrientation(t){this._lockOrientation=t}_updateOrientation(){if(this.orientation=li(j.landscape,j.portrait),this._lockOrientation&&!hi()){if(this.orientation!==this._lockOrientation)return this._gameDiv.style.visibility="hidden",this._lockOrientationDiv.style.visibility="visible",void this.pause();this._gameDiv.style.visibility="visible",this._lockOrientationDiv.style.visibility="hidden",this.resume()}}_resizeGameDiv(){const{width:t,height:e}=this._getWindowSize(),{min:i,max:s}=Vh.size.ratio,o=Math.min(t/e,e/t),n=o/(0,Pt.Z)(o,i,s),a=this._getDestinationBounds(t,e),r=((t,e)=>{const{x:i,y:s,width:o,height:n}=t,{width:a,height:r}=e,h=Math.min(a/o,r/n);return new ai(i,s,Math.ceil(o*h),Math.ceil(n*h))})({landscape:{x:0,y:0,width:t*n,height:e},portrait:{x:0,y:0,width:t,height:e*n}}[this.orientation],a),h=((t,e)=>{const{width:i,height:s}=t,{width:o,height:n}=e;return{x:(o-i)/2,y:(n-s)/2}})(r,a);this._gameDiv.style.width="".concat(r.width,"px"),this._gameDiv.style.height="".concat(r.height,"px"),this._gameDiv.style.left="".concat(h.x,"px"),this._gameDiv.style.top="".concat(h.y,"px"),this._gameBounds=this._gameDiv.getBoundingClientRect()}_calculateTransform(){this._calculateDesignBounds(),this._calculateViewScale(),this._calculateViewBounds()}_calculateViewScale(){const{width:t,height:e}=this.designBounds,{width:i,height:s}=this._gameBounds;this.viewScale=Math.min(i/t,s/e)}_calculateViewBounds(){const{width:t,height:e}=this._gameBounds;this.viewBounds.x=0,this.viewBounds.y=0,this.viewBounds.width=t/this.viewScale,this.viewBounds.height=e/this.viewScale}_getWindowSize(){const{innerWidth:t,innerHeight:e}=window;return hi()?{width:e,height:t}:{width:t,height:e}}_getDestinationBounds(t,e){return hi()?{x:0,y:0,width:e,height:t}:{x:0,y:0,width:t,height:e}}}(Qh),Qh=new class extends Ih{constructor(t){super(t),(0,st.Z)(this,"_h5sdk",void 0),(0,st.Z)(this,"_onReady",(()=>{this._h5sdk.removeEventListener("ready",this._onReady),this.init(),this._h5sdk.addEventListener("startLoading",this._onStart)})),(0,st.Z)(this,"_onStart",(()=>{this._h5sdk.removeEventListener("startLoading",this._onStart),this.start()}));const{H5SDK:e}=window;this._h5sdk=e,this._addReadyEventCallback(),this._h5sdk.init()}_addReadyEventCallback(){"ready"!==this._h5sdk.getState()?this._h5sdk.addEventListener("ready",this._onReady):setTimeout(this._onReady)}}(Qh),Qh=new class extends Ih{constructor(t){super(t),(0,st.Z)(this,"_h5sdk",void 0);const{H5SDK:e}=window;this._h5sdk=e}async getGPUTier(){return await this._h5sdk.getGPUTier()}}(Qh),Qh=new class extends Ih{constructor(t){super(t),(0,st.Z)(this,"_onError",(t=>{let e="".concat(t.message,", url=").concat(t.target,", line=").concat(t.lineno);t.colno&&(e+=", column=".concat(t.colno)),t.error&&(e+=", error=".concat(JSON.stringify(t.error)))})),this._addErrorEventCallback()}_addErrorEventCallback(){window.addEventListener("error",this._onError)}}(Qh),Qh.lockOrientation(Yh.orientation),window.globals.app=Qh,s.q.command.execute((()=>{s.q.command.execute(On)}))},8492:function(t){t.exports=JSON.parse('{"extensions":{"physics2dDebugger":{"enabled":false},"physics3dDebugger":{"enabled":false},"legologger":{"enabled":false},"stats":{"enabled":false,"panel":0},"gui":{"enabled":false}},"orientation":"portrait","size":{"ratio":{"min":0.42,"max":0.74},"portrait":{"width":750,"height":750},"landscape":{"width":750,"height":750}},"compression":{"images":{"assets/**/*.jpeg":{"quant":{"numColors":128,"dither":1},"mozjpeg":{"quality":40}},"assets/**/*.jpg":{"quant":{"numColors":128,"dither":1},"mozjpeg":{"quality":40}},"assets/**/*.png":{"quant":{"numColors":256,"dither":1},"oxipng":{"level":1}}},"sounds":{"assets/**/*.mp3":{"bitrate":32}}},"params":{"language":"en"},"load":{"main":{"generic":{"sounds":[],"fonts":["AeroMaticsDisplay"]},"pixi":{"atlases":["main"],"images":[],"sounds":[],"spines":[],"fonts":[]},"three":{"models":["saw-basic","saw-unicorn","saw-superhero"],"textures":["grass","half-grass-1","half-grass-2","half-grass-3","half-grass-4","sand","grey-checker","sky","hand","saw-unicorn-01","saw-unicorn-02","saw-superhero","arm-unicorn","arm-superhero"]}},"extra":{"generic":{"sounds":["out-of-fuel","level-completed","tap","dig-0","dig-1","dig-2","dig-3","dig-4"]},"pixi":{"atlases":["extra"],"sounds":[],"images":[],"spines":[],"fonts":{}},"three":{"models":[],"textures":["coin-025","coin-05","coin-1","coin-3","coin-5"]}}}}')}}]);